function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(l){i=!0,o=l}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _createForOfIteratorHelper(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=_unsupportedIterableToArray(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _construct(e,t,n){return(_construct=_isNativeReflectConstruct()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&_setPrototypeOf(i,n.prototype),i}).apply(null,arguments)}function _get(e,t,n){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=_superPropBase(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _createSuper(e){return function(){var t,n=_getPrototypeOf(e);if(_isNativeReflectConstruct()){var r=_getPrototypeOf(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return _possibleConstructorReturn(this,t)}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{0:function(e,t,n){e.exports=n("zUnb")},zUnb:function(e,t,n){"use strict";function r(e){return"function"==typeof e}n.r(t);var i=!1,o={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){if(e){var t=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+t.stack)}else i&&console.log("RxJS: Back to a better error behavior. Thank you. <3");i=e},get useDeprecatedSynchronousErrorHandling(){return i}};function a(e){setTimeout((function(){throw e}),0)}var s={closed:!0,next:function(e){},error:function(e){if(o.useDeprecatedSynchronousErrorHandling)throw e;a(e)},complete:function(){}},l=Array.isArray||function(e){return e&&"number"==typeof e.length};function u(e){return null!==e&&"object"==typeof e}var c,h,f=function(){function e(e){return Error.call(this),this.message=e?"".concat(e.length," errors occurred during unsubscription:\n").concat(e.map((function(e,t){return"".concat(t+1,") ").concat(e.toString())})).join("\n  ")):"",this.name="UnsubscriptionError",this.errors=e,this}return e.prototype=Object.create(Error.prototype),e}(),d=((h=function(){function e(t){_classCallCheck(this,e),this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._unsubscribe=t)}return _createClass(e,[{key:"unsubscribe",value:function(){var t;if(!this.closed){var n=this._parentOrParents,i=this._unsubscribe,o=this._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,n instanceof e)n.remove(this);else if(null!==n)for(var a=0;a<n.length;++a)n[a].remove(this);if(r(i))try{i.call(this)}catch(d){t=d instanceof f?v(d.errors):[d]}if(l(o))for(var s=-1,c=o.length;++s<c;){var h=o[s];if(u(h))try{h.unsubscribe()}catch(d){t=t||[],d instanceof f?t=t.concat(v(d.errors)):t.push(d)}}if(t)throw new f(t)}}},{key:"add",value:function(t){var n=t;if(!t)return e.EMPTY;switch(typeof t){case"function":n=new e(t);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof e)){var r=n;(n=new e)._subscriptions=[r]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var i=n._parentOrParents;if(null===i)n._parentOrParents=this;else if(i instanceof e){if(i===this)return n;n._parentOrParents=[i,this]}else{if(-1!==i.indexOf(this))return n;i.push(this)}var o=this._subscriptions;return null===o?this._subscriptions=[n]:o.push(n),n}},{key:"remove",value:function(e){var t=this._subscriptions;if(t){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}}}]),e}()).EMPTY=((c=new h).closed=!0,c),h);function v(e){return e.reduce((function(e,t){return e.concat(t instanceof f?t.errors:t)}),[])}var p="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random(),g=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,i){var o;switch(_classCallCheck(this,n),(o=t.call(this)).syncErrorValue=null,o.syncErrorThrown=!1,o.syncErrorThrowable=!1,o.isStopped=!1,arguments.length){case 0:o.destination=s;break;case 1:if(!e){o.destination=s;break}if("object"==typeof e){e instanceof n?(o.syncErrorThrowable=e.syncErrorThrowable,o.destination=e,e.add(_assertThisInitialized(o))):(o.syncErrorThrowable=!0,o.destination=new m(_assertThisInitialized(o),e));break}default:o.syncErrorThrowable=!0,o.destination=new m(_assertThisInitialized(o),e,r,i)}return o}return _createClass(n,[{key:p,value:function(){return this}},{key:"next",value:function(e){this.isStopped||this._next(e)}},{key:"error",value:function(e){this.isStopped||(this.isStopped=!0,this._error(e))}},{key:"complete",value:function(){this.isStopped||(this.isStopped=!0,this._complete())}},{key:"unsubscribe",value:function(){this.closed||(this.isStopped=!0,_get(_getPrototypeOf(n.prototype),"unsubscribe",this).call(this))}},{key:"_next",value:function(e){this.destination.next(e)}},{key:"_error",value:function(e){this.destination.error(e),this.unsubscribe()}},{key:"_complete",value:function(){this.destination.complete(),this.unsubscribe()}},{key:"_unsubscribeAndRecycle",value:function(){var e=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this}}],[{key:"create",value:function(e,t,r){var i=new n(e,t,r);return i.syncErrorThrowable=!1,i}}]),n}(d),m=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i,o,a){var l,u;_classCallCheck(this,n),(l=t.call(this))._parentSubscriber=e;var c=_assertThisInitialized(l);return r(i)?u=i:i&&(u=i.next,o=i.error,a=i.complete,i!==s&&(r((c=Object.create(i)).unsubscribe)&&l.add(c.unsubscribe.bind(c)),c.unsubscribe=l.unsubscribe.bind(_assertThisInitialized(l)))),l._context=c,l._next=u,l._error=o,l._complete=a,l}return _createClass(n,[{key:"next",value:function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;o.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}}},{key:"error",value:function(e){if(!this.isStopped){var t=this._parentSubscriber,n=o.useDeprecatedSynchronousErrorHandling;if(this._error)n&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)n?(t.syncErrorValue=e,t.syncErrorThrown=!0):a(e),this.unsubscribe();else{if(this.unsubscribe(),n)throw e;a(e)}}}},{key:"complete",value:function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var n=function(){return e._complete.call(e._context)};o.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}}},{key:"__tryOrUnsub",value:function(e,t){try{e.call(this._context,t)}catch(n){if(this.unsubscribe(),o.useDeprecatedSynchronousErrorHandling)throw n;a(n)}}},{key:"__tryOrSetError",value:function(e,t,n){if(!o.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,n)}catch(r){return o.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=r,e.syncErrorThrown=!0,!0):(a(r),!0)}return!1}},{key:"_unsubscribe",value:function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()}}]),n}(g),y="function"==typeof Symbol&&Symbol.observable||"@@observable";function k(){}var b,w=((b=function(){function e(t){_classCallCheck(this,e),this._isScalar=!1,t&&(this._subscribe=t)}return _createClass(e,[{key:"lift",value:function(t){var n=new e;return n.source=this,n.operator=t,n}},{key:"subscribe",value:function(e,t,n){var r=this.operator,i=function(e,t,n){if(e){if(e instanceof g)return e;if(e[p])return e[p]()}return e||t||n?new g(e,t,n):new g(s)}(e,t,n);if(i.add(r?r.call(i,this.source):this.source||o.useDeprecatedSynchronousErrorHandling&&!i.syncErrorThrowable?this._subscribe(i):this._trySubscribe(i)),o.useDeprecatedSynchronousErrorHandling&&i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i}},{key:"_trySubscribe",value:function(e){try{return this._subscribe(e)}catch(t){o.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),function(e){for(;e;){var t=e,n=t.closed,r=t.destination,i=t.isStopped;if(n||i)return!1;e=r&&r instanceof g?r:null}return!0}(e)?e.error(t):console.warn(t)}}},{key:"forEach",value:function(e,t){var n=this;return new(t=_(t))((function(t,r){var i;i=n.subscribe((function(t){try{e(t)}catch(n){r(n),i&&i.unsubscribe()}}),r,t)}))}},{key:"_subscribe",value:function(e){var t=this.source;return t&&t.subscribe(e)}},{key:y,value:function(){return this}},{key:"pipe",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?this:((r=t)?1===r.length?r[0]:function(e){return r.reduce((function(e,t){return t(e)}),e)}:k)(this);var r}},{key:"toPromise",value:function(e){var t=this;return new(e=_(e))((function(e,n){var r;t.subscribe((function(e){return r=e}),(function(e){return n(e)}),(function(){return e(r)}))}))}}]),e}()).create=function(e){return new b(e)},b);function _(e){if(e||(e=o.Promise||Promise),!e)throw new Error("no Promise impl found");return e}var C,O=function(){function e(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return e.prototype=Object.create(Error.prototype),e}(),x=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var i;return _classCallCheck(this,n),(i=t.call(this)).subject=e,i.subscriber=r,i.closed=!1,i}return _createClass(n,[{key:"unsubscribe",value:function(){if(!this.closed){this.closed=!0;var e=this.subject,t=e.observers;if(this.subject=null,t&&0!==t.length&&!e.isStopped&&!e.closed){var n=t.indexOf(this.subscriber);-1!==n&&t.splice(n,1)}}}}]),n}(d),S=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e)).destination=e,r}return n}(g),A=((C=function(e){_inherits(n,e);var t=_createSuper(n);function n(){var e;return _classCallCheck(this,n),(e=t.call(this)).observers=[],e.closed=!1,e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return _createClass(n,[{key:p,value:function(){return new S(this)}},{key:"lift",value:function(e){var t=new P(this,this);return t.operator=e,t}},{key:"next",value:function(e){if(this.closed)throw new O;if(!this.isStopped)for(var t=this.observers,n=t.length,r=t.slice(),i=0;i<n;i++)r[i].next(e)}},{key:"error",value:function(e){if(this.closed)throw new O;this.hasError=!0,this.thrownError=e,this.isStopped=!0;for(var t=this.observers,n=t.length,r=t.slice(),i=0;i<n;i++)r[i].error(e);this.observers.length=0}},{key:"complete",value:function(){if(this.closed)throw new O;this.isStopped=!0;for(var e=this.observers,t=e.length,n=e.slice(),r=0;r<t;r++)n[r].complete();this.observers.length=0}},{key:"unsubscribe",value:function(){this.isStopped=!0,this.closed=!0,this.observers=null}},{key:"_trySubscribe",value:function(e){if(this.closed)throw new O;return _get(_getPrototypeOf(n.prototype),"_trySubscribe",this).call(this,e)}},{key:"_subscribe",value:function(e){if(this.closed)throw new O;return this.hasError?(e.error(this.thrownError),d.EMPTY):this.isStopped?(e.complete(),d.EMPTY):(this.observers.push(e),new x(this,e))}},{key:"asObservable",value:function(){var e=new w;return e.source=this,e}}]),n}(w)).create=function(e,t){return new P(e,t)},C),P=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var i;return _classCallCheck(this,n),(i=t.call(this)).destination=e,i.source=r,i}return _createClass(n,[{key:"next",value:function(e){var t=this.destination;t&&t.next&&t.next(e)}},{key:"error",value:function(e){var t=this.destination;t&&t.error&&this.destination.error(e)}},{key:"complete",value:function(){var e=this.destination;e&&e.complete&&this.destination.complete()}},{key:"_subscribe",value:function(e){return this.source?this.source.subscribe(e):d.EMPTY}}]),n}(A),T=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,i){var o;return _classCallCheck(this,n),(o=t.call(this)).parent=e,o.outerValue=r,o.outerIndex=i,o.index=0,o}return _createClass(n,[{key:"_next",value:function(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)}},{key:"_error",value:function(e){this.parent.notifyError(e,this),this.unsubscribe()}},{key:"_complete",value:function(){this.parent.notifyComplete(this),this.unsubscribe()}}]),n}(g),I=function(e){return function(t){for(var n=0,r=e.length;n<r&&!t.closed;n++)t.next(e[n]);t.complete()}};var E="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator",D=function(e){if(e&&"function"==typeof e[y])return o=e,function(e){var t=o[y]();if("function"!=typeof t.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return t.subscribe(e)};if((t=e)&&"number"==typeof t.length&&"function"!=typeof t)return I(e);var t,n,r,i,o;if((n=e)&&"function"!=typeof n.subscribe&&"function"==typeof n.then)return i=e,function(e){return i.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,a),e};if(e&&"function"==typeof e[E])return r=e,function(e){for(var t=r[E]();;){var n=t.next();if(n.done){e.complete();break}if(e.next(n.value),e.closed)break}return"function"==typeof t.return&&e.add((function(){t.return&&t.return()})),e};var s=u(e)?"an invalid object":"'".concat(e,"'");throw new TypeError("You provided ".concat(s," where a stream was expected.")+" You can provide an Observable, Promise, Array, or Iterable.")},M=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"notifyNext",value:function(e,t,n,r,i){this.destination.next(t)}},{key:"notifyError",value:function(e,t){this.destination.error(e)}},{key:"notifyComplete",value:function(e){this.destination.complete()}}]),n}(g),Q=function(){function e(t,n){_classCallCheck(this,e),this.project=t,this.thisArg=n}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new R(e,this.project,this.thisArg))}}]),e}(),R=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,i){var o;return _classCallCheck(this,n),(o=t.call(this,e)).project=r,o.count=0,o.thisArg=i||_assertThisInitialized(o),o}return _createClass(n,[{key:"_next",value:function(e){var t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(n){return void this.destination.error(n)}this.destination.next(t)}}]),n}(g),H=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.POSITIVE_INFINITY;_classCallCheck(this,e),this.project=t,this.concurrent=n}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new N(e,this.project,this.concurrent))}}]),e}(),N=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.POSITIVE_INFINITY;return _classCallCheck(this,n),(i=t.call(this,e)).project=r,i.concurrent=o,i.hasCompleted=!1,i.buffer=[],i.active=0,i.index=0,i}return _createClass(n,[{key:"_next",value:function(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)}},{key:"_tryNext",value:function(e){var t,n=this.index++;try{t=this.project(e,n)}catch(r){return void this.destination.error(r)}this.active++,this._innerSub(t,e,n)}},{key:"_innerSub",value:function(e,t,n){var r=new T(this,t,n),i=this.destination;i.add(r);var o=function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new T(e,n,r);if(!i.closed)return t instanceof w?t.subscribe(i):D(t)(i)}(this,e,void 0,void 0,r);o!==r&&i.add(o)}},{key:"_complete",value:function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}},{key:"notifyNext",value:function(e,t,n,r,i){this.destination.next(t)}},{key:"notifyComplete",value:function(e){var t=this.buffer;this.remove(e),this.active--,t.length>0?this._next(t.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}]),n}(M);function L(e){return e}function F(){return function(e){return e.lift(new B(e))}}var $,B=function(){function e(t){_classCallCheck(this,e),this.connectable=t}return _createClass(e,[{key:"call",value:function(e,t){var n=this.connectable;n._refCount++;var r=new V(e,n),i=t.subscribe(r);return r.closed||(r.connection=n.connect()),i}}]),e}(),V=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var i;return _classCallCheck(this,n),(i=t.call(this,e)).connectable=r,i}return _createClass(n,[{key:"_unsubscribe",value:function(){var e=this.connectable;if(e){this.connectable=null;var t=e._refCount;if(t<=0)this.connection=null;else if(e._refCount=t-1,t>1)this.connection=null;else{var n=this.connection,r=e._connection;this.connection=null,!r||n&&r!==n||r.unsubscribe()}}else this.connection=null}}]),n}(g),z={operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:($=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var i;return _classCallCheck(this,n),(i=t.call(this)).source=e,i.subjectFactory=r,i._refCount=0,i._isComplete=!1,i}return _createClass(n,[{key:"_subscribe",value:function(e){return this.getSubject().subscribe(e)}},{key:"getSubject",value:function(){var e=this._subject;return e&&!e.isStopped||(this._subject=this.subjectFactory()),this._subject}},{key:"connect",value:function(){var e=this._connection;return e||(this._isComplete=!1,(e=this._connection=new d).add(this.source.subscribe(new j(this.getSubject(),this))),e.closed&&(this._connection=null,e=d.EMPTY)),e}},{key:"refCount",value:function(){return F()(this)}}]),n}(w).prototype)._subscribe},_isComplete:{value:$._isComplete,writable:!0},getSubject:{value:$.getSubject},connect:{value:$.connect},refCount:{value:$.refCount}},j=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var i;return _classCallCheck(this,n),(i=t.call(this,e)).connectable=r,i}return _createClass(n,[{key:"_error",value:function(e){this._unsubscribe(),_get(_getPrototypeOf(n.prototype),"_error",this).call(this,e)}},{key:"_complete",value:function(){this.connectable._isComplete=!0,this._unsubscribe(),_get(_getPrototypeOf(n.prototype),"_complete",this).call(this)}},{key:"_unsubscribe",value:function(){var e=this.connectable;if(e){this.connectable=null;var t=e._connection;e._refCount=0,e._subject=null,e._connection=null,t&&t.unsubscribe()}}}]),n}(S);function q(){return new A}function W(e){return{toString:e}.toString()}function U(e,t,n){return W((function(){var r=function(e){return function(){if(e){var t=e.apply(void 0,arguments);for(var n in t)this[n]=t[n]}}}(t);function i(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(this instanceof i)return r.apply(this,t),this;var o=_construct(i,t);return a.annotation=o,a;function a(e,t,n){for(var r=e.hasOwnProperty("__parameters__")?e.__parameters__:Object.defineProperty(e,"__parameters__",{value:[]}).__parameters__;r.length<=n;)r.push(null);return(r[n]=r[n]||[]).push(o),e}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=e,i.annotationCls=i,i}))}var X=U("Inject",(function(e){return{token:e}})),G=U("Optional"),Z=U("Self"),Y=U("SkipSelf"),K=function(e){return e[e.Default=0]="Default",e[e.Host=1]="Host",e[e.Self=2]="Self",e[e.SkipSelf=4]="SkipSelf",e[e.Optional=8]="Optional",e}({});function J(e){for(var t in e)if(e[t]===J)return t;throw Error("Could not find renamed property on target object.")}function ee(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function te(e){return{factory:e.factory,providers:e.providers||[],imports:e.imports||[]}}function ne(e){return re(e,e[oe])||re(e,e[le])}function re(e,t){return t&&t.token===e?t:null}function ie(e){return e&&(e.hasOwnProperty(ae)||e.hasOwnProperty(ue))?e[ae]:null}var oe=J({"\u0275prov":J}),ae=J({"\u0275inj":J}),se=J({"\u0275provFallback":J}),le=J({ngInjectableDef:J}),ue=J({ngInjectorDef:J});function ce(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(ce).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return"".concat(e.overriddenName);if(e.name)return"".concat(e.name);var t=e.toString();if(null==t)return""+t;var n=t.indexOf("\n");return-1===n?t:t.substring(0,n)}function he(e,t){return null==e||""===e?null===t?"":t:null==t||""===t?e:e+" "+t}var fe=J({__forward_ref__:J});function de(e){return e.__forward_ref__=de,e.toString=function(){return ce(this())},e}function ve(e){return"function"==typeof(t=e)&&t.hasOwnProperty(fe)&&t.__forward_ref__===de?e():e;var t}var pe,ge="undefined"!=typeof globalThis&&globalThis,me="undefined"!=typeof window&&window,ye="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,ke="undefined"!=typeof global&&global,be=ge||ke||me||ye,we=J({"\u0275cmp":J}),_e=J({"\u0275dir":J}),Ce=J({"\u0275pipe":J}),Oe=J({"\u0275mod":J}),xe=J({"\u0275loc":J}),Se=J({"\u0275fac":J}),Ae=J({__NG_ELEMENT_ID__:J}),Pe=function(){function e(t,n){_classCallCheck(this,e),this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.\u0275prov=ee({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}return _createClass(e,[{key:"toString",value:function(){return"InjectionToken ".concat(this._desc)}}]),e}(),Te=new Pe("INJECTOR",-1),Ie={},Ee=/\n/gm,De=J({provide:String,useValue:J}),Me=void 0;function Qe(e){var t=Me;return Me=e,t}function Re(e){var t=pe;return pe=e,t}function He(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:K.Default;if(void 0===Me)throw new Error("inject() must be called from an injection context");return null===Me?Le(e,void 0,t):Me.get(e,t&K.Optional?null:void 0,t)}function Ne(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:K.Default;return(pe||He)(ve(e),t)}function Le(e,t,n){var r=ne(e);if(r&&"root"==r.providedIn)return void 0===r.value?r.value=r.factory():r.value;if(n&K.Optional)return null;if(void 0!==t)return t;throw new Error("Injector: NOT_FOUND [".concat(ce(e),"]"))}function Fe(e){for(var t=[],n=0;n<e.length;n++){var r=ve(e[n]);if(Array.isArray(r)){if(0===r.length)throw new Error("Arguments array must have arguments.");for(var i=void 0,o=K.Default,a=0;a<r.length;a++){var s=r[a];s instanceof G||"Optional"===s.ngMetadataName||s===G?o|=K.Optional:s instanceof Y||"SkipSelf"===s.ngMetadataName||s===Y?o|=K.SkipSelf:s instanceof Z||"Self"===s.ngMetadataName||s===Z?o|=K.Self:i=s instanceof X||s===X?s.token:s}t.push(Ne(i,o))}else t.push(Ne(r))}return t}var $e=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ie;if(t===Ie){var n=new Error("NullInjectorError: No provider for ".concat(ce(e),"!"));throw n.name="NullInjectorError",n}return t}}]),e}(),Be=function e(){_classCallCheck(this,e)};function Ve(e,t){e.forEach((function(e){return Array.isArray(e)?Ve(e,t):t(e)}))}var ze=function(){var e={OnPush:0,Default:1};return e[e.OnPush]="OnPush",e[e.Default]="Default",e}(),je=function(){var e={Emulated:0,Native:1,None:2,ShadowDom:3};return e[e.Emulated]="Emulated",e[e.Native]="Native",e[e.None]="None",e[e.ShadowDom]="ShadowDom",e}(),qe={},We=[],Ue=0;function Xe(e){return Je(e)||function(e){return e[_e]||null}(e)}function Ge(e){return function(e){return e[Ce]||null}(e)}var Ze={};function Ye(e){var t={type:e.type,bootstrap:e.bootstrap||We,declarations:e.declarations||We,imports:e.imports||We,exports:e.exports||We,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null};return null!=e.id&&W((function(){Ze[e.id]=e.type})),t}function Ke(e,t){if(null==e)return qe;var n={};for(var r in e)if(e.hasOwnProperty(r)){var i=e[r],o=i;Array.isArray(i)&&(o=i[1],i=i[0]),n[i]=r,t&&(t[i]=o)}return n}function Je(e){return e[we]||null}function et(e,t){return e.hasOwnProperty(Se)?e[Se]:null}function tt(e,t){var n=e[Oe]||null;if(!n&&!0===t)throw new Error("Type ".concat(ce(e)," does not have '\u0275mod' property."));return n}function nt(e){return Array.isArray(e)&&"object"==typeof e[1]}function rt(e){return Array.isArray(e)&&!0===e[1]}function it(e){return 0!=(8&e.flags)}function ot(e){return null!==e.template}var at=void 0;function st(e){return!!e.listen}var lt={createRenderer:function(e,t){return void 0!==at?at:"undefined"!=typeof document?document:void 0}};function ut(e){for(;Array.isArray(e);)e=e[0];return e}function ct(e,t){return ut(t[e.index])}function ht(e,t){var n=t[e];return nt(n)?n:n[0]}function ft(e){var t=function(e){return e.__ngContext__||null}(e);return t?Array.isArray(t)?t:t.lView:null}function dt(e){return 128==(128&e[2])}function vt(e,t){return null===e||null==t?null:e[t]}function pt(e){e[18]=0}var gt={lFrame:It(null),bindingsEnabled:!0,checkNoChangesMode:!1};function mt(){return gt.bindingsEnabled}function yt(){return gt.lFrame.lView}function kt(){return gt.lFrame.tView}function bt(){return gt.lFrame.previousOrParentTNode}function wt(e,t){gt.lFrame.previousOrParentTNode=e,gt.lFrame.isParent=t}function _t(){return gt.lFrame.isParent}function Ct(){return gt.checkNoChangesMode}function Ot(e){gt.checkNoChangesMode=e}function xt(e,t){var n=gt.lFrame;n.bindingIndex=n.bindingRootIndex=e,n.currentDirectiveIndex=t}function St(e){gt.lFrame.currentQueryIndex=e}function At(e,t){var n=Tt();gt.lFrame=n,n.previousOrParentTNode=t,n.lView=e}function Pt(e,t){var n=Tt(),r=e[1];gt.lFrame=n,n.previousOrParentTNode=t,n.lView=e,n.tView=r,n.contextLView=e,n.bindingIndex=r.bindingStartIndex}function Tt(){var e=gt.lFrame,t=null===e?null:e.child;return null===t?It(e):t}function It(e){var t={previousOrParentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:0,contextLView:null,elementDepthCount:0,currentNamespace:null,currentSanitizer:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null};return null!==e&&(e.child=t),t}function Et(){var e=gt.lFrame;return gt.lFrame=e.parent,e.previousOrParentTNode=null,e.lView=null,e}var Dt=Et;function Mt(){var e=Et();e.isParent=!0,e.tView=null,e.selectedIndex=0,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.currentSanitizer=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function Qt(e){gt.lFrame.selectedIndex=e}function Rt(e,t){for(var n=t.directiveStart,r=t.directiveEnd;n<r;n++){var i=e.data[n];i.afterContentInit&&(e.contentHooks||(e.contentHooks=[])).push(-n,i.afterContentInit),i.afterContentChecked&&((e.contentHooks||(e.contentHooks=[])).push(n,i.afterContentChecked),(e.contentCheckHooks||(e.contentCheckHooks=[])).push(n,i.afterContentChecked)),i.afterViewInit&&(e.viewHooks||(e.viewHooks=[])).push(-n,i.afterViewInit),i.afterViewChecked&&((e.viewHooks||(e.viewHooks=[])).push(n,i.afterViewChecked),(e.viewCheckHooks||(e.viewCheckHooks=[])).push(n,i.afterViewChecked)),null!=i.onDestroy&&(e.destroyHooks||(e.destroyHooks=[])).push(n,i.onDestroy)}}function Ht(e,t,n){Ft(e,t,3,n)}function Nt(e,t,n,r){(3&e[2])===n&&Ft(e,t,n,r)}function Lt(e,t){var n=e[2];(3&n)===t&&(n&=1023,n+=1,e[2]=n)}function Ft(e,t,n,r){for(var i=null!=r?r:-1,o=0,a=void 0!==r?65535&e[18]:0;a<t.length;a++)if("number"==typeof t[a+1]){if(o=t[a],null!=r&&o>=r)break}else t[a]<0&&(e[18]+=65536),(o<i||-1==i)&&($t(e,n,t,a),e[18]=(4294901760&e[18])+a+2),a++}function $t(e,t,n,r){var i=n[r]<0,o=n[r+1],a=e[i?-n[r]:n[r]];i?e[2]>>10<e[18]>>16&&(3&e[2])===t&&(e[2]+=1024,o.call(a)):o.call(a)}var Bt=function e(t,n,r){_classCallCheck(this,e),this.factory=t,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r};function Vt(e,t,n){for(var r=st(e),i=0;i<n.length;){var o=n[i];if("number"==typeof o){if(0!==o)break;i++;var a=n[i++],s=n[i++],l=n[i++];r?e.setAttribute(t,s,l,a):t.setAttributeNS(a,s,l)}else{var u=o,c=n[++i];64===u.charCodeAt(0)?r&&e.setProperty(t,u,c):r?e.setAttribute(t,u,c):t.setAttribute(u,c),i++}}return i}function zt(e,t){if(null===t||0===t.length);else if(null===e||0===e.length)e=t.slice();else for(var n=-1,r=0;r<t.length;r++){var i=t[r];"number"==typeof i?n=i:0===n||jt(e,n,i,null,-1===n||2===n?t[++r]:null)}return e}function jt(e,t,n,r,i){var o=0,a=e.length;if(-1===t)a=-1;else for(;o<e.length;){var s=e[o++];if("number"==typeof s){if(s===t){a=-1;break}if(s>t){a=o-1;break}}}for(;o<e.length;){var l=e[o];if("number"==typeof l)break;if(l===n){if(null===r)return void(null!==i&&(e[o+1]=i));if(r===e[o+1])return void(e[o+2]=i)}o++,null!==r&&o++,null!==i&&o++}-1!==a&&(e.splice(a,0,t),o=a+1),e.splice(o++,0,n),null!==r&&e.splice(o++,0,r),null!==i&&e.splice(o++,0,i)}function qt(e){return 32767&e}function Wt(e,t){for(var n=e>>16,r=t;n>0;)r=r[15],n--;return r}function Ut(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():function(e){return"string"==typeof e?e:null==e?"":""+e}(e)}var Xt=("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(be);function Gt(e){return e instanceof Function?e():e}var Zt=!0;function Yt(e){var t=Zt;return Zt=e,t}var Kt=0;function Jt(e,t){var n=tn(e,t);if(-1!==n)return n;var r=t[1];r.firstCreatePass&&(e.injectorIndex=t.length,en(r.data,e),en(t,null),en(r.blueprint,null));var i=nn(e,t),o=e.injectorIndex;if(-1!==i)for(var a=qt(i),s=Wt(i,t),l=s[1].data,u=0;u<8;u++)t[o+u]=s[a+u]|l[a+u];return t[o+8]=i,o}function en(e,t){e.push(0,0,0,0,0,0,0,0,t)}function tn(e,t){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null==t[e.injectorIndex+8]?-1:e.injectorIndex}function nn(e,t){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;for(var n=t[6],r=1;n&&-1===n.injectorIndex;)n=(t=t[15])?t[6]:null,r++;return n?n.injectorIndex|r<<16:-1}function rn(e,t,n){!function(e,t,n){var r="string"!=typeof n?n[Ae]:n.charCodeAt(0)||0;null==r&&(r=n[Ae]=Kt++);var i=255&r,o=1<<i,a=64&i,s=32&i,l=t.data;128&i?a?s?l[e+7]|=o:l[e+6]|=o:s?l[e+5]|=o:l[e+4]|=o:a?s?l[e+3]|=o:l[e+2]|=o:s?l[e+1]|=o:l[e]|=o}(e,t,n)}var on={};function an(e,t,n,r,i,o){var a=t[1],s=a.data[e+8],l=function(e,t,n,r,i){for(var o=e.providerIndexes,a=t.data,s=65535&o,l=e.directiveStart,u=o>>16,c=i?s+u:e.directiveEnd,h=r?s:s+u;h<c;h++){var f=a[h];if(h<l&&n===f||h>=l&&f.type===n)return h}if(i){var d=a[l];if(d&&ot(d)&&d.type===n)return l}return null}(s,a,n,null==r?function(e){return 2==(2&e.flags)}(s)&&Zt:r!=a&&3===s.type,i&K.Host&&o===s);return null!==l?sn(t,a,l,s):on}function sn(e,t,n,r){var i=e[n],o=t.data;if(i instanceof Bt){var a=i;if(a.resolving)throw new Error("Circular dep for ".concat(Ut(o[n])));var s,l=Yt(a.canSeeViewProviders);a.resolving=!0,a.injectImpl&&(s=Re(a.injectImpl)),At(e,r);try{i=e[n]=a.factory(void 0,o,e,r),t.firstCreatePass&&n>=r.directiveStart&&function(e,t,n){var r=t.onChanges,i=t.onInit,o=t.doCheck;r&&((n.preOrderHooks||(n.preOrderHooks=[])).push(e,r),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,r)),i&&(n.preOrderHooks||(n.preOrderHooks=[])).push(-e,i),o&&((n.preOrderHooks||(n.preOrderHooks=[])).push(e,o),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,o))}(n,o[n],t)}finally{a.injectImpl&&Re(s),Yt(l),a.resolving=!1,Dt()}}return i}function ln(e,t,n){var r=64&e,i=32&e;return!!((128&e?r?i?n[t+7]:n[t+6]:i?n[t+5]:n[t+4]:r?i?n[t+3]:n[t+2]:i?n[t+1]:n[t])&1<<e)}function un(e,t){return!(e&K.Self||e&K.Host&&t)}var cn=function(){function e(t,n){_classCallCheck(this,e),this._tNode=t,this._lView=n}return _createClass(e,[{key:"get",value:function(t,n){return function(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:K.Default,o=arguments.length>4?arguments[4]:void 0;if(null!==t){var a=function(e){if("string"==typeof e)return e.charCodeAt(0)||0;var t=e[Ae];return"number"==typeof t&&t>0?255&t:t}(r);if("function"==typeof a){At(n,t);try{var s=a();if(null!=s||i&K.Optional)return s;throw new Error("No provider for ".concat(Ut(r),"!"))}finally{Dt()}}else if("number"==typeof a){if(-1===a)return new e(t,n);var l=null,u=tn(t,n),c=-1,h=i&K.Host?n[16][6]:null;for((-1===u||i&K.SkipSelf)&&(c=-1===u?nn(t,n):n[u+8],un(i,!1)?(l=n[1],u=qt(c),n=Wt(c,n)):u=-1);-1!==u;){c=n[u+8];var f=n[1];if(ln(a,u,f.data)){var d=an(u,n,r,l,i,h);if(d!==on)return d}un(i,n[1].data[u+8]===h)&&ln(a,u,n)?(l=f,u=qt(c),n=Wt(c,n)):u=-1}}}if(i&K.Optional&&void 0===o&&(o=null),0==(i&(K.Self|K.Host))){var v=n[9],p=Re(void 0);try{return v?v.get(r,o,i&K.Optional):Le(r,o,i&K.Optional)}finally{Re(p)}}if(i&K.Optional)return o;throw new Error("NodeInjector: NOT_FOUND [".concat(Ut(r),"]"))}(this._tNode,this._lView,t,void 0,n)}}]),e}();function hn(e){return e.ngDebugContext}function fn(e){return e.ngOriginalError}function dn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];e.error.apply(e,n)}var vn=function(){function e(){_classCallCheck(this,e),this._console=console}return _createClass(e,[{key:"handleError",value:function(e){var t=this._findOriginalError(e),n=this._findContext(e),r=function(e){return e.ngErrorLogger||dn}(e);r(this._console,"ERROR",e),t&&r(this._console,"ORIGINAL ERROR",t),n&&r(this._console,"ERROR CONTEXT",n)}},{key:"_findContext",value:function(e){return e?hn(e)?hn(e):this._findContext(fn(e)):null}},{key:"_findOriginalError",value:function(e){for(var t=fn(e);t&&fn(t);)t=fn(t);return t}}]),e}(),pn=!0,gn=!1;function mn(){return gn=!0,pn}function yn(e,t){e.__ngContext__=t}function kn(e){throw new Error("Multiple components match node with tagname ".concat(e.tagName))}function bn(){throw new Error("Cannot mix multi providers and regular providers")}function wn(e,t,n){for(var r=e.length;;){var i=e.indexOf(t,n);if(-1===i)return i;if(0===i||e.charCodeAt(i-1)<=32){var o=t.length;if(i+o===r||e.charCodeAt(i+o)<=32)return i}n=i+1}}function _n(e,t,n){for(var r=0;r<e.length;){var i=e[r++];if(n&&"class"===i){if(-1!==wn((i=e[r]).toLowerCase(),t,0))return!0}else if(1===i){for(;r<e.length&&"string"==typeof(i=e[r++]);)if(i.toLowerCase()===t)return!0;return!1}}return!1}function Cn(e,t,n){return t===(0!==e.type||n?e.tagName:"ng-template")}function On(e,t,n){for(var r=4,i=e.attrs||[],o=function(e){for(var t=0;t<e.length;t++)if(3===(n=e[t])||4===n||6===n)return t;var n;return e.length}(i),a=!1,s=0;s<t.length;s++){var l=t[s];if("number"!=typeof l){if(!a)if(4&r){if(r=2|1&r,""!==l&&!Cn(e,l,n)||""===l&&1===t.length){if(xn(r))return!1;a=!0}}else{var u=8&r?l:t[++s];if(8&r&&null!==e.attrs){if(!_n(e.attrs,u,n)){if(xn(r))return!1;a=!0}continue}var c=Sn(8&r?"class":l,i,0==e.type&&"ng-template"!==e.tagName,n);if(-1===c){if(xn(r))return!1;a=!0;continue}if(""!==u){var h;h=c>o?"":i[c+1].toLowerCase();var f=8&r?h:null;if(f&&-1!==wn(f,u,0)||2&r&&u!==h){if(xn(r))return!1;a=!0}}}}else{if(!a&&!xn(r)&&!xn(l))return!1;if(a&&xn(l))continue;a=!1,r=l|1&r}}return xn(r)||a}function xn(e){return 0==(1&e)}function Sn(e,t,n,r){if(null===t)return-1;var i=0;if(r||!n){for(var o=!1;i<t.length;){var a=t[i];if(a===e)return i;if(3===a||6===a)o=!0;else{if(1===a||2===a){for(var s=t[++i];"string"==typeof s;)s=t[++i];continue}if(4===a)break;if(0===a){i+=4;continue}}i+=o?1:2}return-1}return function(e,t){var n=e.indexOf(4);if(n>-1)for(n++;n<e.length;){if(e[n]===t)return n;n++}return-1}(t,e)}function An(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=0;r<t.length;r++)if(On(e,t[r],n))return!0;return!1}function Pn(e,t){return e?":not("+t.trim()+")":t}function Tn(e){for(var t=e[0],n=1,r=2,i="",o=!1;n<e.length;){var a=e[n];if("string"==typeof a)if(2&r){var s=e[++n];i+="["+a+(s.length>0?'="'+s+'"':"")+"]"}else 8&r?i+="."+a:4&r&&(i+=" "+a);else""===i||xn(a)||(t+=Pn(o,i),i=""),r=a,o=o||!xn(r);n++}return""!==i&&(t+=Pn(o,i)),t}var In={};function En(e){var t=e[3];return rt(t)?t[3]:t}function Dn(e,t){var n=e.contentQueries;if(null!==n)for(var r=0;r<n.length;r+=2){var i=n[r],o=n[r+1];if(-1!==o){var a=e.data[o];St(i),a.contentQueries(2,t[o],o)}}}function Mn(e,t,n){return st(t)?t.createElement(e,n):null===n?t.createElement(e):t.createElementNS(n,e)}function Qn(e,t,n,r,i,o,a,s,l,u){var c=t.blueprint.slice();return c[0]=i,c[2]=140|r,pt(c),c[3]=c[15]=e,c[8]=n,c[10]=a||e&&e[10],c[11]=s||e&&e[11],c[12]=l||e&&e[12]||null,c[9]=u||e&&e[9]||null,c[6]=o,c[16]=2==t.type?e[16]:c,c}function Rn(e,t,n,r,i,o){var a=n+19,s=e.data[a]||function(e,t,n,r,i,o){var a=bt(),s=_t(),l=s?a:a&&a.parent,u=e.data[n]=Vn(0,l&&l!==t?l:null,r,n,i,o);return null===e.firstChild&&(e.firstChild=u),a&&(!s||null!=a.child||null===u.parent&&2!==a.type?s||(a.next=u):a.child=u),u}(e,t,a,r,i,o);return wt(s,!0),s}function Hn(e,t,n){Pt(t,t[6]);try{var r=e.viewQuery;null!==r&&sr(1,r,n);var i=e.template;null!==i&&Fn(e,t,i,1,n),e.firstCreatePass&&(e.firstCreatePass=!1),e.staticContentQueries&&Dn(e,t),e.staticViewQueries&&sr(2,e.viewQuery,n);var o=e.components;null!==o&&function(e,t){for(var n=0;n<t.length;n++)rr(e,t[n])}(t,o)}finally{t[2]&=-5,Mt()}}function Nn(e,t,n,r){var i=t[2];if(256!=(256&i)){Pt(t,t[6]);var o=Ct();try{pt(t),gt.lFrame.bindingIndex=e.bindingStartIndex,null!==n&&Fn(e,t,n,2,r);var a=3==(3&i);if(!o)if(a){var s=e.preOrderCheckHooks;null!==s&&Ht(t,s,null)}else{var l=e.preOrderHooks;null!==l&&Nt(t,l,0,null),Lt(t,0)}if(function(e){for(var t=e[13];null!==t;){var n=void 0;if(rt(t)&&(n=t[2])>>1==-1){for(var r=9;r<t.length;r++){var i=t[r],o=i[1];dt(i)&&Nn(o,i,o.template,i[8])}0!=(1&n)&&tr(t,e[16])}t=t[4]}}(t),null!==e.contentQueries&&Dn(e,t),!o)if(a){var u=e.contentCheckHooks;null!==u&&Ht(t,u)}else{var c=e.contentHooks;null!==c&&Nt(t,c,1),Lt(t,1)}!function(e,t){try{var n=e.expandoInstructions;if(null!==n)for(var r=e.expandoStartIndex,i=-1,o=0;o<n.length;o++){var a=n[o];"number"==typeof a?a<=0?(Qt(0-a),i=r+=9+n[++o]):r+=a:(null!==a&&(xt(r,i),a(2,t[i])),i++)}}finally{Qt(-1)}}(e,t);var h=e.components;null!==h&&function(e,t){for(var n=0;n<t.length;n++)nr(e,t[n])}(t,h);var f=e.viewQuery;if(null!==f&&sr(2,f,r),!o)if(a){var d=e.viewCheckHooks;null!==d&&Ht(t,d)}else{var v=e.viewHooks;null!==v&&Nt(t,v,2),Lt(t,2)}!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),o||(t[2]&=-73)}finally{Mt()}}}function Ln(e,t,n,r){var i=t[10],o=!Ct(),a=4==(4&t[2]);try{o&&!a&&i.begin&&i.begin(),a&&Hn(e,t,r),Nn(e,t,n,r)}finally{o&&!a&&i.end&&i.end()}}function Fn(e,t,n,r,i){var o=gt.lFrame.selectedIndex;try{Qt(-1),2&r&&t.length>19&&function(e,t,n,r){if(!r)if(3==(3&t[2])){var i=e.preOrderCheckHooks;null!==i&&Ht(t,i,0)}else{var o=e.preOrderHooks;null!==o&&Nt(t,o,0,0)}Qt(0)}(e,t,0,Ct()),n(r,i)}finally{Qt(o)}}function $n(e){return e.tView||(e.tView=Bn(1,-1,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts))}function Bn(e,t,n,r,i,o,a,s,l,u){var c=19+r,h=c+i,f=function(e,t){for(var n=[],r=0;r<t;r++)n.push(r<e?null:In);return n}(c,h);return f[1]={type:e,id:t,blueprint:f,template:n,queries:null,viewQuery:s,node:null,data:f.slice().fill(null,c),bindingStartIndex:c,expandoStartIndex:h,expandoInstructions:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof o?o():o,pipeRegistry:"function"==typeof a?a():a,firstChild:null,schemas:l,consts:u}}function Vn(e,t,n,r,i,o){return{type:n,index:r,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,tagName:i,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,residualStyles:void 0,classes:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function zn(e,t,n){for(var r in e)if(e.hasOwnProperty(r)){var i=e[r];(n=null===n?{}:n).hasOwnProperty(r)?n[r].push(t,i):n[r]=[t,i]}return n}function jn(e,t){var n=e.expandoInstructions;n.push(t.hostBindings),0!==t.hostVars&&n.push(t.hostVars)}function qn(e,t,n){for(var r=0;r<n;r++)t.push(In),e.blueprint.push(In),e.data.push(null)}function Wn(e,t){null!==e.hostBindings&&e.hostBindings(1,t)}function Un(e,t,n){var r=19-t.index,i=e.data.length-(65535&t.providerIndexes);(e.expandoInstructions||(e.expandoInstructions=[])).push(r,i,n)}function Xn(e,t){t.flags|=2,(e.components||(e.components=[])).push(t.index)}function Gn(e,t,n){if(n){if(t.exportAs)for(var r=0;r<t.exportAs.length;r++)n[t.exportAs[r]]=e;ot(t)&&(n[""]=e)}}function Zn(e,t,n){e.flags|=1,e.directiveStart=t,e.directiveEnd=t+n,e.providerIndexes=t}function Yn(e,t,n){e.data.push(n);var r=n.factory||(n.factory=et(n.type)),i=new Bt(r,ot(n),null);e.blueprint.push(i),t.push(i)}function Kn(e,t,n){var r=ct(t,e),i=$n(n),o=e[10],a=ir(e,Qn(e,i,null,n.onPush?64:16,r,t,o,o.createRenderer(r,n)));e[t.index]=a}function Jn(e,t,n,r,i,o){var a=o[t];if(null!==a)for(var s=r.setInput,l=0;l<a.length;){var u=a[l++],c=a[l++],h=a[l++];null!==s?r.setInput(n,h,u,c):n[c]=h}}function er(e,t){for(var n=null,r=0;r<t.length;){var i=t[r];if(0!==i)if(5!==i){if("number"==typeof i)break;e.hasOwnProperty(i)&&(null===n&&(n=[]),n.push(i,e[i],t[r+1])),r+=2}else r+=2;else r+=4}return n}function tr(e,t){for(var n=e[5],r=0;r<n.length;r++){var i=n[r],o=i[3][3][16];if(o!==t&&0==(16&o[2])){var a=i[1];Nn(a,i,a.template,i[8])}}}function nr(e,t){var n=ht(t,e);if(dt(n)&&80&n[2]){var r=n[1];Nn(r,n,r.template,n[8])}}function rr(e,t){var n=ht(t,e),r=n[1];!function(e,t){for(var n=t.length;n<e.blueprint.length;n++)t.push(e.blueprint[n])}(r,n),Hn(r,n,n[8])}function ir(e,t){return e[13]?e[14][4]=t:e[13]=t,e[14]=t,t}function or(e,t,n){var r=t[10];r.begin&&r.begin();try{Nn(e,t,e.template,n)}catch(i){throw function(e,t){var n=e[9],r=n?n.get(vn,null):null;r&&r.handleError(t)}(t,i),i}finally{r.end&&r.end()}}function ar(e){!function(e){for(var t=0;t<e.components.length;t++){var n=e.components[t],r=ft(n),i=r[1];Ln(i,r,i.template,n)}}(e[8])}function sr(e,t,n){St(0),t(e,n)}var lr=Promise.resolve(null);function ur(e,t){var n=t[3];return-1===e.index?rt(n)?n:null:n}function cr(e,t,n,r,i){if(null!=r){var o,a=!1;rt(r)?o=r:nt(r)&&(a=!0,r=r[0]);var s=ut(r);0===e&&null!==n?null==i?vr(t,n,s):dr(t,n,s,i||null):1===e&&null!==n?dr(t,n,s,i||null):2===e?function(e,t,n){var r=gr(e,t);r&&function(e,t,n,r){st(e)?e.removeChild(t,n,r):t.removeChild(n)}(e,r,t,n)}(t,s,a):3===e&&t.destroyNode(s),null!=o&&function(e,t,n,r,i){var o=n[7];o!==ut(n)&&cr(t,e,r,o,i);for(var a=9;a<n.length;a++){var s=n[a];kr(s[1],s,e,t,r,o)}}(t,e,o,n,i)}}function hr(e,t){var n;return nt(e)&&(n=e[6])&&2===n.type?ur(n,e):e[3]===t?null:e[3]}function fr(e,t){if(!(256&t[2])){t[2]&=-129,t[2]|=256,function(e,t){var n;if(null!=e&&null!=(n=e.destroyHooks))for(var r=0;r<n.length;r+=2){var i=t[n[r]];i instanceof Bt||n[r+1].call(i)}}(e,t),function(e,t){var n=e.cleanup;if(null!==n){for(var r=t[7],i=0;i<n.length-1;i+=2)if("string"==typeof n[i]){var o=n[i+1],a="function"==typeof o?o(t):ut(t[o]),s=r[n[i+2]],l=n[i+3];"boolean"==typeof l?a.removeEventListener(n[i],s,l):l>=0?r[l]():r[-l].unsubscribe(),i+=2}else n[i].call(r[n[i+1]]);t[7]=null}}(e,t);var n=t[6];n&&3===n.type&&st(t[11])&&t[11].destroy();var r=t[17];if(null!==r&&rt(t[3])){r!==t[3]&&function(e,t){var n=e[5],r=n.indexOf(t);n.splice(r,1)}(r,t);var i=t[5];null!==i&&i.detachView(e)}}}function dr(e,t,n,r){st(e)?e.insertBefore(t,n,r):t.insertBefore(n,r,!0)}function vr(e,t,n){st(e)?e.appendChild(t,n):t.appendChild(n)}function pr(e,t,n,r){null!==r?dr(e,t,n,r):vr(e,t,n)}function gr(e,t){return st(e)?e.parentNode(t):t.parentNode}function mr(e,t,n,r){var i=function(e,t,n){for(var r,i,o=t.parent;null!=o&&(4===o.type||5===o.type);)o=(t=o).parent;if(null==o){var a=n[6];return 2===a.type?(i=ur(a,r=n))?gr(r[11],i[7]):null:n[0]}if(t&&5===t.type&&4&t.flags)return ct(t,n).parentNode;if(2&o.flags){var s=e.data,l=s[s[o.index].directiveStart].encapsulation;if(l!==je.ShadowDom&&l!==je.Native)return null}return ct(o,n)}(e,r,t);if(null!=i){var o=t[11],a=function(e,t){if(2===e.type){var n=ur(e,t);return null===n?null:function e(t,n){var r=9+t+1;if(r<n.length){var i=n[r],o=i[1].firstChild;if(null!==o)return function t(n,r){if(null!==r){var i=r.type;if(3===i)return ct(r,n);if(0===i)return e(-1,n[r.index]);if(4===i||5===i){var o=r.child;if(null!==o)return t(n,o);var a=n[r.index];return rt(a)?e(-1,a):ut(a)}var s=n[16],l=s[6],u=En(s),c=l.projection[r.projection];return null!=c?t(u,c):t(n,r.next)}return null}(i,o)}return n[7]}(n.indexOf(t,9)-9,n)}return 4===e.type||5===e.type?ct(e,t):null}(r.parent||t[6],t);if(Array.isArray(n))for(var s=0;s<n.length;s++)pr(o,i,n[s],a);else pr(o,i,n,a)}}function yr(e,t,n,r,i,o,a){for(;null!=n;){var s=r[n.index],l=n.type;a&&0===t&&(s&&yn(ut(s),r),n.flags|=4),64!=(64&n.flags)&&(4===l||5===l?(yr(e,t,n.child,r,i,o,!1),cr(t,e,i,s,o)):1===l?br(e,t,r,n,i,o):cr(t,e,i,s,o)),n=a?n.projectionNext:n.next}}function kr(e,t,n,r,i,o){yr(n,r,e.node.child,t,i,o,!1)}function br(e,t,n,r,i,o){var a=n[16],s=a[6].projection[r.projection];if(Array.isArray(s))for(var l=0;l<s.length;l++)cr(t,e,i,s[l],o);else yr(e,t,s,a[3],i,o,!0)}function wr(e,t,n){st(e)?e.setAttribute(t,"style",n):t.style.cssText=n}function _r(e,t,n){st(e)?""===n?e.removeAttribute(t,"class"):e.setAttribute(t,"class",n):t.className=n}var Cr,Or=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e))._view=e,r}return _createClass(n,[{key:"detectChanges",value:function(){ar(this._view)}},{key:"checkNoChanges",value:function(){!function(e){Ot(!0);try{ar(e)}finally{Ot(!1)}}(this._view)}},{key:"context",get:function(){return null}}]),n}(function(){function e(t,n){_classCallCheck(this,e),this._lView=t,this._cdRefInjectingView=n,this._appRef=null,this._viewContainerRef=null,this._tViewNode=null}return _createClass(e,[{key:"destroy",value:function(){if(this._appRef)this._appRef.detachView(this);else if(this._viewContainerRef){var e=this._viewContainerRef.indexOf(this);e>-1&&this._viewContainerRef.detach(e),this._viewContainerRef=null}!function(e,t){if(!(256&t[2])){var n=t[11];st(n)&&n.destroyNode&&kr(e,t,n,3,null,null),function(e){var t=e[13];if(!t)return fr(e[1],e);for(;t;){var n=null;if(nt(t))n=t[13];else{var r=t[9];r&&(n=r)}if(!n){for(;t&&!t[4]&&t!==e;)nt(t)&&fr(t[1],t),t=hr(t,e);null===t&&(t=e),nt(t)&&fr(t[1],t),n=t&&t[4]}t=n}}(t)}}(this._lView[1],this._lView)}},{key:"onDestroy",value:function(e){var t,n,r,i;t=this._lView[1],r=e,(i=n=this._lView,i[7]||(i[7]=[])).push(r),t.firstCreatePass&&function(e){return e.cleanup||(e.cleanup=[])}(t).push(n[7].length-1,null)}},{key:"markForCheck",value:function(){!function(e){for(;e;){e[2]|=64;var t=En(e);if(0!=(512&e[2])&&!t)return e;e=t}}(this._cdRefInjectingView||this._lView)}},{key:"detach",value:function(){this._lView[2]&=-129}},{key:"reattach",value:function(){this._lView[2]|=128}},{key:"detectChanges",value:function(){or(this._lView[1],this._lView,this.context)}},{key:"checkNoChanges",value:function(){!function(e,t,n){Ot(!0);try{or(e,t,n)}finally{Ot(!1)}}(this._lView[1],this._lView,this.context)}},{key:"attachToViewContainerRef",value:function(e){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._viewContainerRef=e}},{key:"detachFromAppRef",value:function(){var e;this._appRef=null,kr(this._lView[1],e=this._lView,e[11],2,null,null)}},{key:"attachToAppRef",value:function(e){if(this._viewContainerRef)throw new Error("This view is already attached to a ViewContainer!");this._appRef=e}},{key:"rootNodes",get:function(){var e=this._lView;return null==e[0]?function e(t,n,r,i){for(var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];null!==r;){var a=n[r.index];if(null!==a&&i.push(ut(a)),rt(a))for(var s=9;s<a.length;s++){var l=a[s],u=l[1].firstChild;null!==u&&e(l[1],l,u,i)}var c=r.type;if(4===c||5===c)e(t,n,r.child,i);else if(1===c){var h=n[16],f=h[6],d=En(h),v=f.projection[r.projection];null!==v&&null!==d&&e(d[1],d,v,i,!0)}r=o?r.projectionNext:r.next}return i}(e[1],e,e[6].child,[]):[]}},{key:"context",get:function(){return this._lView[8]}},{key:"destroyed",get:function(){return 256==(256&this._lView[2])}}]),e}());function xr(e,t,n){return Cr||(Cr=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return n}(e)),new Cr(ct(t,n))}var Sr=new Pe("Set Injector scope."),Ar={},Pr={},Tr=[],Ir=void 0;function Er(){return void 0===Ir&&(Ir=new $e),Ir}function Dr(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return new Mr(e,n,t||Er(),r)}var Mr=function(){function e(t,n,r){var i=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;_classCallCheck(this,e),this.parent=r,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;var a=[];n&&Ve(n,(function(e){return i.processProvider(e,t,n)})),Ve([t],(function(e){return i.processInjectorType(e,[],a)})),this.records.set(Te,Rr(void 0,this));var s=this.records.get(Sr);this.scope=null!=s?s.value:null,this.source=o||("object"==typeof t?null:ce(t))}return _createClass(e,[{key:"destroy",value:function(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach((function(e){return e.ngOnDestroy()}))}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ie,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:K.Default;this.assertNotDestroyed();var r,i=Qe(this);try{if(!(n&K.SkipSelf)){var o=this.records.get(e);if(void 0===o){var a=("function"==typeof(r=e)||"object"==typeof r&&r instanceof Pe)&&ne(e);o=a&&this.injectableDefInScope(a)?Rr(Qr(e),Ar):null,this.records.set(e,o)}if(null!=o)return this.hydrate(e,o)}return(n&K.Self?Er():this.parent).get(e,t=n&K.Optional&&t===Ie?null:t)}catch(s){if("NullInjectorError"===s.name){if((s.ngTempTokenPath=s.ngTempTokenPath||[]).unshift(ce(e)),i)throw s;return function(e,t,n,r){var i=e.ngTempTokenPath;throw t.__source&&i.unshift(t.__source),e.message=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.substr(2):e;var i=ce(t);if(Array.isArray(t))i=t.map(ce).join(" -> ");else if("object"==typeof t){var o=[];for(var a in t)if(t.hasOwnProperty(a)){var s=t[a];o.push(a+":"+("string"==typeof s?JSON.stringify(s):ce(s)))}i="{".concat(o.join(", "),"}")}return"".concat(n).concat(r?"("+r+")":"","[").concat(i,"]: ").concat(e.replace(Ee,"\n  "))}("\n"+e.message,i,"R3InjectorError",r),e.ngTokenPath=i,e.ngTempTokenPath=null,e}(s,e,0,this.source)}throw s}finally{Qe(i)}}},{key:"_resolveInjectorDefTypes",value:function(){var e=this;this.injectorDefTypes.forEach((function(t){return e.get(t)}))}},{key:"toString",value:function(){var e=[];return this.records.forEach((function(t,n){return e.push(ce(n))})),"R3Injector[".concat(e.join(", "),"]")}},{key:"assertNotDestroyed",value:function(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}},{key:"processInjectorType",value:function(e,t,n){var r=this;if(!(e=ve(e)))return!1;var i=ie(e),o=null==i&&e.ngModule||void 0,a=void 0===o?e:o,s=-1!==n.indexOf(a);if(void 0!==o&&(i=ie(o)),null==i)return!1;if(null!=i.imports&&!s){var l;n.push(a);try{Ve(i.imports,(function(e){r.processInjectorType(e,t,n)&&(void 0===l&&(l=[]),l.push(e))}))}finally{}if(void 0!==l)for(var u=function(e){var t=l[e],n=t.ngModule,i=t.providers;Ve(i,(function(e){return r.processProvider(e,n,i||Tr)}))},c=0;c<l.length;c++)u(c)}this.injectorDefTypes.add(a),this.records.set(a,Rr(i.factory,Ar));var h=i.providers;if(null!=h&&!s){var f=e;Ve(h,(function(e){return r.processProvider(e,f,h)}))}return void 0!==o&&void 0!==e.providers}},{key:"processProvider",value:function(e,t,n){var r=Nr(e=ve(e))?e:ve(e&&e.provide),i=function(e,t,n){return Hr(e)?Rr(void 0,e.useValue):Rr(function(e,t,n){var r,i=void 0;if(Nr(e)){var o=ve(e);return et(o)||Qr(o)}if(Hr(e))i=function(){return ve(e.useValue)};else if((r=e)&&r.useFactory)i=function(){return e.useFactory.apply(e,_toConsumableArray(Fe(e.deps||[])))};else if(function(e){return!(!e||!e.useExisting)}(e))i=function(){return Ne(ve(e.useExisting))};else{var a=ve(e&&(e.useClass||e.provide));if(a||function(e,t,n){var r="";throw e&&t&&(r=" - only instances of Provider and Type are allowed, got: [".concat(t.map((function(e){return e==n?"?"+n+"?":"..."})).join(", "),"]")),new Error("Invalid provider for the NgModule '".concat(ce(e),"'")+r)}(t,n,e),!function(e){return!!e.deps}(e))return et(a)||Qr(a);i=function(){return _construct(a,_toConsumableArray(Fe(e.deps)))}}return i}(e,t,n),Ar)}(e,t,n);if(Nr(e)||!0!==e.multi){var o=this.records.get(r);o&&void 0!==o.multi&&bn()}else{var a=this.records.get(r);a?void 0===a.multi&&bn():((a=Rr(void 0,Ar,!0)).factory=function(){return Fe(a.multi)},this.records.set(r,a)),r=e,a.multi.push(e)}this.records.set(r,i)}},{key:"hydrate",value:function(e,t){var n;return t.value===Pr?function(e){throw new Error("Cannot instantiate cyclic dependency! ".concat(e))}(ce(e)):t.value===Ar&&(t.value=Pr,t.value=t.factory()),"object"==typeof t.value&&t.value&&null!==(n=t.value)&&"object"==typeof n&&"function"==typeof n.ngOnDestroy&&this.onDestroy.add(t.value),t.value}},{key:"injectableDefInScope",value:function(e){return!!e.providedIn&&("string"==typeof e.providedIn?"any"===e.providedIn||e.providedIn===this.scope:this.injectorDefTypes.has(e.providedIn))}},{key:"destroyed",get:function(){return this._destroyed}}]),e}();function Qr(e){var t=ne(e),n=null!==t?t.factory:et(e);if(null!==n)return n;var r=ie(e);if(null!==r)return r.factory;if(e instanceof Pe)throw new Error("Token ".concat(ce(e)," is missing a \u0275prov definition."));if(e instanceof Function)return function(e){var t=e.length;if(t>0){var n=function(e,t){for(var n=[],r=0;r<e;r++)n.push("?");return n}(t);throw new Error("Can't resolve all parameters for ".concat(ce(e),": (").concat(n.join(", "),")."))}var r=function(e){var t=e&&(e[oe]||e[le]||e[se]&&e[se]());if(t){var n=function(e){if(e.hasOwnProperty("name"))return e.name;var t=(""+e).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(e);return console.warn('DEPRECATED: DI is instantiating a token "'.concat(n,'" that inherits its @Injectable decorator but does not provide one itself.\n')+'This will become an error in v10. Please add @Injectable() to the "'.concat(n,'" class.')),t}return null}(e);return null!==r?function(){return r.factory(e)}:function(){return new e}}(e);throw new Error("unreachable")}function Rr(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{factory:e,value:t,multi:n?[]:void 0}}function Hr(e){return null!==e&&"object"==typeof e&&De in e}function Nr(e){return"function"==typeof e}var Lr=function(e,t,n){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0,i=Dr(e,t,n,r);return i._resolveInjectorDefTypes(),i}({name:n},t,e,n)},Fr=function(){var e=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"create",value:function(e,t){return Array.isArray(e)?Lr(e,t,""):Lr(e.providers,e.parent,e.name||"")}}]),e}();return e.THROW_IF_NOT_FOUND=Ie,e.NULL=new $e,e.\u0275prov=ee({token:e,providedIn:"any",factory:function(){return Ne(Te)}}),e.__NG_ELEMENT_ID__=-1,e}(),$r=new Map,Br=new Set;function Vr(e){return"string"==typeof e?e:e.text()}function zr(e,t){for(var n=e.styles,r=e.classes,i=0,o=0;o<t.length;o++){var a=t[o];"number"==typeof a?i=a:1==i?r=he(r,a):2==i&&(n=he(n,a+": "+t[++o]+";"))}null!==n&&(e.styles=n),null!==r&&(e.classes=r)}var jr=null;function qr(){if(!jr){var e=be.Symbol;if(e&&e.iterator)jr=e.iterator;else for(var t=Object.getOwnPropertyNames(Map.prototype),n=0;n<t.length;++n){var r=t[n];"entries"!==r&&"size"!==r&&Map.prototype[r]===Map.prototype.entries&&(jr=r)}}return jr}function Wr(e,t){return e===t||"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t)}function Ur(e){return!!Xr(e)&&(Array.isArray(e)||!(e instanceof Map)&&qr()in e)}function Xr(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function Gr(e,t,n,r,i){var o=i?"class":"style";!function(e,t,n,r,i){for(var o=0;o<n.length;){var a=n[o++],s=n[o++],l=t[a],u=e.data[a];null!==u.setInput?u.setInput(l,i,r,s):l[s]=i}}(e,n,t.inputs[o],o,r)}function Zr(e,t,n,r){var i=yt(),o=kt(),a=19+e,s=i[11],l=i[a]=Mn(t,s,gt.lFrame.currentNamespace),u=o.firstCreatePass?function(e,t,n,r,i,o,a){var s=t.consts,l=vt(s,o),u=Rn(t,n[6],e,3,i,l);return function(e,t,n,r){if(mt()){var i=function(e,t,n){var r=e.directiveRegistry,i=null;if(r)for(var o=0;o<r.length;o++){var a=r[o];An(n,a.selectors,!1)&&(i||(i=[]),rn(Jt(n,t),e,a.type),ot(a)?(2&n.flags&&kn(n),Xn(e,n),i.unshift(a)):i.push(a))}return i}(e,t,n),o=null===r?null:{"":-1};if(null!==i){var a=0;!0,Zn(n,e.data.length,i.length);for(var s=0;s<i.length;s++){var l=i[s];l.providersResolver&&l.providersResolver(l)}Un(e,n,i.length);for(var u=!1,c=!1,h=0;h<i.length;h++){var f=i[h];n.mergedAttrs=zt(n.mergedAttrs,f.hostAttrs),Yn(e,t,f),Gn(e.data.length-1,f,o),null!==f.contentQueries&&(n.flags|=8),null===f.hostBindings&&null===f.hostAttrs&&0===f.hostVars||(n.flags|=128),!u&&(f.onChanges||f.onInit||f.doCheck)&&((e.preOrderHooks||(e.preOrderHooks=[])).push(n.index-19),u=!0),c||!f.onChanges&&!f.doCheck||((e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n.index-19),c=!0),jn(e,f),a+=f.hostVars}!function(e,t){for(var n=t.directiveEnd,r=e.data,i=t.attrs,o=[],a=null,s=null,l=t.directiveStart;l<n;l++){var u=r[l],c=u.inputs;o.push(null!==i?er(c,i):null),a=zn(c,l,a),s=zn(u.outputs,l,s)}null!==a&&(a.hasOwnProperty("class")&&(t.flags|=16),a.hasOwnProperty("style")&&(t.flags|=32)),t.initialInputs=o,t.inputs=a,t.outputs=s}(e,n),qn(e,t,a)}o&&function(e,t,n){if(t)for(var r=e.localNames=[],i=0;i<t.length;i+=2){var o=n[t[i+1]];if(null==o)throw new Error("Export of name '".concat(t[i+1],"' not found!"));r.push(t[i],o)}}(n,r,o)}n.mergedAttrs=zt(n.mergedAttrs,n.attrs)}(t,n,u,vt(s,a)),null!==u.mergedAttrs&&zr(u,u.mergedAttrs),null!==t.queries&&t.queries.elementStart(t,u),u}(e,o,i,0,t,n,r):o.data[a];wt(u,!0);var c=u.mergedAttrs;null!==c&&Vt(s,l,c);var h=u.classes;null!==h&&_r(s,l,h);var f=u.styles;null!==f&&wr(s,l,f),mr(o,i,l,u),0===gt.lFrame.elementDepthCount&&yn(l,i),gt.lFrame.elementDepthCount++,function(e){return 1==(1&e.flags)}(u)&&(function(e,t,n){mt()&&(function(e,t,n,r){var i=n.directiveStart,o=n.directiveEnd;e.firstCreatePass||Jt(n,t),yn(r,t);for(var a=n.initialInputs,s=i;s<o;s++){var l=e.data[s],u=ot(l);u&&Kn(t,n,l);var c=sn(t,e,s,n);yn(c,t),null!==a&&Jn(0,s-i,c,l,0,a),u&&(ht(n.index,t)[8]=c)}}(e,t,n,ct(n,t)),128==(128&n.flags)&&function(e,t,n){var r=n.directiveStart,i=n.directiveEnd,o=e.expandoInstructions,a=e.firstCreatePass,s=n.index-19;try{Qt(s);for(var l=r;l<i;l++){var u=e.data[l],c=t[l];null!==u.hostBindings||0!==u.hostVars||null!==u.hostAttrs?Wn(u,c):a&&o.push(null)}}finally{Qt(-1)}}(e,t,n))}(o,i,u),function(e,t,n){if(it(t))for(var r=t.directiveEnd,i=t.directiveStart;i<r;i++){var o=e.data[i];o.contentQueries&&o.contentQueries(1,n[i],i)}}(o,u,i)),null!==r&&function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ct,r=t.localNames;if(null!==r)for(var i=t.index+1,o=0;o<r.length;o+=2){var a=r[o+1],s=-1===a?n(t,e):e[a];e[i++]=s}}(i,u)}function Yr(){var e=bt();_t()?gt.lFrame.isParent=!1:wt(e=e.parent,!1);var t=e;gt.lFrame.elementDepthCount--;var n=kt();n.firstCreatePass&&(Rt(n,e),it(e)&&n.queries.elementEnd(e)),null!==t.classes&&function(e){return 0!=(16&e.flags)}(t)&&Gr(n,t,yt(),t.classes,!0),null!==t.styles&&function(e){return 0!=(32&e.flags)}(t)&&Gr(n,t,yt(),t.styles,!1)}function Kr(e){return!!e&&"function"==typeof e.then}function Jr(e,t){var n=ft(e)[1],r=n.data.length-1;Rt(n,{directiveStart:r,directiveEnd:r+1})}var ei=function e(){_classCallCheck(this,e)},ti=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"resolveComponentFactory",value:function(e){throw function(e){var t=Error("No component factory found for ".concat(ce(e),". Did you add it to @NgModule.entryComponents?"));return t.ngComponent=e,t}(e)}}]),e}(),ni=function(){var e=function e(){_classCallCheck(this,e)};return e.NULL=new ti,e}(),ri=function(){var e=function e(t){_classCallCheck(this,e),this.nativeElement=t};return e.__NG_ELEMENT_ID__=function(){return ii(e)},e}(),ii=function(e){return xr(e,bt(),yt())},oi=function e(){_classCallCheck(this,e)},ai=function(){var e={Important:1,DashCase:2};return e[e.Important]="Important",e[e.DashCase]="DashCase",e}(),si=function(){var e=function e(){_classCallCheck(this,e)};return e.\u0275prov=ee({token:e,providedIn:"root",factory:function(){return null}}),e}(),li=new function e(t){_classCallCheck(this,e),this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}("9.1.0"),ui=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"supports",value:function(e){return Ur(e)}},{key:"create",value:function(e){return new hi(e)}}]),e}(),ci=function(e,t){return t},hi=function(){function e(t){_classCallCheck(this,e),this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||ci}return _createClass(e,[{key:"forEachItem",value:function(e){var t;for(t=this._itHead;null!==t;t=t._next)e(t)}},{key:"forEachOperation",value:function(e){for(var t=this._itHead,n=this._removalsHead,r=0,i=null;t||n;){var o=!n||t&&t.currentIndex<pi(n,r,i)?t:n,a=pi(o,r,i),s=o.currentIndex;if(o===n)r--,n=n._nextRemoved;else if(t=t._next,null==o.previousIndex)r++;else{i||(i=[]);var l=a-r,u=s-r;if(l!=u){for(var c=0;c<l;c++){var h=c<i.length?i[c]:i[c]=0,f=h+c;u<=f&&f<l&&(i[c]=h+1)}i[o.previousIndex]=u-l}}a!==s&&e(o,a,s)}}},{key:"forEachPreviousItem",value:function(e){var t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}},{key:"forEachAddedItem",value:function(e){var t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}},{key:"forEachMovedItem",value:function(e){var t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}},{key:"forEachRemovedItem",value:function(e){var t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}},{key:"forEachIdentityChange",value:function(e){var t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}},{key:"diff",value:function(e){if(null==e&&(e=[]),!Ur(e))throw new Error("Error trying to diff '".concat(ce(e),"'. Only arrays and iterables are allowed"));return this.check(e)?this:null}},{key:"onDestroy",value:function(){}},{key:"check",value:function(e){var t=this;this._reset();var n,r,i,o=this._itHead,a=!1;if(Array.isArray(e)){this.length=e.length;for(var s=0;s<this.length;s++)r=e[s],i=this._trackByFn(s,r),null!==o&&Wr(o.trackById,i)?(a&&(o=this._verifyReinsertion(o,r,i,s)),Wr(o.item,r)||this._addIdentityChange(o,r)):(o=this._mismatch(o,r,i,s),a=!0),o=o._next}else n=0,function(e,t){if(Array.isArray(e))for(var n=0;n<e.length;n++)t(e[n]);else for(var r,i=e[qr()]();!(r=i.next()).done;)t(r.value)}(e,(function(e){i=t._trackByFn(n,e),null!==o&&Wr(o.trackById,i)?(a&&(o=t._verifyReinsertion(o,e,i,n)),Wr(o.item,e)||t._addIdentityChange(o,e)):(o=t._mismatch(o,e,i,n),a=!0),o=o._next,n++})),this.length=n;return this._truncate(o),this.collection=e,this.isDirty}},{key:"_reset",value:function(){if(this.isDirty){var e,t;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=t)e.previousIndex=e.currentIndex,t=e._nextMoved;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}},{key:"_mismatch",value:function(e,t,n,r){var i;return null===e?i=this._itTail:(i=e._prev,this._remove(e)),null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(n,r))?(Wr(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,i,r)):null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Wr(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,i,r)):e=this._addAfter(new fi(t,n),i,r),e}},{key:"_verifyReinsertion",value:function(e,t,n,r){var i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==i?e=this._reinsertAfter(i,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}},{key:"_truncate",value:function(e){for(;null!==e;){var t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}},{key:"_reinsertAfter",value:function(e,t,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);var r=e._prevRemoved,i=e._nextRemoved;return null===r?this._removalsHead=i:r._nextRemoved=i,null===i?this._removalsTail=r:i._prevRemoved=r,this._insertAfter(e,t,n),this._addToMoves(e,n),e}},{key:"_moveAfter",value:function(e,t,n){return this._unlink(e),this._insertAfter(e,t,n),this._addToMoves(e,n),e}},{key:"_addAfter",value:function(e,t,n){return this._insertAfter(e,t,n),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}},{key:"_insertAfter",value:function(e,t,n){var r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new vi),this._linkedRecords.put(e),e.currentIndex=n,e}},{key:"_remove",value:function(e){return this._addToRemovals(this._unlink(e))}},{key:"_unlink",value:function(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);var t=e._prev,n=e._next;return null===t?this._itHead=n:t._next=n,null===n?this._itTail=t:n._prev=t,e}},{key:"_addToMoves",value:function(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}},{key:"_addToRemovals",value:function(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new vi),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}},{key:"_addIdentityChange",value:function(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}},{key:"isDirty",get:function(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}}]),e}(),fi=function e(t,n){_classCallCheck(this,e),this.item=t,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null},di=function(){function e(){_classCallCheck(this,e),this._head=null,this._tail=null}return _createClass(e,[{key:"add",value:function(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}},{key:"get",value:function(e,t){var n;for(n=this._head;null!==n;n=n._nextDup)if((null===t||t<=n.currentIndex)&&Wr(n.trackById,e))return n;return null}},{key:"remove",value:function(e){var t=e._prevDup,n=e._nextDup;return null===t?this._head=n:t._nextDup=n,null===n?this._tail=t:n._prevDup=t,null===this._head}}]),e}(),vi=function(){function e(){_classCallCheck(this,e),this.map=new Map}return _createClass(e,[{key:"put",value:function(e){var t=e.trackById,n=this.map.get(t);n||(n=new di,this.map.set(t,n)),n.add(e)}},{key:"get",value:function(e,t){var n=this.map.get(e);return n?n.get(e,t):null}},{key:"remove",value:function(e){var t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}},{key:"clear",value:function(){this.map.clear()}},{key:"isEmpty",get:function(){return 0===this.map.size}}]),e}();function pi(e,t,n){var r=e.previousIndex;if(null===r)return r;var i=0;return n&&r<n.length&&(i=n[r]),r+t+i}var gi=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"supports",value:function(e){return e instanceof Map||Xr(e)}},{key:"create",value:function(){return new mi}}]),e}(),mi=function(){function e(){_classCallCheck(this,e),this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}return _createClass(e,[{key:"forEachItem",value:function(e){var t;for(t=this._mapHead;null!==t;t=t._next)e(t)}},{key:"forEachPreviousItem",value:function(e){var t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}},{key:"forEachChangedItem",value:function(e){var t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}},{key:"forEachAddedItem",value:function(e){var t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}},{key:"forEachRemovedItem",value:function(e){var t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}},{key:"diff",value:function(e){if(e){if(!(e instanceof Map||Xr(e)))throw new Error("Error trying to diff '".concat(ce(e),"'. Only maps and objects are allowed"))}else e=new Map;return this.check(e)?this:null}},{key:"onDestroy",value:function(){}},{key:"check",value:function(e){var t=this;this._reset();var n=this._mapHead;if(this._appendAfter=null,this._forEach(e,(function(e,r){if(n&&n.key===r)t._maybeAddToChanges(n,e),t._appendAfter=n,n=n._next;else{var i=t._getOrCreateRecordForKey(r,e);n=t._insertBeforeOrAppend(n,i)}})),n){n._prev&&(n._prev._next=null),this._removalsHead=n;for(var r=n;null!==r;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}},{key:"_insertBeforeOrAppend",value:function(e,t){if(e){var n=e._prev;return t._next=e,t._prev=n,e._prev=t,n&&(n._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}},{key:"_getOrCreateRecordForKey",value:function(e,t){if(this._records.has(e)){var n=this._records.get(e);this._maybeAddToChanges(n,t);var r=n._prev,i=n._next;return r&&(r._next=i),i&&(i._prev=r),n._next=null,n._prev=null,n}var o=new yi(e);return this._records.set(e,o),o.currentValue=t,this._addToAdditions(o),o}},{key:"_reset",value:function(){if(this.isDirty){var e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}},{key:"_maybeAddToChanges",value:function(e,t){Wr(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}},{key:"_addToAdditions",value:function(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}},{key:"_addToChanges",value:function(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}},{key:"_forEach",value:function(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach((function(n){return t(e[n],n)}))}},{key:"isDirty",get:function(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}}]),e}(),yi=function e(t){_classCallCheck(this,e),this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null},ki=function(){var e=function(){function e(t){_classCallCheck(this,e),this.factories=t}return _createClass(e,[{key:"find",value:function(e){var t,n=this.factories.find((function(t){return t.supports(e)}));if(null!=n)return n;throw new Error("Cannot find a differ supporting object '".concat(e,"' of type '").concat((t=e).name||typeof t,"'"))}}],[{key:"create",value:function(t,n){if(null!=n){var r=n.factories.slice();t=t.concat(r)}return new e(t)}},{key:"extend",value:function(t){return{provide:e,useFactory:function(n){if(!n)throw new Error("Cannot extend IterableDiffers without a parent injector");return e.create(t,n)},deps:[[e,new Y,new G]]}}}]),e}();return e.\u0275prov=ee({token:e,providedIn:"root",factory:function(){return new e([new ui])}}),e}(),bi=function(){var e=function(){function e(t){_classCallCheck(this,e),this.factories=t}return _createClass(e,[{key:"find",value:function(e){var t=this.factories.find((function(t){return t.supports(e)}));if(t)return t;throw new Error("Cannot find a differ supporting object '".concat(e,"'"))}}],[{key:"create",value:function(t,n){if(n){var r=n.factories.slice();t=t.concat(r)}return new e(t)}},{key:"extend",value:function(t){return{provide:e,useFactory:function(n){if(!n)throw new Error("Cannot extend KeyValueDiffers without a parent injector");return e.create(t,n)},deps:[[e,new Y,new G]]}}}]),e}();return e.\u0275prov=ee({token:e,providedIn:"root",factory:function(){return new e([new gi])}}),e}(),wi=[new gi],_i=new ki([new ui]),Ci=new bi(wi),Oi={},xi=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this)).ngModule=e,r}return _createClass(n,[{key:"resolveComponentFactory",value:function(e){var t=Je(e);return new Pi(t,this.ngModule)}}]),n}(ni);function Si(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push({propName:e[n],templateName:n});return t}var Ai=new Pe("SCHEDULER_TOKEN",{providedIn:"root",factory:function(){return Xt}}),Pi=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var i;return _classCallCheck(this,n),(i=t.call(this)).componentDef=e,i.ngModule=r,i.componentType=e.type,i.selector=e.selectors.map(Tn).join(","),i.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],i.isBoundToModule=!!r,i}return _createClass(n,[{key:"create",value:function(e,t,n,r){var i,o,a=(r=r||this.ngModule)?function(e,t){return{get:function(n,r,i){var o=e.get(n,Oi,i);return o!==Oi||r===Oi?o:t.get(n,r,i)}}}(e,r.injector):e,s=a.get(oi,lt),l=a.get(si,null),u=s.createRenderer(null,this.componentDef),c=this.componentDef.selectors[0][0]||"div",h=n?function(e,t,n){if(st(e))return e.selectRootElement(t,n===je.ShadowDom);var r="string"==typeof t?e.querySelector(t):t;return r.textContent="",r}(u,n,this.componentDef.encapsulation):Mn(c,s.createRenderer(null,this.componentDef),function(e){var t=e.toLowerCase();return"svg"===t?"http://www.w3.org/2000/svg":"math"===t?"http://www.w3.org/1998/MathML/":null}(c)),f=this.componentDef.onPush?576:528,d="string"==typeof n&&/^#root-ng-internal-isolated-\d+/.test(n),v={components:[],scheduler:Xt,clean:lr,playerHandler:null,flags:0},p=Bn(0,-1,null,1,0,null,null,null,null,null),g=Qn(null,p,v,f,null,null,s,u,l,a);Pt(g,null);try{var m=function(e,t,n,r,i,o){var a=n[1];n[19]=e;var s=Rn(a,null,0,3,null,null),l=s.mergedAttrs=t.hostAttrs;null!==l&&(zr(s,l),null!==e&&(Vt(i,e,l),null!==s.classes&&_r(i,e,s.classes),null!==s.styles&&wr(i,e,s.styles)));var u=r.createRenderer(e,t),c=Qn(n,$n(t),null,t.onPush?64:16,n[19],s,r,u,void 0);return a.firstCreatePass&&(rn(Jt(s,n),a,t.type),Xn(a,s),Zn(s,n.length,1)),ir(n,c),n[19]=c}(h,this.componentDef,g,s,u);if(h)if(n)Vt(u,h,["ng-version",li.full]);else{var y=function(e){for(var t=[],n=[],r=1,i=2;r<e.length;){var o=e[r];if("string"==typeof o)2===i?""!==o&&t.push(o,e[++r]):8===i&&n.push(o);else{if(!xn(i))break;i=o}r++}return{attrs:t,classes:n}}(this.componentDef.selectors[0]),k=y.attrs,b=y.classes;k&&Vt(u,h,k),b&&b.length>0&&_r(u,h,b.join(" "))}o=g[1].data[19],t&&(o.projection=t.map((function(e){return Array.from(e)}))),i=function(e,t,n,r,i){var o=n[1],a=function(e,t,n){var r=bt();e.firstCreatePass&&(n.providersResolver&&n.providersResolver(n),Un(e,r,1),Yn(e,t,n));var i=sn(t,e,t.length-1,r);yn(i,t);var o=ct(r,t);return o&&yn(o,t),i}(o,n,t);r.components.push(a),e[8]=a,i&&i.forEach((function(e){return e(a,t)})),t.contentQueries&&t.contentQueries(1,a,n.length-1);var s=bt();if(o.firstCreatePass&&(null!==t.hostBindings||null!==t.hostAttrs)){Qt(s.index-19);var l=n[1];jn(l,t),qn(l,n,t.hostVars),Wn(t,a)}return a}(m,this.componentDef,g,v,[Jr]),Hn(p,g,null)}finally{Mt()}var w=new Ti(this.componentType,i,xr(ri,o,g),g,o);return n&&!d||(w.hostView._tViewNode.child=o),w}},{key:"inputs",get:function(){return Si(this.componentDef.inputs)}},{key:"outputs",get:function(){return Si(this.componentDef.outputs)}}]),n}(ei),Ti=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,i,o,a){var s,l,u,c;return _classCallCheck(this,n),(s=t.call(this)).location=i,s._rootLView=o,s._tNode=a,s.destroyCbs=[],s.instance=r,s.hostView=s.changeDetectorRef=new Or(o),s.hostView._tViewNode=(l=o[1],u=o,null==(c=l.node)&&(l.node=c=Vn(0,null,2,-1,null,null)),u[6]=c),s.componentType=e,s}return _createClass(n,[{key:"destroy",value:function(){this.destroyCbs&&(this.destroyCbs.forEach((function(e){return e()})),this.destroyCbs=null,!this.hostView.destroyed&&this.hostView.destroy())}},{key:"onDestroy",value:function(e){this.destroyCbs&&this.destroyCbs.push(e)}},{key:"injector",get:function(){return new cn(this._tNode,this._rootLView)}}]),n}(function(){return function e(){_classCallCheck(this,e)}}()),Ii=void 0,Ei=["en",[["a","p"],["AM","PM"],Ii],[["AM","PM"],Ii,Ii],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Ii,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Ii,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Ii,"{1} 'at' {0}",Ii],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(e){var t=Math.floor(Math.abs(e)),n=e.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===n?1:5}],Di={};function Mi(e){return e in Di||(Di[e]=be.ng&&be.ng.common&&be.ng.common.locales&&be.ng.common.locales[e]),Di[e]}var Qi=function(){var e={LocaleId:0,DayPeriodsFormat:1,DayPeriodsStandalone:2,DaysFormat:3,DaysStandalone:4,MonthsFormat:5,MonthsStandalone:6,Eras:7,FirstDayOfWeek:8,WeekendRange:9,DateFormat:10,TimeFormat:11,DateTimeFormat:12,NumberSymbols:13,NumberFormats:14,CurrencyCode:15,CurrencySymbol:16,CurrencyName:17,Currencies:18,Directionality:19,PluralCase:20,ExtraData:21};return e[e.LocaleId]="LocaleId",e[e.DayPeriodsFormat]="DayPeriodsFormat",e[e.DayPeriodsStandalone]="DayPeriodsStandalone",e[e.DaysFormat]="DaysFormat",e[e.DaysStandalone]="DaysStandalone",e[e.MonthsFormat]="MonthsFormat",e[e.MonthsStandalone]="MonthsStandalone",e[e.Eras]="Eras",e[e.FirstDayOfWeek]="FirstDayOfWeek",e[e.WeekendRange]="WeekendRange",e[e.DateFormat]="DateFormat",e[e.TimeFormat]="TimeFormat",e[e.DateTimeFormat]="DateTimeFormat",e[e.NumberSymbols]="NumberSymbols",e[e.NumberFormats]="NumberFormats",e[e.CurrencyCode]="CurrencyCode",e[e.CurrencySymbol]="CurrencySymbol",e[e.CurrencyName]="CurrencyName",e[e.Currencies]="Currencies",e[e.Directionality]="Directionality",e[e.PluralCase]="PluralCase",e[e.ExtraData]="ExtraData",e}();function Ri(e){var t;null==(t=e)&&function(e,t,n,r){throw new Error("ASSERTION ERROR: ".concat("Expected localeId to be defined")+" [Expected=> null != ".concat(t," <=Actual]"))}(0,t),"string"==typeof e&&e.toLowerCase().replace(/_/g,"-")}var Hi=new Map,Ni=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var i;_classCallCheck(this,n),(i=t.call(this))._parent=r,i._bootstrapComponents=[],i.injector=_assertThisInitialized(i),i.destroyCbs=[],i.componentFactoryResolver=new xi(_assertThisInitialized(i));var o=tt(e),a=e[xe]||null;return a&&Ri(a),i._bootstrapComponents=Gt(o.bootstrap),i._r3Injector=Dr(e,r,[{provide:Be,useValue:_assertThisInitialized(i)},{provide:ni,useValue:i.componentFactoryResolver}],ce(e)),i._r3Injector._resolveInjectorDefTypes(),i.instance=i.get(e),i}return _createClass(n,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Fr.THROW_IF_NOT_FOUND,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:K.Default;return e===Fr||e===Be||e===Te?this:this._r3Injector.get(e,t,n)}},{key:"destroy",value:function(){var e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach((function(e){return e()})),this.destroyCbs=null}},{key:"onDestroy",value:function(e){this.destroyCbs.push(e)}}]),n}(Be),Li=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this)).moduleType=e,null!==tt(e)&&function e(t){if(null!==t.\u0275mod.id){var n=t.\u0275mod.id;(function(e,t,n){if(t&&t!==n)throw new Error("Duplicate module registered for ".concat(e," - ").concat(ce(t)," vs ").concat(ce(t.name)))})(n,Hi.get(n),t),Hi.set(n,t)}var r=t.\u0275mod.imports;r instanceof Function&&(r=r()),r&&r.forEach((function(t){return e(t)}))}(e),r}return _createClass(n,[{key:"create",value:function(e){return new Ni(this.moduleType,e)}}]),n}(function(){return function e(){_classCallCheck(this,e)}}()),Fi=function(e){_inherits(n,e);var t=_createSuper(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return _classCallCheck(this,n),(e=t.call(this)).__isAsync=r,e}return _createClass(n,[{key:"emit",value:function(e){_get(_getPrototypeOf(n.prototype),"next",this).call(this,e)}},{key:"subscribe",value:function(e,t,r){var i,o=function(e){return null},a=function(){return null};e&&"object"==typeof e?(i=this.__isAsync?function(t){setTimeout((function(){return e.next(t)}))}:function(t){e.next(t)},e.error&&(o=this.__isAsync?function(t){setTimeout((function(){return e.error(t)}))}:function(t){e.error(t)}),e.complete&&(a=this.__isAsync?function(){setTimeout((function(){return e.complete()}))}:function(){e.complete()})):(i=this.__isAsync?function(t){setTimeout((function(){return e(t)}))}:function(t){e(t)},t&&(o=this.__isAsync?function(e){setTimeout((function(){return t(e)}))}:function(e){t(e)}),r&&(a=this.__isAsync?function(){setTimeout((function(){return r()}))}:function(){r()}));var s=_get(_getPrototypeOf(n.prototype),"subscribe",this).call(this,i,o,a);return e instanceof d&&e.add(s),s}}]),n}(A),$i=new Pe("Application Initializer"),Bi=function(){var e=function(){function e(t){var n=this;_classCallCheck(this,e),this.appInits=t,this.initialized=!1,this.done=!1,this.donePromise=new Promise((function(e,t){n.resolve=e,n.reject=t}))}return _createClass(e,[{key:"runInitializers",value:function(){var e=this;if(!this.initialized){var t=[],n=function(){e.done=!0,e.resolve()};if(this.appInits)for(var r=0;r<this.appInits.length;r++){var i=this.appInits[r]();Kr(i)&&t.push(i)}Promise.all(t).then((function(){n()})).catch((function(t){e.reject(t)})),0===t.length&&n(),this.initialized=!0}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ne($i,8))},e.\u0275prov=ee({token:e,factory:e.\u0275fac}),e}(),Vi=new Pe("AppId"),zi={provide:Vi,useFactory:function(){return"".concat(ji()).concat(ji()).concat(ji())},deps:[]};function ji(){return String.fromCharCode(97+Math.floor(25*Math.random()))}var qi=new Pe("Platform Initializer"),Wi=new Pe("Platform ID"),Ui=new Pe("appBootstrapListener"),Xi=function(){var e=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"log",value:function(e){console.log(e)}},{key:"warn",value:function(e){console.warn(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=ee({token:e,factory:e.\u0275fac}),e}(),Gi=new Pe("LocaleId"),Zi=new Pe("DefaultCurrencyCode"),Yi=function e(t,n){_classCallCheck(this,e),this.ngModuleFactory=t,this.componentFactories=n},Ki=function(e){return new Li(e)},Ji=Ki,eo=function(e){return Promise.resolve(Ki(e))},to=function(e){var t=Ki(e),n=Gt(tt(e).declarations).reduce((function(e,t){var n=Je(t);return n&&e.push(new Pi(n)),e}),[]);return new Yi(t,n)},no=to,ro=function(e){return Promise.resolve(to(e))},io=function(){var e=function(){function e(){_classCallCheck(this,e),this.compileModuleSync=Ji,this.compileModuleAsync=eo,this.compileModuleAndAllComponentsSync=no,this.compileModuleAndAllComponentsAsync=ro}return _createClass(e,[{key:"clearCache",value:function(){}},{key:"clearCacheFor",value:function(e){}},{key:"getModuleId",value:function(e){}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=ee({token:e,factory:e.\u0275fac}),e}(),oo=new Pe("compilerOptions"),ao=Promise.resolve(0);function so(e){"undefined"==typeof Zone?ao.then((function(){e&&e.apply(null,null)})):Zone.current.scheduleMicroTask("scheduleMicrotask",e)}var lo=function(){function e(t){var n,r,i=t.enableLongStackTrace,o=void 0!==i&&i,a=t.shouldCoalesceEventChangeDetection,s=void 0!==a&&a;if(_classCallCheck(this,e),this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Fi(!1),this.onMicrotaskEmpty=new Fi(!1),this.onStable=new Fi(!1),this.onError=new Fi(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched(),this._nesting=0,this._outer=this._inner=Zone.current,Zone.wtfZoneSpec&&(this._inner=this._inner.fork(Zone.wtfZoneSpec)),Zone.TaskTrackingZoneSpec&&(this._inner=this._inner.fork(new Zone.TaskTrackingZoneSpec)),o&&Zone.longStackTraceZoneSpec&&(this._inner=this._inner.fork(Zone.longStackTraceZoneSpec)),this.shouldCoalesceEventChangeDetection=s,this.lastRequestAnimationFrameId=-1,this.nativeRequestAnimationFrame=function(){var e=be.requestAnimationFrame,t=be.cancelAnimationFrame;if("undefined"!=typeof Zone&&e&&t){var n=e[Zone.__symbol__("OriginalDelegate")];n&&(e=n);var r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,r=!!(n=this).shouldCoalesceEventChangeDetection&&n.nativeRequestAnimationFrame&&function(){!function(e){-1===e.lastRequestAnimationFrameId&&(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call(be,(function(){e.lastRequestAnimationFrameId=-1,fo(e),ho(e)})),fo(e))}(n)},n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0,maybeDelayChangeDetection:r},onInvokeTask:function(e,t,i,o,a,s){try{return vo(n),e.invokeTask(i,o,a,s)}finally{r&&"eventTask"===o.type&&r(),po(n)}},onInvoke:function(e,t,r,i,o,a,s){try{return vo(n),e.invoke(r,i,o,a,s)}finally{po(n)}},onHasTask:function(e,t,r,i){e.hasTask(r,i),t===r&&("microTask"==i.change?(n._hasPendingMicrotasks=i.microTask,fo(n),ho(n)):"macroTask"==i.change&&(n.hasPendingMacrotasks=i.macroTask))},onHandleError:function(e,t,r,i){return e.handleError(r,i),n.runOutsideAngular((function(){return n.onError.emit(i)})),!1}})}return _createClass(e,[{key:"run",value:function(e,t,n){return this._inner.run(e,t,n)}},{key:"runTask",value:function(e,t,n,r){var i=this._inner,o=i.scheduleEventTask("NgZoneEvent: "+r,e,co,uo,uo);try{return i.runTask(o,t,n)}finally{i.cancelTask(o)}}},{key:"runGuarded",value:function(e,t,n){return this._inner.runGuarded(e,t,n)}},{key:"runOutsideAngular",value:function(e){return this._outer.run(e)}}],[{key:"isInAngularZone",value:function(){return!0===Zone.current.get("isAngularZone")}},{key:"assertInAngularZone",value:function(){if(!e.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}},{key:"assertNotInAngularZone",value:function(){if(e.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}}]),e}();function uo(){}var co={};function ho(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular((function(){return e.onStable.emit(null)}))}finally{e.isStable=!0}}}function fo(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||e.shouldCoalesceEventChangeDetection&&-1!==e.lastRequestAnimationFrameId)}function vo(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function po(e){e._nesting--,ho(e)}var go,mo=function(){function e(){_classCallCheck(this,e),this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Fi,this.onMicrotaskEmpty=new Fi,this.onStable=new Fi,this.onError=new Fi}return _createClass(e,[{key:"run",value:function(e,t,n){return e.apply(t,n)}},{key:"runGuarded",value:function(e,t,n){return e.apply(t,n)}},{key:"runOutsideAngular",value:function(e){return e()}},{key:"runTask",value:function(e,t,n,r){return e.apply(t,n)}}]),e}(),yo=function(){var e=function(){function e(t){var n=this;_classCallCheck(this,e),this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run((function(){n.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")}))}return _createClass(e,[{key:"_watchAngularEvents",value:function(){var e=this;this._ngZone.onUnstable.subscribe({next:function(){e._didWork=!0,e._isZoneStable=!1}}),this._ngZone.runOutsideAngular((function(){e._ngZone.onStable.subscribe({next:function(){lo.assertNotInAngularZone(),so((function(){e._isZoneStable=!0,e._runCallbacksIfReady()}))}})}))}},{key:"increasePendingRequestCount",value:function(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}},{key:"decreasePendingRequestCount",value:function(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}},{key:"isStable",value:function(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}},{key:"_runCallbacksIfReady",value:function(){var e=this;if(this.isStable())so((function(){for(;0!==e._callbacks.length;){var t=e._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(e._didWork)}e._didWork=!1}));else{var t=this.getPendingTasks();this._callbacks=this._callbacks.filter((function(e){return!e.updateCb||!e.updateCb(t)||(clearTimeout(e.timeoutId),!1)})),this._didWork=!0}}},{key:"getPendingTasks",value:function(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map((function(e){return{source:e.source,creationLocation:e.creationLocation,data:e.data}})):[]}},{key:"addCallback",value:function(e,t,n){var r=this,i=-1;t&&t>0&&(i=setTimeout((function(){r._callbacks=r._callbacks.filter((function(e){return e.timeoutId!==i})),e(r._didWork,r.getPendingTasks())}),t)),this._callbacks.push({doneCb:e,timeoutId:i,updateCb:n})}},{key:"whenStable",value:function(e,t,n){if(n&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/dist/task-tracking.js" loaded?');this.addCallback(e,t,n),this._runCallbacksIfReady()}},{key:"getPendingRequestCount",value:function(){return this._pendingCount}},{key:"findProviders",value:function(e,t,n){return[]}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ne(lo))},e.\u0275prov=ee({token:e,factory:e.\u0275fac}),e}(),ko=function(){var e=function(){function e(){_classCallCheck(this,e),this._applications=new Map,bo.addToWindow(this)}return _createClass(e,[{key:"registerApplication",value:function(e,t){this._applications.set(e,t)}},{key:"unregisterApplication",value:function(e){this._applications.delete(e)}},{key:"unregisterAllApplications",value:function(){this._applications.clear()}},{key:"getTestability",value:function(e){return this._applications.get(e)||null}},{key:"getAllTestabilities",value:function(){return Array.from(this._applications.values())}},{key:"getAllRootElements",value:function(){return Array.from(this._applications.keys())}},{key:"findTestabilityInTree",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return bo.findTestabilityInTree(this,e,t)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=ee({token:e,factory:e.\u0275fac}),e}(),bo=new(function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"addToWindow",value:function(e){}},{key:"findTestabilityInTree",value:function(e,t,n){return null}}]),e}()),wo=function(e,t,n){var r=e.get(oo,[]).concat(t),i=new Li(n);if(0===$r.size)return Promise.resolve(i);var o,a,s=(o=r.map((function(e){return e.providers})),a=[],o.forEach((function(e){return e&&a.push.apply(a,_toConsumableArray(e))})),a);if(0===s.length)return Promise.resolve(i);var l=function(){var e=be.ng;if(!e||!e.\u0275compilerFacade)throw new Error("Angular JIT compilation failed: '@angular/compiler' not loaded!\n  - JIT compilation is discouraged for production use-cases! Consider AOT mode instead.\n  - Did you bootstrap using '@angular/platform-browser-dynamic' or '@angular/platform-server'?\n  - Alternatively provide the compiler with 'import \"@angular/compiler\";' before bootstrapping.");return e.\u0275compilerFacade}(),u=Fr.create({providers:s}).get(l.ResourceLoader);return function(e){var t=[],n=new Map;function r(e){var t=n.get(e);if(!t){var r=function(e){return Promise.resolve(u.get(e))}(e);n.set(e,t=r.then(Vr))}return t}return $r.forEach((function(e,n){var i=[];e.templateUrl&&i.push(r(e.templateUrl).then((function(t){e.template=t})));var o=e.styleUrls,a=e.styles||(e.styles=[]),s=e.styles.length;o&&o.forEach((function(t,n){a.push(""),i.push(r(t).then((function(r){a[s+n]=r,o.splice(o.indexOf(t),1),0==o.length&&(e.styleUrls=void 0)})))}));var l=Promise.all(i).then((function(){return function(e){Br.delete(e)}(n)}));t.push(l)})),$r=new Map,Promise.all(t).then((function(){}))}().then((function(){return i}))},_o=new Pe("AllowMultipleToken");function Co(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r="Platform: ".concat(t),i=new Pe(r);return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],o=Oo();if(!o||o.injector.get(_o,!1))if(e)e(n.concat(t).concat({provide:i,useValue:!0}));else{var a=n.concat(t).concat({provide:i,useValue:!0},{provide:Sr,useValue:"platform"});!function(e){if(go&&!go.destroyed&&!go.injector.get(_o,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");go=e.get(xo);var t=e.get(qi,null);t&&t.forEach((function(e){return e()}))}(Fr.create({providers:a,name:r}))}return function(e){var t=Oo();if(!t)throw new Error("No platform exists!");if(!t.injector.get(e,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return t}(i)}}function Oo(){return go&&!go.destroyed?go:null}var xo=function(){var e=function(){function e(t){_classCallCheck(this,e),this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}return _createClass(e,[{key:"bootstrapModuleFactory",value:function(e,t){var n,r,i=this,o=(n=t?t.ngZone:void 0,r=t&&t.ngZoneEventCoalescing||!1,"noop"===n?new mo:("zone.js"===n?void 0:n)||new lo({enableLongStackTrace:mn(),shouldCoalesceEventChangeDetection:r})),a=[{provide:lo,useValue:o}];return o.run((function(){var t=Fr.create({providers:a,parent:i.injector,name:e.moduleType.name}),n=e.create(t),r=n.injector.get(vn,null);if(!r)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return n.onDestroy((function(){return To(i._modules,n)})),o.runOutsideAngular((function(){return o.onError.subscribe({next:function(e){r.handleError(e)}})})),function(e,t,r){try{var o=((a=n.injector.get(Bi)).runInitializers(),a.donePromise.then((function(){return Ri(n.injector.get(Gi,"en-US")||"en-US"),i._moduleDoBootstrap(n),n})));return Kr(o)?o.catch((function(n){throw t.runOutsideAngular((function(){return e.handleError(n)})),n})):o}catch(s){throw t.runOutsideAngular((function(){return e.handleError(s)})),s}var a}(r,o)}))}},{key:"bootstrapModule",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=So({},n);return wo(this.injector,r,e).then((function(e){return t.bootstrapModuleFactory(e,r)}))}},{key:"_moduleDoBootstrap",value:function(e){var t=e.injector.get(Po);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach((function(e){return t.bootstrap(e)}));else{if(!e.instance.ngDoBootstrap)throw new Error("The module ".concat(ce(e.instance.constructor),' was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. ')+"Please define one of these.");e.instance.ngDoBootstrap(t)}this._modules.push(e)}},{key:"onDestroy",value:function(e){this._destroyListeners.push(e)}},{key:"destroy",value:function(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach((function(e){return e.destroy()})),this._destroyListeners.forEach((function(e){return e()})),this._destroyed=!0}},{key:"injector",get:function(){return this._injector}},{key:"destroyed",get:function(){return this._destroyed}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Ne(Fr))},e.\u0275prov=ee({token:e,factory:e.\u0275fac}),e}();function So(e,t){return Array.isArray(t)?t.reduce(So,e):Object.assign(Object.assign({},e),t)}var Ao,Po=((Ao=function(){function e(t,n,r,i,o,a){var s=this;_classCallCheck(this,e),this._zone=t,this._console=n,this._injector=r,this._exceptionHandler=i,this._componentFactoryResolver=o,this._initStatus=a,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._enforceNoNewChanges=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._enforceNoNewChanges=mn(),this._zone.onMicrotaskEmpty.subscribe({next:function(){s._zone.run((function(){s.tick()}))}});var l=new w((function(e){s._stable=s._zone.isStable&&!s._zone.hasPendingMacrotasks&&!s._zone.hasPendingMicrotasks,s._zone.runOutsideAngular((function(){e.next(s._stable),e.complete()}))})),u=new w((function(e){var t;s._zone.runOutsideAngular((function(){t=s._zone.onStable.subscribe((function(){lo.assertNotInAngularZone(),so((function(){s._stable||s._zone.hasPendingMacrotasks||s._zone.hasPendingMicrotasks||(s._stable=!0,e.next(!0))}))}))}));var n=s._zone.onUnstable.subscribe((function(){lo.assertInAngularZone(),s._stable&&(s._stable=!1,s._zone.runOutsideAngular((function(){e.next(!1)})))}));return function(){t.unsubscribe(),n.unsubscribe()}}));this.isStable=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r,i=Number.POSITIVE_INFINITY,o=null,a=t[t.length-1];return(r=a)&&"function"==typeof r.schedule?(o=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(i=t.pop())):"number"==typeof a&&(i=t.pop()),null===o&&1===t.length&&t[0]instanceof w?t[0]:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY;return function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.POSITIVE_INFINITY;return"function"==typeof n?function(i){return i.pipe(e((function(e,r){return(i=t(e,r),i instanceof w?i:new w(D(i))).pipe(function(e,t){return function(t){return t.lift(new Q(e,void 0))}}((function(t,i){return n(e,t,r,i)})));var i}),r))}:("number"==typeof n&&(r=n),function(e){return e.lift(new H(t,r))})}(L,e)}(i)(function(e,t){return t?function(e,t){return new w((function(n){var r=new d,i=0;return r.add(t.schedule((function(){i!==e.length?(n.next(e[i++]),n.closed||r.add(this.schedule())):n.complete()}))),r}))}(e,t):new w(I(e))}(t,o))}(l,u.pipe((function(e){return F()((t=q,function(e){var n;n="function"==typeof t?t:function(){return t};var r=Object.create(e,z);return r.source=e,r.subjectFactory=n,r})(e));var t})))}return _createClass(e,[{key:"bootstrap",value:function(e,t){var n,r=this;if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");n=e instanceof ei?e:this._componentFactoryResolver.resolveComponentFactory(e),this.componentTypes.push(n.componentType);var i=n.isBoundToModule?void 0:this._injector.get(Be),o=n.create(Fr.NULL,[],t||n.selector,i);o.onDestroy((function(){r._unloadComponent(o)}));var a=o.injector.get(yo,null);return a&&o.injector.get(ko).registerApplication(o.location.nativeElement,a),this._loadComponent(o),mn()&&this._console.log("Angular is running in the development mode. Call enableProdMode() to enable the production mode."),o}},{key:"tick",value:function(){var e=this;if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;var t,n=_createForOfIteratorHelper(this._views);try{for(n.s();!(t=n.n()).done;)t.value.detectChanges()}catch(o){n.e(o)}finally{n.f()}if(this._enforceNoNewChanges){var r,i=_createForOfIteratorHelper(this._views);try{for(i.s();!(r=i.n()).done;)r.value.checkNoChanges()}catch(o){i.e(o)}finally{i.f()}}}catch(a){this._zone.runOutsideAngular((function(){return e._exceptionHandler.handleError(a)}))}finally{this._runningTick=!1}}},{key:"attachView",value:function(e){var t=e;this._views.push(t),t.attachToAppRef(this)}},{key:"detachView",value:function(e){var t=e;To(this._views,t),t.detachFromAppRef()}},{key:"_loadComponent",value:function(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(Ui,[]).concat(this._bootstrapListeners).forEach((function(t){return t(e)}))}},{key:"_unloadComponent",value:function(e){this.detachView(e.hostView),To(this.components,e)}},{key:"ngOnDestroy",value:function(){this._views.slice().forEach((function(e){return e.destroy()}))}},{key:"viewCount",get:function(){return this._views.length}}]),e}()).\u0275fac=function(e){return new(e||Ao)(Ne(lo),Ne(Xi),Ne(Fr),Ne(vn),Ne(ni),Ne(Bi))},Ao.\u0275prov=ee({token:Ao,factory:Ao.\u0275fac}),Ao);function To(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)}var Io=Co(null,"core",[{provide:Wi,useValue:"unknown"},{provide:xo,deps:[Fr]},{provide:ko,deps:[]},{provide:Xi,deps:[]}]),Eo=[{provide:Po,useClass:Po,deps:[lo,Xi,Fr,vn,ni,Bi]},{provide:Ai,deps:[lo],useFactory:function(e){var t=[];return e.onStable.subscribe((function(){for(;t.length;)t.pop()()})),function(e){t.push(e)}}},{provide:Bi,useClass:Bi,deps:[[new G,$i]]},{provide:io,useClass:io,deps:[]},zi,{provide:ki,useFactory:function(){return _i},deps:[]},{provide:bi,useFactory:function(){return Ci},deps:[]},{provide:Gi,useFactory:function(e){return Ri(e=e||"undefined"!=typeof $localize&&$localize.locale||"en-US"),e},deps:[[new X(Gi),new G,new Y]]},{provide:Zi,useValue:"USD"}],Do=function(){var e=function e(t){_classCallCheck(this,e)};return e.\u0275mod=Ye({type:e}),e.\u0275inj=te({factory:function(t){return new(t||e)(Ne(Po))},providers:Eo}),e}(),Mo=null;function Qo(){return Mo}var Ro,Ho,No,Lo,Fo,$o,Bo=new Pe("DocumentToken"),Vo=function(){var e={Zero:0,One:1,Two:2,Few:3,Many:4,Other:5};return e[e.Zero]="Zero",e[e.One]="One",e[e.Two]="Two",e[e.Few]="Few",e[e.Many]="Many",e[e.Other]="Other",e}(),zo=function e(){_classCallCheck(this,e)},jo=((Ho=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this)).locale=e,r}return _createClass(n,[{key:"getPluralCategory",value:function(e,t){switch(function(e){return function(e){var t=function(e){return e.toLowerCase().replace(/_/g,"-")}(e),n=Mi(t);if(n)return n;var r=t.split("-")[0];if(n=Mi(r))return n;if("en"===r)return Ei;throw new Error('Missing locale data for the locale "'.concat(e,'".'))}(e)[Qi.PluralCase]}(t||this.locale)(e)){case Vo.Zero:return"zero";case Vo.One:return"one";case Vo.Two:return"two";case Vo.Few:return"few";case Vo.Many:return"many";default:return"other"}}}]),n}(zo)).\u0275fac=function(e){return new(e||Ho)(Ne(Gi))},Ho.\u0275prov=ee({token:Ho,factory:Ho.\u0275fac}),Ho),qo=((Ro=function e(){_classCallCheck(this,e)}).\u0275mod=Ye({type:Ro}),Ro.\u0275inj=te({factory:function(e){return new(e||Ro)},providers:[{provide:zo,useClass:jo}]}),Ro),Wo=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"getProperty",value:function(e,t){return e[t]}},{key:"log",value:function(e){window.console&&window.console.log&&window.console.log(e)}},{key:"logGroup",value:function(e){window.console&&window.console.group&&window.console.group(e)}},{key:"logGroupEnd",value:function(){window.console&&window.console.groupEnd&&window.console.groupEnd()}},{key:"onAndCancel",value:function(e,t,n){return e.addEventListener(t,n,!1),function(){e.removeEventListener(t,n,!1)}}},{key:"dispatchEvent",value:function(e,t){e.dispatchEvent(t)}},{key:"remove",value:function(e){return e.parentNode&&e.parentNode.removeChild(e),e}},{key:"getValue",value:function(e){return e.value}},{key:"createElement",value:function(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}},{key:"createHtmlDocument",value:function(){return document.implementation.createHTMLDocument("fakeTitle")}},{key:"getDefaultDocument",value:function(){return document}},{key:"isElementNode",value:function(e){return e.nodeType===Node.ELEMENT_NODE}},{key:"isShadowRoot",value:function(e){return e instanceof DocumentFragment}},{key:"getGlobalEventTarget",value:function(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}},{key:"getHistory",value:function(){return window.history}},{key:"getLocation",value:function(){return window.location}},{key:"getBaseHref",value:function(e){var t,n=Uo||(Uo=document.querySelector("base"))?Uo.getAttribute("href"):null;return null==n?null:(t=n,No||(No=document.createElement("a")),No.setAttribute("href",t),"/"===No.pathname.charAt(0)?No.pathname:"/"+No.pathname)}},{key:"resetBaseElement",value:function(){Uo=null}},{key:"getUserAgent",value:function(){return window.navigator.userAgent}},{key:"performanceNow",value:function(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()}},{key:"supportsCookies",value:function(){return!0}},{key:"getCookie",value:function(e){return function(e,t){t=encodeURIComponent(t);var n,r=_createForOfIteratorHelper(e.split(";"));try{for(r.s();!(n=r.n()).done;){var i=n.value,o=i.indexOf("="),a=_slicedToArray(-1==o?[i,""]:[i.slice(0,o),i.slice(o+1)],2),s=a[0],l=a[1];if(s.trim()===t)return decodeURIComponent(l)}}catch(u){r.e(u)}finally{r.f()}return null}(document.cookie,e)}}],[{key:"makeCurrent",value:function(){var e;e=new n,Mo||(Mo=e)}}]),n}(function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.call(this)}return _createClass(n,[{key:"supportsDOMEvents",value:function(){return!0}}]),n}(function(){return function e(){_classCallCheck(this,e)}}())),Uo=null,Xo=new Pe("TRANSITION_ID"),Go=[{provide:$i,useFactory:function(e,t,n){return function(){n.get(Bi).donePromise.then((function(){var n=Qo();Array.prototype.slice.apply(t.querySelectorAll("style[ng-transition]")).filter((function(t){return t.getAttribute("ng-transition")===e})).forEach((function(e){return n.remove(e)}))}))}},deps:[Xo,Bo,Fr],multi:!0}],Zo=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"addToWindow",value:function(e){be.getAngularTestability=function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.findTestabilityInTree(t,n);if(null==r)throw new Error("Could not find testability for element.");return r},be.getAllAngularTestabilities=function(){return e.getAllTestabilities()},be.getAllAngularRootElements=function(){return e.getAllRootElements()},be.frameworkStabilizers||(be.frameworkStabilizers=[]),be.frameworkStabilizers.push((function(e){var t=be.getAllAngularTestabilities(),n=t.length,r=!1,i=function(t){r=r||t,0==--n&&e(r)};t.forEach((function(e){e.whenStable(i)}))}))}},{key:"findTestabilityInTree",value:function(e,t,n){if(null==t)return null;var r=e.getTestability(t);return null!=r?r:n?Qo().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}],[{key:"init",value:function(){var t;t=new e,bo=t}}]),e}(),Yo=new Pe("EventManagerPlugins"),Ko=((Lo=function(){function e(t,n){var r=this;_classCallCheck(this,e),this._zone=n,this._eventNameToPlugin=new Map,t.forEach((function(e){return e.manager=r})),this._plugins=t.slice().reverse()}return _createClass(e,[{key:"addEventListener",value:function(e,t,n){return this._findPluginFor(t).addEventListener(e,t,n)}},{key:"addGlobalEventListener",value:function(e,t,n){return this._findPluginFor(t).addGlobalEventListener(e,t,n)}},{key:"getZone",value:function(){return this._zone}},{key:"_findPluginFor",value:function(e){var t=this._eventNameToPlugin.get(e);if(t)return t;for(var n=this._plugins,r=0;r<n.length;r++){var i=n[r];if(i.supports(e))return this._eventNameToPlugin.set(e,i),i}throw new Error("No event manager plugin found for event ".concat(e))}}]),e}()).\u0275fac=function(e){return new(e||Lo)(Ne(Yo),Ne(lo))},Lo.\u0275prov=ee({token:Lo,factory:Lo.\u0275fac}),Lo),Jo=function(){function e(t){_classCallCheck(this,e),this._doc=t}return _createClass(e,[{key:"addGlobalEventListener",value:function(e,t,n){var r=Qo().getGlobalEventTarget(this._doc,e);if(!r)throw new Error("Unsupported event target ".concat(r," for event ").concat(t));return this.addEventListener(r,t,n)}}]),e}(),ea=(($o=function(){function e(){_classCallCheck(this,e),this._stylesSet=new Set}return _createClass(e,[{key:"addStyles",value:function(e){var t=this,n=new Set;e.forEach((function(e){t._stylesSet.has(e)||(t._stylesSet.add(e),n.add(e))})),this.onStylesAdded(n)}},{key:"onStylesAdded",value:function(e){}},{key:"getAllStyles",value:function(){return Array.from(this._stylesSet)}}]),e}()).\u0275fac=function(e){return new(e||$o)},$o.\u0275prov=ee({token:$o,factory:$o.\u0275fac}),$o),ta=((Fo=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this))._doc=e,r._hostNodes=new Set,r._styleNodes=new Set,r._hostNodes.add(e.head),r}return _createClass(n,[{key:"_addStylesToHost",value:function(e,t){var n=this;e.forEach((function(e){var r=n._doc.createElement("style");r.textContent=e,n._styleNodes.add(t.appendChild(r))}))}},{key:"addHost",value:function(e){this._addStylesToHost(this._stylesSet,e),this._hostNodes.add(e)}},{key:"removeHost",value:function(e){this._hostNodes.delete(e)}},{key:"onStylesAdded",value:function(e){var t=this;this._hostNodes.forEach((function(n){return t._addStylesToHost(e,n)}))}},{key:"ngOnDestroy",value:function(){this._styleNodes.forEach((function(e){return Qo().remove(e)}))}}]),n}(ea)).\u0275fac=function(e){return new(e||Fo)(Ne(Bo))},Fo.\u0275prov=ee({token:Fo,factory:Fo.\u0275fac}),Fo),na={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},ra=/%COMP%/g;function ia(e,t,n){for(var r=0;r<t.length;r++){var i=t[r];Array.isArray(i)?ia(e,i,n):(i=i.replace(ra,e),n.push(i))}return n}function oa(e){return function(t){if("__ngUnwrap__"===t)return e;!1===e(t)&&(t.preventDefault(),t.returnValue=!1)}}var aa,sa,la,ua,ca=((aa=function(){function e(t,n,r){_classCallCheck(this,e),this.eventManager=t,this.sharedStylesHost=n,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new ha(t)}return _createClass(e,[{key:"createRenderer",value:function(e,t){if(!e||!t)return this.defaultRenderer;switch(t.encapsulation){case je.Emulated:var n=this.rendererByCompId.get(t.id);return n||(n=new fa(this.eventManager,this.sharedStylesHost,t,this.appId),this.rendererByCompId.set(t.id,n)),n.applyToHost(e),n;case je.Native:case je.ShadowDom:return new da(this.eventManager,this.sharedStylesHost,e,t);default:if(!this.rendererByCompId.has(t.id)){var r=ia(t.id,t.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(t.id,this.defaultRenderer)}return this.defaultRenderer}}},{key:"begin",value:function(){}},{key:"end",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||aa)(Ne(Ko),Ne(ta),Ne(Vi))},aa.\u0275prov=ee({token:aa,factory:aa.\u0275fac}),aa),ha=function(){function e(t){_classCallCheck(this,e),this.eventManager=t,this.data=Object.create(null)}return _createClass(e,[{key:"destroy",value:function(){}},{key:"createElement",value:function(e,t){return t?document.createElementNS(na[t]||t,e):document.createElement(e)}},{key:"createComment",value:function(e){return document.createComment(e)}},{key:"createText",value:function(e){return document.createTextNode(e)}},{key:"appendChild",value:function(e,t){e.appendChild(t)}},{key:"insertBefore",value:function(e,t,n){e&&e.insertBefore(t,n)}},{key:"removeChild",value:function(e,t){e&&e.removeChild(t)}},{key:"selectRootElement",value:function(e,t){var n="string"==typeof e?document.querySelector(e):e;if(!n)throw new Error('The selector "'.concat(e,'" did not match any elements'));return t||(n.textContent=""),n}},{key:"parentNode",value:function(e){return e.parentNode}},{key:"nextSibling",value:function(e){return e.nextSibling}},{key:"setAttribute",value:function(e,t,n,r){if(r){t=r+":"+t;var i=na[r];i?e.setAttributeNS(i,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}},{key:"removeAttribute",value:function(e,t,n){if(n){var r=na[n];r?e.removeAttributeNS(r,t):e.removeAttribute("".concat(n,":").concat(t))}else e.removeAttribute(t)}},{key:"addClass",value:function(e,t){e.classList.add(t)}},{key:"removeClass",value:function(e,t){e.classList.remove(t)}},{key:"setStyle",value:function(e,t,n,r){r&ai.DashCase?e.style.setProperty(t,n,r&ai.Important?"important":""):e.style[t]=n}},{key:"removeStyle",value:function(e,t,n){n&ai.DashCase?e.style.removeProperty(t):e.style[t]=""}},{key:"setProperty",value:function(e,t,n){e[t]=n}},{key:"setValue",value:function(e,t){e.nodeValue=t}},{key:"listen",value:function(e,t,n){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,oa(n)):this.eventManager.addEventListener(e,t,oa(n))}}]),e}(),fa=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,i,o){var a;_classCallCheck(this,n),(a=t.call(this,e)).component=i;var s,l=ia(o+"-"+i.id,i.styles,[]);return r.addStyles(l),a.contentAttr="_ngcontent-%COMP%".replace(ra,o+"-"+i.id),a.hostAttr=(s=o+"-"+i.id,"_nghost-%COMP%".replace(ra,s)),a}return _createClass(n,[{key:"applyToHost",value:function(e){_get(_getPrototypeOf(n.prototype),"setAttribute",this).call(this,e,this.hostAttr,"")}},{key:"createElement",value:function(e,t){var r=_get(_getPrototypeOf(n.prototype),"createElement",this).call(this,e,t);return _get(_getPrototypeOf(n.prototype),"setAttribute",this).call(this,r,this.contentAttr,""),r}}]),n}(ha),da=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,i,o){var a;_classCallCheck(this,n),(a=t.call(this,e)).sharedStylesHost=r,a.hostEl=i,a.component=o,a.shadowRoot=o.encapsulation===je.ShadowDom?i.attachShadow({mode:"open"}):i.createShadowRoot(),a.sharedStylesHost.addHost(a.shadowRoot);for(var s=ia(o.id,o.styles,[]),l=0;l<s.length;l++){var u=document.createElement("style");u.textContent=s[l],a.shadowRoot.appendChild(u)}return a}return _createClass(n,[{key:"nodeOrShadowRoot",value:function(e){return e===this.hostEl?this.shadowRoot:e}},{key:"destroy",value:function(){this.sharedStylesHost.removeHost(this.shadowRoot)}},{key:"appendChild",value:function(e,t){return _get(_getPrototypeOf(n.prototype),"appendChild",this).call(this,this.nodeOrShadowRoot(e),t)}},{key:"insertBefore",value:function(e,t,r){return _get(_getPrototypeOf(n.prototype),"insertBefore",this).call(this,this.nodeOrShadowRoot(e),t,r)}},{key:"removeChild",value:function(e,t){return _get(_getPrototypeOf(n.prototype),"removeChild",this).call(this,this.nodeOrShadowRoot(e),t)}},{key:"parentNode",value:function(e){return this.nodeOrShadowRoot(_get(_getPrototypeOf(n.prototype),"parentNode",this).call(this,this.nodeOrShadowRoot(e)))}}]),n}(ha),va=((sa=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,e)}return _createClass(n,[{key:"supports",value:function(e){return!0}},{key:"addEventListener",value:function(e,t,n){var r=this;return e.addEventListener(t,n,!1),function(){return r.removeEventListener(e,t,n)}}},{key:"removeEventListener",value:function(e,t,n){return e.removeEventListener(t,n)}}]),n}(Jo)).\u0275fac=function(e){return new(e||sa)(Ne(Bo))},sa.\u0275prov=ee({token:sa,factory:sa.\u0275fac}),sa),pa=["alt","control","meta","shift"],ga={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},ma={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},ya={alt:function(e){return e.altKey},control:function(e){return e.ctrlKey},meta:function(e){return e.metaKey},shift:function(e){return e.shiftKey}},ka=((la=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,e)}return _createClass(n,[{key:"supports",value:function(e){return null!=n.parseEventName(e)}},{key:"addEventListener",value:function(e,t,r){var i=n.parseEventName(t),o=n.eventCallback(i.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular((function(){return Qo().onAndCancel(e,i.domEventName,o)}))}}],[{key:"parseEventName",value:function(e){var t=e.toLowerCase().split("."),r=t.shift();if(0===t.length||"keydown"!==r&&"keyup"!==r)return null;var i=n._normalizeKey(t.pop()),o="";if(pa.forEach((function(e){var n=t.indexOf(e);n>-1&&(t.splice(n,1),o+=e+".")})),o+=i,0!=t.length||0===i.length)return null;var a={};return a.domEventName=r,a.fullKey=o,a}},{key:"getEventFullKey",value:function(e){var t="",n=function(e){var t=e.key;if(null==t){if(null==(t=e.keyIdentifier))return"Unidentified";t.startsWith("U+")&&(t=String.fromCharCode(parseInt(t.substring(2),16)),3===e.location&&ma.hasOwnProperty(t)&&(t=ma[t]))}return ga[t]||t}(e);return" "===(n=n.toLowerCase())?n="space":"."===n&&(n="dot"),pa.forEach((function(r){r!=n&&(0,ya[r])(e)&&(t+=r+".")})),t+=n}},{key:"eventCallback",value:function(e,t,r){return function(i){n.getEventFullKey(i)===e&&r.runGuarded((function(){return t(i)}))}}},{key:"_normalizeKey",value:function(e){switch(e){case"esc":return"escape";default:return e}}}]),n}(Jo)).\u0275fac=function(e){return new(e||la)(Ne(Bo))},la.\u0275prov=ee({token:la,factory:la.\u0275fac}),la),ba=Co(Io,"browser",[{provide:Wi,useValue:"browser"},{provide:qi,useValue:function(){Wo.makeCurrent(),Zo.init()},multi:!0},{provide:Bo,useFactory:function(){return function(e){at=e}(document),document},deps:[]}]),wa=[[],{provide:Sr,useValue:"root"},{provide:vn,useFactory:function(){return new vn},deps:[]},{provide:Yo,useClass:va,multi:!0,deps:[Bo,lo,Wi]},{provide:Yo,useClass:ka,multi:!0,deps:[Bo]},[],{provide:ca,useClass:ca,deps:[Ko,ta,Vi]},{provide:oi,useExisting:ca},{provide:ea,useExisting:ta},{provide:ta,useClass:ta,deps:[Bo]},{provide:yo,useClass:yo,deps:[lo]},{provide:Ko,useClass:Ko,deps:[Yo,lo]},[]],_a=((ua=function(){function e(t){if(_classCallCheck(this,e),t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}return _createClass(e,null,[{key:"withServerTransition",value:function(t){return{ngModule:e,providers:[{provide:Vi,useValue:t.appId},{provide:Xo,useExisting:Vi},Go]}}}]),e}()).\u0275mod=Ye({type:ua}),ua.\u0275inj=te({factory:function(e){return new(e||ua)(Ne(ua,12))},providers:wa,imports:[qo,Do]}),ua);"undefined"!=typeof window&&window;for(var Ca="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map((function(e){return e?parseInt(e,36):1})),Oa=1;Oa<Ca.length;Oa++)Ca[Oa]+=Ca[Oa-1];function xa(e){for(var t=1;t<Ca.length;t+=2)if(Ca[t]>e)return Ca[t-1]<=e;return!1}function Sa(e){return e>=127462&&e<=127487}function Aa(e,t){if(t==e.length)return t;t&&Ta(e.charCodeAt(t))&&Ia(e.charCodeAt(t-1))&&t--;var n=Ea(e,t);for(t+=Ma(n);t<e.length;){var r=Ea(e,t);if(8205==n||8205==r||xa(r))t+=Ma(r),n=r;else{if(!Sa(r))break;for(var i=0,o=t-2;o>=0&&Sa(Ea(e,o));)i++,o-=2;if(i%2==0)break;t+=2}}return t}function Pa(e,t){for(;t>0;){var n=Aa(e,t-2);if(n<t)return n;t--}return 0}function Ta(e){return e>=56320&&e<57344}function Ia(e){return e>=55296&&e<56320}function Ea(e,t){var n=e.charCodeAt(t);if(!Ia(n)||t+1==e.length)return n;var r=e.charCodeAt(t+1);return Ta(r)?r-56320+(n-55296<<10)+65536:n}function Da(e){return e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode(55296+(e>>10),56320+(1023&e)))}function Ma(e){return e<65536?1:2}function Qa(e,t,n){for(var r=0;r<e.length;)9==e.charCodeAt(r)?(t+=n-t%n,r++):(t++,r=Aa(e,r));return t}function Ra(e,t,n,r){for(var i=0;i<e.length;){if(t>=n)return{offset:i,leftOver:0};t+=9==e.charCodeAt(i)?r-t%r:1,i=Aa(e,i)}return{offset:e.length,leftOver:n-t}}var Ha=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"lineAt",value:function(e){if(e<0||e>this.length)throw new RangeError("Invalid position ".concat(e," in document of length ").concat(this.length));var t,n=_createForOfIteratorHelper(Na);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.doc==this&&r.from<=e&&r.to>=e)return r}}catch(i){n.e(i)}finally{n.f()}return Fa(this.lineInner(e,!1,1,0).finish(this))}},{key:"line",value:function(e){if(e<1||e>this.lines)throw new RangeError("Invalid line number ".concat(e," in ").concat(this.lines,"-line document"));var t,n=_createForOfIteratorHelper(Na);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.doc==this&&r.number==e)return r}}catch(i){n.e(i)}finally{n.f()}return Fa(this.lineInner(e,!0,1,0).finish(this))}},{key:"replace",value:function(e,t,n){var r=[];return this.decompose(0,e,r),r.push(n),this.decompose(t,this.length,r),Ba.from(r,this.length-(t-e)+n.length)}},{key:"append",value:function(e){return 0==this.length?e:0==e.length?this:Ba.from([this,e],this.length+e.length)}},{key:"slice",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.length,n=[];return this.decompose(e,t,n),Ba.from(n,t-e)}},{key:"eq",value:function(e){return this==e||function(e,t){if(e.length!=t.length||e.lines!=t.lines)return!1;for(var n=new qa(e),r=new qa(t),i=0,o=0;;){if(n.lineBreak!=r.lineBreak||n.done!=r.done)return!1;if(n.done)return!0;if(n.lineBreak)n.next(),r.next(),i=o=0;else{var a=n.value.slice(i),s=r.value.slice(o);if(a.length==s.length){if(a!=s)return!1;n.next(),r.next(),i=o=0}else if(a.length>s.length){if(a.slice(0,s.length)!=s)return!1;i+=s.length,r.next(),o=0}else{if(s.slice(0,a.length)!=a)return!1;o+=a.length,n.next(),i=0}}}}(this,e)}},{key:"iter",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return new qa(this,e)}},{key:"iterRange",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.length;return new Wa(this,e,t)}},{key:"iterLines",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new Ua(this,e)}},{key:"toString",value:function(){return this.sliceString(0)}},{key:"toJSON",value:function(){for(var e=[],t=this.iterLines();!t.next().done;)e.push(t.value);return e}}],[{key:"of",value:function(t){if(0==t.length)throw new RangeError("A document must have at least one line");if(1==t.length&&!t[0]&&e.empty)return e.empty;var n=Va(t);return n<1024?new $a(t,n):Ba.from($a.split(t,[]),n)}}]),e}();"undefined"!=typeof Symbol&&(Ha.prototype[Symbol.iterator]=function(){return this.iter()});var Na=[],La=-1;function Fa(e){return Na[La=(La+1)%10]=e}var $a=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Va(e);return _classCallCheck(this,n),(r=t.call(this)).text=e,r.length=i,r}return _createClass(n,[{key:"lineInner",value:function(e,t,n,r){for(var i=0;;i++){var o=this.text[i],a=r+o.length;if((t?n:a)>=e)return new Xa(r,a,n,o);r=a+1,n++}}},{key:"decompose",value:function(e,t,r){r.push(new n(ja(this.text,e,t),Math.min(t,this.length)-Math.max(0,e)))}},{key:"lastLineLength",value:function(){return this.text[this.text.length-1].length}},{key:"firstLineLength",value:function(){return this.text[0].length}},{key:"replace",value:function(e,t,r){var i=this.length+r.length-(t-e);return i>=1024||!(r instanceof n)?_get(_getPrototypeOf(n.prototype),"replace",this).call(this,e,t,r):new n(za(this.text,za(r.text,ja(this.text,0,e)),t),i)}},{key:"sliceString",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.length,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"\n",r="",i=0,o=0;i<=t&&o<this.text.length;o++){var a=this.text[o],s=i+a.length;i>e&&o&&(r+=n),e<s&&t>i&&(r+=a.slice(Math.max(0,e-i),t-i)),i=s+1}return r}},{key:"flatten",value:function(e){e[e.length-1]+=this.text[0];for(var t=1;t<this.text.length;t++)e.push(this.text[t])}},{key:"lines",get:function(){return this.text.length}},{key:"children",get:function(){return null}}],[{key:"split",value:function(e,t){var r,i=[],o=-1,a=_createForOfIteratorHelper(e);try{for(a.s();!(r=a.n()).done;)for(var s=r.value;;){var l=o+s.length+1;if(l<512){o=l,i.push(s);break}var u=512-o-1,c=s.charCodeAt(u);c>=56320&&c<57344&&u++,i.push(s.slice(0,u)),t.push(new n(i,512)),s=s.slice(u),o=-1,i=[]}}catch(h){a.e(h)}finally{a.f()}return-1!=o&&t.push(new n(i,o)),t}}]),n}(Ha),Ba=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var i;_classCallCheck(this,n),(i=t.call(this)).children=e,i.length=r,i.lines=1;var o,a=_createForOfIteratorHelper(e);try{for(a.s();!(o=a.n()).done;){var s=o.value;i.lines+=s.lines-1}}catch(l){a.e(l)}finally{a.f()}return i}return _createClass(n,[{key:"lineInner",value:function(e,t,n,r){for(var i=0;;i++){var o=this.children[i],a=r+o.length,s=n+o.lines-1;if((t?s:a)>=e){var l=void 0,u=o.lineInner(e,t,n,r);return u.from==r&&(l=this.lineLengthTo(i))&&(u.from-=l,u.content=null),u.to==a&&(l=this.lineLengthFrom(i+1))&&(u.to+=l,u.content=null),u}r=a,n=s}}},{key:"decompose",value:function(e,t,n){for(var r=0,i=0;i<t&&r<this.children.length;r++){var o=this.children[r],a=i+o.length;e<a&&t>i&&(i>=e&&a<=t?n.push(o):o.decompose(e-i,t-i,n)),i=a}}},{key:"lineLengthTo",value:function(e){for(var t=0,n=e-1;n>=0;n--){var r=this.children[n];if(r.lines>1)return t+r.lastLineLength();t+=r.length}return t}},{key:"lastLineLength",value:function(){return this.lineLengthTo(this.children.length)}},{key:"lineLengthFrom",value:function(e){for(var t=0,n=e;n<this.children.length;n++){var r=this.children[n];if(r.lines>1)return t+r.firstLineLength();t+=r.length}return t}},{key:"firstLineLength",value:function(){return this.lineLengthFrom(0)}},{key:"replace",value:function(e,t,r){if(r.length<512&&t-e<512)for(var i=r.length-(t-e),o=0,a=0;o<this.children.length;o++){var s=this.children[o],l=a+s.length;if(e>=a&&t<=l&&s.length+i<this.length+i>>2&&s.length+i>0){var u=this.children.slice();return u[o]=s.replace(e-a,t-a,r),new n(u,this.length+i)}a=l}return _get(_getPrototypeOf(n.prototype),"replace",this).call(this,e,t,r)}},{key:"sliceString",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.length,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"\n",r="",i=0,o=0;o<t&&i<this.children.length;i++){var a=this.children[i],s=o+a.length;if(e<s&&t>o){var l=a.sliceString(e-o,t-o,n);if(e>=o&&t<=s)return l;r+=l}o=s}return r}},{key:"flatten",value:function(e){var t,n=_createForOfIteratorHelper(this.children);try{for(n.s();!(t=n.n()).done;){t.value.flatten(e)}}catch(r){n.e(r)}finally{n.f()}}}],[{key:"from",value:function(e,t){if(!e.every((function(e){return e instanceof Ha})))throw new Error("NOP");if(t<1024){var r,i=[""],o=_createForOfIteratorHelper(e);try{for(o.s();!(r=o.n()).done;){r.value.flatten(i)}}catch(g){o.e(g)}finally{o.f()}return new $a(i,t)}var a=Math.max(512,t>>3),s=a<<1,l=a>>1,u=[],c=0,h=[];function f(e){var t,r=e.length;if(r)if(r>s&&e instanceof n){var i,o=_createForOfIteratorHelper(e.children);try{for(o.s();!(i=o.n()).done;){f(i.value)}}catch(g){o.e(g)}finally{o.f()}}else r>l&&(c>l||0==c)?(d(),u.push(e)):e instanceof $a&&c>0&&(t=h[h.length-1])instanceof $a&&e.length+t.length<=512?(c+=r,h[h.length-1]=new $a(za(e.text,t.text.slice()),e.length+t.length)):(c+r>a&&d(),c+=r,h.push(e))}function d(){0!=c&&(u.push(1==h.length?h[0]:n.from(h,c)),c=0,h.length=0)}var v,p=_createForOfIteratorHelper(e);try{for(p.s();!(v=p.n()).done;){f(v.value)}}catch(g){p.e(g)}finally{p.f()}return d(),1==u.length?u[0]:new n(u,t)}}]),n}(Ha);function Va(e){var t,n=-1,r=_createForOfIteratorHelper(e);try{for(r.s();!(t=r.n()).done;){n+=t.value.length+1}}catch(i){r.e(i)}finally{r.f()}return n}function za(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e9,i=0,o=0,a=!0;o<e.length&&i<=r;o++){var s=e[o],l=i+s.length;l>=n&&(l>r&&(s=s.slice(0,r-i)),i<n&&(s=s.slice(n-i)),a?(t[t.length-1]+=s,a=!1):t.push(s)),i=l+1}return t}function ja(e,t,n){return za(e,[""],t,n)}Ha.empty=Ha.of([""]);var qa=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;_classCallCheck(this,e),this.dir=n,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[t],this.offsets=[n>0?0:t instanceof $a?t.text.length:t.children.length]}return _createClass(e,[{key:"next",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;;){var t=this.nodes.length-1;if(t<0)return this.done=!0,this.value="",this.lineBreak=!1,this;var n=this.nodes[t],r=this.offsets[t];if(n instanceof $a){if(r!=(this.dir>0?0:n.text.length)&&!this.lineBreak){if(this.lineBreak=!0,0==e)return this.value="\n",this;e--;continue}var i=n.text[r-(this.dir<0?1:0)];if(this.offsets[t]=r+=this.dir,r==(this.dir>0?n.text.length:0)&&(this.nodes.pop(),this.offsets.pop()),this.lineBreak=!1,i.length>Math.max(0,e))return this.value=0==e?i:this.dir>0?i.slice(e):i.slice(0,i.length-e),this;e-=i.length}else if(r==(this.dir>0?n.children.length:0))this.nodes.pop(),this.offsets.pop();else{var o=n.children[this.dir>0?r:r-1],a=o.length;this.offsets[t]=r+this.dir,e>a?e-=a:(this.nodes.push(o),this.offsets.push(this.dir>0?0:o instanceof $a?o.text.length:o.children.length))}}}}]),e}(),Wa=function(){function e(t,n,r){_classCallCheck(this,e),this.value="",this.cursor=new qa(t,n>r?-1:1),n>r?(this.skip=t.length-n,this.limit=n-r):(this.skip=n,this.limit=r-n)}return _createClass(e,[{key:"next",value:function(){if(this.limit<=0)this.limit=-1;else{var e=this.cursor.next(this.skip),t=e.value,n=e.lineBreak,r=e.done;this.skip=0,this.value=t;var i=n?1:t.length;i>this.limit&&(this.value=this.cursor.dir>0?t.slice(0,this.limit):t.slice(i-this.limit)),r||0==this.value.length?this.limit=-1:this.limit-=this.value.length}return this}},{key:"lineBreak",get:function(){return this.cursor.lineBreak}},{key:"done",get:function(){return this.limit<0}}]),e}(),Ua=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;_classCallCheck(this,e),this.value="",this.done=!1,this.cursor=t.iter(),this.skip=n}return _createClass(e,[{key:"next",value:function(){if(this.cursor.done)return this.done=!0,this.value="",this;for(this.value="";;){var e=this.cursor.next(this.skip),t=e.value,n=e.lineBreak,r=e.done;if(this.skip=0,r||n)return this;this.value+=t}}},{key:"lineBreak",get:function(){return!1}}]),e}(),Xa=function(){function e(t,n,r,i){_classCallCheck(this,e),this.from=t,this.to=n,this.number=r,this.content=i}return _createClass(e,[{key:"slice",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.length;if(e==t)return"";if("string"==typeof this.content)return this.content.slice(e,t);this.content||(this.content=new Ga(this.doc,this.from));var n=this.content.slice(e,t);return 0==e&&t==this.length&&(this.content=n),n}},{key:"finish",value:function(e){return this.doc=e,this}},{key:"findClusterBreak",value:function(e,t){if(e<0||e>this.length)throw new RangeError("Invalid position given to Line.findClusterBreak");var n,r;return"string"==this.content?(n=this.from,r=this.content):(n=Math.max(0,e-256),r=this.slice(n,Math.min(this.length,n+512))),(t?Aa:Pa)(r,e-n)+n}},{key:"length",get:function(){return this.to-this.from}}]),e}(),Ga=function(){function e(t,n){_classCallCheck(this,e),this.doc=t,this.start=n,this.cursor=null,this.strings=null}return _createClass(e,[{key:"slice",value:function(e,t){this.cursor||(this.cursor=this.doc.iter(),this.strings=[this.cursor.next(this.start).value]);for(var n="",r=0,i=0;;i++){if(i==this.strings.length){var o=this.cursor.next().value;if(!o)return n;this.strings.push(o)}var a=this.strings[i],s=r;if(!((r+=a.length)<=e)&&(n+=a.slice(Math.max(0,e-s),Math.min(a.length,t-s)),r>=t))return n}}}]),e}(),Za=function(){function e(t,n){_classCallCheck(this,e),this.enter=t,this.leave=n,this.result=void 0}return _createClass(e,[{key:"doEnter",value:function(e,t,n){var r=this.enter(e,t,n);return void 0===r||(!1!==r&&(this.result=r),!1)}},{key:"done",get:function(){return void 0!==this.result}}]),e}(),Ya=0,Ka=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.deserialize;_classCallCheck(this,e),this.id=Ya++,this.deserialize=n||function(){throw new Error("This node type doesn't define a deserialize function")}}return _createClass(e,[{key:"set",value:function(e,t){return e[this.id]=t,e}},{key:"add",value:function(e){return new Ja(this,"function"==typeof e?e:es.match(e))}}],[{key:"string",value:function(){return new e({deserialize:function(e){return e}})}},{key:"number",value:function(){return new e({deserialize:Number})}},{key:"flag",value:function(){return new e({deserialize:function(){return!0}})}}]),e}();Ka.error=Ka.flag(),Ka.skipped=Ka.flag(),Ka.closedBy=new Ka({deserialize:function(e){return e.split(" ")}}),Ka.openedBy=new Ka({deserialize:function(e){return e.split(" ")}}),Ka.top=Ka.flag();var Ja=function e(t,n){_classCallCheck(this,e),this.prop=t,this.f=n},es=function(){function e(t,n,r){_classCallCheck(this,e),this.name=t,this.props=n,this.id=r}return _createClass(e,[{key:"prop",value:function(e){return this.props[e.id]}}],[{key:"match",value:function(e){var t=Object.create(null);for(var n in e){var r,i=_createForOfIteratorHelper(n.split(" "));try{for(i.s();!(r=i.n()).done;){var o=r.value;t[o]=e[n]}}catch(a){i.e(a)}finally{i.f()}}return function(e){return t[e.name]}}}]),e}();es.none=new es("",Object.create(null),0);var ts=function(){function e(t){_classCallCheck(this,e),this.types=t;for(var n=0;n<t.length;n++)if(t[n].id!=n)throw new RangeError("Node type ids should correspond to array positions when creating a node group")}return _createClass(e,[{key:"extend",value:function(){for(var t=[],n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var o,a=_createForOfIteratorHelper(this.types);try{for(a.s();!(o=a.n()).done;){var s,l=o.value,u=null,c=_createForOfIteratorHelper(r);try{for(c.s();!(s=c.n()).done;){var h=s.value,f=h.f(l);if(void 0!==f){if(!u)for(var d in u=Object.create(null),l.props)u[d]=l.props[d];u[h.prop.id]=f}}}catch(v){c.e(v)}finally{c.f()}t.push(u?new es(l.name,u,l.id):l)}}catch(v){a.e(v)}finally{a.f()}return new e(t)}}]),e}(),ns=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"resolve",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.resolveAt(e);if(0!=t)for(;;){var r=t<0?n.childBefore(e):n.childAfter(e);if(!r||(t<0?r.end:r.start)!=e)break;n=r}return n}},{key:"name",get:function(){return this.type.name}},{key:"depth",get:function(){for(var e=0,t=this.parent;t;t=t.parent)e++;return e}},{key:"root",get:function(){for(var e=this;e.parent;)e=e.parent;return e}},{key:"firstChild",get:function(){return this.childAfter(this.start-1)}},{key:"lastChild",get:function(){return this.childBefore(this.end+1)}}]),e}(),rs=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,i,o){var a;return _classCallCheck(this,n),(a=t.call(this)).type=e,a.children=r,a.positions=i,a.length=o,a}return _createClass(n,[{key:"toString",value:function(){var e=this.children.map((function(e){return e.toString()})).join();return this.name?(/\W/.test(this.name)&&!this.type.prop(Ka.error)?JSON.stringify(this.name):this.name)+(e.length?"("+e+")":""):e}},{key:"partial",value:function(e,t,r,i,o){for(var a=0;a<this.children.length;a++){var s=this.positions[a];if(s>t)break;var l=this.children[a],u=s+l.length;u<e||(e<=s&&t>=u?(i.push(l),o.push(s+r)):l instanceof n&&l.partial(e-s,t-s,r+s,i,o))}}},{key:"applyChanges",value:function(e){if(0==e.length)return this;var t=[],r=[];function i(e,t,n){var r=-1;return e.iterate({from:t,to:n<0?0:e.length,enter:function(){return r<0&&void 0},leave:function(e,i,o){r<0&&(n<0?o<=t:i>=t)&&!e.prop(Ka.error)&&(r=n<0?Math.min(t,o-1):Math.max(t,i+1))}}),r>-1?r:n<0?0:e.length}for(var o=0,a=0,s=0;;a++){var l=a==e.length?null:e[a],u=l?i(this,l.fromA,-1):this.length;if(u>s&&this.partial(s,u,o,t,r),!l)break;s=i(this,l.toA,1),o+=l.toB-l.fromB-(l.toA-l.fromA)}return new n(es.none,t,r,this.length+o)}},{key:"cut",value:function(e){if(e>=this.length)return this;for(var t=[],r=[],i=0;i<this.children.length;i++){var o=this.positions[i];if(o>=e)break;var a=this.children[i];t.push(o+a.length<=e?a:a.cut(e-o)),r.push(o)}return new n(this.type,t,r,e)}},{key:"iterate",value:function(e){var t=e.from,n=void 0===t?this.start:t,r=e.to,i=void 0===r?this.end:r,o=e.enter,a=e.leave,s=new Za(o,a);return this.iterInner(n,i,0,s),s.result}},{key:"iterInner",value:function(e,t,n,r){if(!this.type.name||r.doEnter(this.type,n,n+this.length)){if(e<=t)for(var i=0;i<this.children.length&&!r.done;i++){var o=this.children[i],a=this.positions[i]+n,s=a+o.length;if(a>t)break;s<e||o.iterInner(e,t,a,r)}else for(var l=this.children.length-1;l>=0&&!r.done;l--){var u=this.children[l],c=this.positions[l]+n;if(c+u.length<t)break;c>e||u.iterInner(e,t,c,r)}r.leave&&this.type.name&&r.leave(this.type,n,n+this.length)}}},{key:"resolveAt",value:function(e){if(is==this)for(var t=os;;){var n=t.parent;if(!n)break;if(t.start<e&&t.end>e)return t.resolve(e);t=n}return is=this,os=this.resolveInner(e,0,this)}},{key:"childBefore",value:function(e){return this.findChild(e,-1,0,this)}},{key:"childAfter",value:function(e){return this.findChild(e,1,0,this)}},{key:"findChild",value:function(e,t,r,i){for(var o=0;o<this.children.length;o++){var a=this.positions[o]+r,s=-1;if(a>=e)if(t<0&&o>0)s=o-1;else{if(!(t>0))break;s=o}if(s<0&&(a+this.children[o].length>e||t<0&&o==this.children.length-1)&&(s=o),s>=0){var l=this.children[s],u=this.positions[s]+r;if(0==l.length&&u==e)continue;if(l instanceof n)return l.type.name?new ss(l,u,i):l.findChild(e,t,u,i);var c=l.findIndex(e,t,u,0,l.buffer.length);if(c>-1)return new ls(l,u,c,i)}}return null}},{key:"resolveInner",value:function(e,t,n){var r=this.findChild(e,0,t,n);return r?r.resolveAt(e):n}},{key:"append",value:function(e){if(e.children.length&&e.positions[0]<this.length)throw new Error("Can't append overlapping trees");return new n(this.type,this.children.concat(e.children),this.positions.concat(e.positions),e.length)}},{key:"balance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return this.children.length<=cs?this:hs(this.type,es.none,this.children,this.positions,0,this.children.length,0,e,this.length)}},{key:"start",get:function(){return 0}},{key:"end",get:function(){return this.length}}],[{key:"build",value:function(e){return function(e){var t=e.buffer,r=e.group,i=e.topID,o=void 0===i?0:i,a=e.maxBufferLength,s=void 0===a?1024:a,l=e.reused,u=void 0===l?[]:l,c=e.minRepeatType,h=void 0===c?r.types.length:c,f=Array.isArray(t)?new us(t,t.length):t,d=r.types;function v(e,t,i,o,a){for(var l=f.id,c=f.start,g=f.end,m=f.size;l==a;){var y;f.next(),l=(y=f).id,c=y.start,g=y.end,m=y.size}var k=c-e;if(m<0)return i.push(u[l]),o.push(k),void f.next();var b,w,_=d[l];if(g-c<=s&&(w=function(e,t){var n=f.fork(),r=0,i=0,o=0,a=n.end-s,l={size:0,start:0,skip:0};e:for(var u=n.pos-e;n.pos>u;)if(n.id!=t){var c=n.size,d=n.pos-c;if(c<0||d<u||n.start<a)break;var v=n.id>=h?4:0,p=n.start;for(n.next();n.pos>d;){if(n.size<0)break e;n.id>=h&&(v+=4),n.next()}i=p,r+=c,o+=v}else l.size=r,l.start=i,l.skip=o,o+=4,r+=4,n.next();return(t<0||r==e)&&(l.size=r,l.start=i,l.skip=o),l.size>4?l:void 0}(f.pos-t,a))){for(var C=new Uint16Array(w.size-w.skip),O=f.pos-w.size,x=C.length;f.pos>O;)x=p(w.start,C,x,a);b=new as(C,g-w.start,r,a<0?es.none:d[a]),k=w.start-e}else{var S=f.pos-m;f.next();for(var A=[],P=[],T=l>=h?l:-1;f.pos>S;)v(c,S,A,P,T);A.reverse(),P.reverse(),b=T>-1&&A.length>cs?hs(_,_,A,P,0,A.length,0,s,g-c):new n(_,A,P,g-c)}i.push(b),o.push(k)}function p(e,t,n,r){var i=f.id,o=f.start,a=f.end,s=f.size;if(f.next(),i==r)return n;var l=n;if(s>4)for(var u=f.pos-(s-4);f.pos>u;)n=p(e,t,n,r);return i<h&&(t[--n]=l,t[--n]=a-e,t[--n]=o-e,t[--n]=i),n}for(var g=[],m=[];f.pos>0;)v(0,0,g,m,-1);var y=g.length?m[0]+g[0].length:0;return new n(r.types[o],g.reverse(),m.reverse(),y)}(e)}}]),n}(ns);rs.empty=new rs(es.none,[],[],0),rs.prototype.parent=null;var is=rs.empty,os=rs.empty,as=function(){function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:es.none;_classCallCheck(this,e),this.buffer=t,this.length=n,this.group=r,this.type=i}return _createClass(e,[{key:"toString",value:function(){for(var e=[],t=0;t<this.buffer.length;)t=this.childToString(t,e);return e.join(",")}},{key:"childToString",value:function(e,t){var n=this.buffer[e+3],r=this.group.types[this.buffer[e]],i=r.name;if(/\W/.test(i)&&!r.prop(Ka.error)&&(i=JSON.stringify(i)),n>(e+=4)){for(var o=[];e<n;)e=this.childToString(e,o);i+="("+o.join(",")+")"}return t.push(i),e}},{key:"cut",value:function(t){for(var n=0;n<this.buffer.length&&this.buffer[n+1]<t;)n+=4;for(var r=new Uint16Array(n),i=0;i<n;i+=4)r[i]=this.buffer[i],r[i+1]=this.buffer[i+1],r[i+2]=Math.min(t,this.buffer[i+2]),r[i+3]=Math.min(this.buffer[i+3],n);return new e(r,Math.min(t,this.length),this.group)}},{key:"iterate",value:function(e){var t=e.from,n=void 0===t?0:t,r=e.to,i=void 0===r?this.length:r,o=e.enter,a=e.leave,s=new Za(o,a);return this.iterInner(n,i,0,s),s.result}},{key:"iterInner",value:function(e,t,n,r){if(e<=t)for(var i=0;i<this.buffer.length;)i=this.iterChild(e,t,n,i,r);else this.iterRev(e,t,n,0,this.buffer.length,r)}},{key:"iterChild",value:function(e,t,n,r,i){var o=this.group.types[this.buffer[r++]],a=this.buffer[r++]+n,s=this.buffer[r++]+n,l=this.buffer[r++];if(a>t)return this.buffer.length;if(s>=e&&i.doEnter(o,a,s)){for(;r<l&&!i.done;)r=this.iterChild(e,t,n,r,i);i.leave&&i.leave(o,a,s)}return l}},{key:"parentNodesByEnd",value:function(e,t){for(var n=this,r=[],i=function e(t){var i=n.buffer[t+3];if(i==t+4)return i;for(var o=t+4;o<i;)o=e(o);return r.push(t),i},o=e;o<t;)o=i(o);return r}},{key:"iterRev",value:function(e,t,n,r,i,o){var a=this,s=this.parentNodesByEnd(r,i),l=-1,u=-1,c=function(){s.length>0?(l=s.pop(),u=a.buffer[l+3]):u=-1};c();e:for(var h=i;h>r&&!o.done;){for(;u==h;){var f=l,d=this.buffer[f],v=this.buffer[f+1]+n,p=this.buffer[f+2]+n;if(c(),v<=e&&p>=t&&!o.doEnter(this.group.types[d],v,p)){for(h=f;u>f;)c();continue e}}var g=this.buffer[--h],m=this.buffer[--h]+n,y=this.buffer[--h]+n,k=this.buffer[--h];y>e||m<t||(g!=h+4||o.doEnter(this.group.types[k],y,m))&&o.leave&&o.leave(this.group.types[k],y,m)}}},{key:"findIndex",value:function(e,t,n,r,i){for(var o=-1,a=r,s=this.buffer;a<i;){var l=s[a+1]+n,u=s[a+2]+n,c=l==u&&l==e;if(l>=e){if(t>0&&!c)return a;break}if(u>e)return a;c||(o=a),a=s[a+3]}return t<0?o:-1}}]),e}(),ss=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,i){var o;return _classCallCheck(this,n),(o=t.call(this)).node=e,o.start=r,o.parent=i,o}return _createClass(n,[{key:"resolveAt",value:function(e){return e<=this.start||e>=this.end?this.parent.resolveAt(e):this.node.resolveInner(e,this.start,this)}},{key:"childBefore",value:function(e){return this.node.findChild(e,-1,this.start,this)}},{key:"childAfter",value:function(e){return this.node.findChild(e,1,this.start,this)}},{key:"toString",value:function(){return this.node.toString()}},{key:"iterate",value:function(e){var t=e.from,n=void 0===t?this.start:t,r=e.to,i=void 0===r?this.end:r,o=e.enter,a=e.leave,s=new Za(o,a);return this.node.iterInner(n,i,this.start,s),s.result}},{key:"type",get:function(){return this.node.type}},{key:"end",get:function(){return this.start+this.node.length}}]),n}(ns),ls=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,i,o){var a;return _classCallCheck(this,n),(a=t.call(this)).buffer=e,a.bufferStart=r,a.index=i,a.parent=o,a}return _createClass(n,[{key:"childBefore",value:function(e){var t=this.buffer.findIndex(e,-1,this.bufferStart,this.index+4,this.endIndex);return t<0?null:new n(this.buffer,this.bufferStart,t,this)}},{key:"childAfter",value:function(e){var t=this.buffer.findIndex(e,1,this.bufferStart,this.index+4,this.endIndex);return t<0?null:new n(this.buffer,this.bufferStart,t,this)}},{key:"iterate",value:function(e){var t=e.from,n=void 0===t?this.start:t,r=e.to,i=void 0===r?this.end:r,o=e.enter,a=e.leave,s=new Za(o,a);return n<=i?this.buffer.iterChild(n,i,this.bufferStart,this.index,s):this.buffer.iterRev(n,i,this.bufferStart,this.index,this.endIndex,s),s.result}},{key:"resolveAt",value:function(e){if(e<=this.start||e>=this.end)return this.parent.resolveAt(e);var t=this.buffer.findIndex(e,0,this.bufferStart,this.index+4,this.endIndex);return t<0?this:new n(this.buffer,this.bufferStart,t,this).resolveAt(e)}},{key:"toString",value:function(){var e=[];return this.buffer.childToString(this.index,e),e.join("")}},{key:"type",get:function(){return this.buffer.group.types[this.buffer.buffer[this.index]]}},{key:"start",get:function(){return this.buffer.buffer[this.index+1]+this.bufferStart}},{key:"end",get:function(){return this.buffer.buffer[this.index+2]+this.bufferStart}},{key:"endIndex",get:function(){return this.buffer.buffer[this.index+3]}}]),n}(ns),us=function(){function e(t,n){_classCallCheck(this,e),this.buffer=t,this.index=n}return _createClass(e,[{key:"next",value:function(){this.index-=4}},{key:"fork",value:function(){return new e(this.buffer,this.index)}},{key:"id",get:function(){return this.buffer[this.index-4]}},{key:"start",get:function(){return this.buffer[this.index-3]}},{key:"end",get:function(){return this.buffer[this.index-2]}},{key:"size",get:function(){return this.buffer[this.index-1]}},{key:"pos",get:function(){return this.index}}]),e}(),cs=8;function hs(e,t,n,r,i,o,a,s,l){var u=[],c=[];if(l<=s)for(var h=i;h<o;h++)u.push(n[h]),c.push(r[h]-a);else for(var f=Math.max(s,Math.ceil(1.5*l/cs)),d=i;d<o;){var v=d,p=r[d];for(d++;d<o&&!(r[d]+n[d].length-p>f);d++);if(d==v+1){var g=n[v];if(g instanceof rs&&g.type==t&&g.length>f<<1){for(var m=0;m<g.children.length;m++)u.push(g.children[m]),c.push(g.positions[m]+p-a);continue}u.push(g)}else if(d==v+1)u.push(n[v]);else{var y=hs(t,t,n,r,v,d,p,s,r[d-1]+n[d-1].length-p);t==es.none||fs(y.children,t)||(y=new rs(es.none,y.children,y.positions,y.length)),u.push(y)}c.push(p-a)}return new rs(e,u,c,l)}function fs(e,t){var n,r=_createForOfIteratorHelper(e);try{for(r.s();!(n=r.n()).done;){if(n.value.type==t)return!0}}catch(i){r.e(i)}finally{r.f()}return!1}var ds,vs=/\r\n?|\n/;!function(e){e[e.Simple=0]="Simple",e[e.TrackDel=1]="TrackDel",e[e.TrackBefore=2]="TrackBefore",e[e.TrackAfter=3]="TrackAfter"}(ds||(ds={}));var ps=function(){function e(t){_classCallCheck(this,e),this.sections=t}return _createClass(e,[{key:"iterGaps",value:function(e){for(var t=0,n=0,r=0;t<this.sections.length;){var i=this.sections[t++],o=this.sections[t++];o<0?(e(n,r,i),r+=i):r+=o,n+=i}}},{key:"iterChangedRanges",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];ks(this,e,t)}},{key:"composeDesc",value:function(e){return this.empty?e:e.empty?this:ws(this,e)}},{key:"mapDesc",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e.empty?this:bs(this,e,t)}},{key:"mapPos",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ds.Simple,r=0,i=0,o=0;o<this.sections.length;){var a=this.sections[o++],s=this.sections[o++],l=r+a;if(s<0){if(l>e)return i+(e-r);i+=a}else{if(n!=ds.Simple&&l>=e&&(n==ds.TrackDel&&r<e&&l>e||n==ds.TrackBefore&&r<e||n==ds.TrackAfter&&l>e))return-1;if(l>e||l==e&&t<0&&!a)return e==r||t<0?i:i+s;i+=s}r=l}if(e>r)throw new RangeError("Position ".concat(e," is out of range for changeset of length ").concat(r));return i}},{key:"mapPosStable",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=0,r=0,i=0,o=0;o<this.sections.length;){var a=this.sections[o++],s=this.sections[o++],l=n+a;if(s<0){if(l>e)return r+Math.max(0,e-n);i=r+=a}else{if(t<=0&&l>=e)return i;r+=s}n=l}return r}},{key:"touchesRange",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=0,r=0;n<this.sections.length&&r<=t;){var i=r+this.sections[n++];if(this.sections[n++]>=0&&r<=t&&i>=e)return!(r<e&&i>t)||"cover";r=i}return!1}},{key:"toString",value:function(){for(var e="",t=0;t<this.sections.length;){var n=this.sections[t++],r=this.sections[t++];e+=(e?" ":"")+n+(r>=0?":"+r:"")}return e}},{key:"length",get:function(){for(var e=0,t=0;t<this.sections.length;t+=2)e+=this.sections[t];return e}},{key:"newLength",get:function(){for(var e=0,t=0;t<this.sections.length;t+=2){var n=this.sections[t+1];e+=n<0?this.sections[t]:n}return e}},{key:"empty",get:function(){return 0==this.sections.length||2==this.sections.length&&this.sections[1]<0}},{key:"invertedDesc",get:function(){for(var t=[],n=0;n<this.sections.length;){var r=this.sections[n++],i=this.sections[n++];i<0?t.push(r,i):t.push(i,r)}return new e(t)}}]),e}(),gs=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var i;return _classCallCheck(this,n),(i=t.call(this,e)).inserted=r,i}return _createClass(n,[{key:"apply",value:function(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return ks(this,(function(t,n,r,i,o){return e=e.replace(r,r+(n-t),o)}),!1),e}},{key:"mapDesc",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return bs(this,e,t,!0)}},{key:"invert",value:function(e){for(var t=this.sections.slice(),r=[],i=0,o=0;i<t.length;i+=2){var a=t[i],s=t[i+1];if(s>=0){t[i]=s,t[i+1]=a;for(var l=i>>1;r.length<l;)r.push(Ha.empty);r.push(a?e.slice(o,o+a):Ha.empty)}o+=a}return new n(t,r)}},{key:"compose",value:function(e){return this.empty?e:e.empty?this:ws(this,e,!0)}},{key:"map",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e.empty?this:bs(this,e,t,!0)}},{key:"iterChanges",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];ks(this,e,t)}},{key:"filter",value:function(e){var t=[],r=[],i=[],o=new _s(this);e:for(var a=0,s=0;;){for(var l=a==e.length?1e9:e[a++];s<l||s==l&&0==o.len;){if(o.done)break e;var u=Math.min(o.len,l-s);ms(i,u,-1);var c=-1==o.ins?-1:0==o.off?o.ins:0;ms(t,u,c),c>0&&ys(r,t,o.text),o.forward(u),s+=u}for(var h=e[a++];s<h;){if(o.done)break e;var f=Math.min(o.len,h-s);ms(t,f,-1),ms(i,f,-1==o.ins?-1:0==o.off?o.ins:0),o.forward(f),s+=f}}return{changes:new n(t,r),filtered:new ps(i)}}},{key:"toJSON",value:function(){for(var e=[],t=0;t<this.sections.length;t+=2){var n=this.sections[t],r=this.sections[t+1];e.push(r<0?n:0==r?[n]:[n,this.inserted[t>>1].toJSON()])}return e}},{key:"desc",get:function(){return new ps(this.sections)}}],[{key:"of",value:function(e,t,r){var i=[],o=[],a=0,s=null;function l(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e||i.length){a<t&&ms(i,t-a,-1);var r=new n(i,o);s=s?s.compose(r.map(s)):r,i=[],o=[],a=0}}return function e(u){if(Array.isArray(u)){var c,h=_createForOfIteratorHelper(u);try{for(h.s();!(c=h.n()).done;){e(c.value)}}catch(y){h.e(y)}finally{h.f()}}else if(u instanceof n){if(u.length!=t)throw new RangeError("Mismatched change set length (got ".concat(u.length,", expected ").concat(t,")"));l(),s=s?s.compose(u.map(s)):u}else{var f=u.from,d=u.to,v=void 0===d?f:d,p=u.insert;if(f>v||f<0||v>t)throw new RangeError("Invalid change range ".concat(f," to ").concat(v," (in doc of length ").concat(t,")"));var g=p?"string"==typeof p?Ha.of(p.split(r||vs)):p:Ha.empty,m=g.length;if(f==v&&0==m)return;f<a&&l(),f>a&&ms(i,f-a,-1),ms(i,v-f,m),ys(o,i,g),a=v}}(e),l(!s),s}},{key:"empty",value:function(e){return new n(e?[e,-1]:[],[])}},{key:"fromJSON",value:function(e){for(var t=[],r=[],i=0;i<e.length;i++){var o=e[i];if("number"==typeof o)t.push(o,-1);else if(1==o.length)t.push(o[0],0);else{for(;r.length<i-1;)r.push(Ha.empty);r[i]=Ha.of(o[1]),t.push(o[0],r[i].length)}}return new n(t,r)}}]),n}(ps);function ms(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!(0==t&&n<=0)){var i=e.length-2;i>=0&&n<=0&&n==e[i+1]?e[i]+=t:0==t&&0==e[i]?e[i+1]+=n:r?(e[i]+=t,e[i+1]+=n):e.push(t,n)}}function ys(e,t,n){if(0!=n.length){var r=t.length-2>>1;if(r<e.length)e[e.length-1]=e[e.length-1].append(n);else{for(;e.length<r;)e.push(Ha.empty);e.push(n)}}}function ks(e,t,n){for(var r=e.inserted,i=0,o=0,a=0;a<e.sections.length;){var s=e.sections[a++],l=e.sections[a++];if(l<0)i+=s,o+=s;else{for(var u=i,c=o,h=Ha.empty;u+=s,c+=l,l&&r&&(h=h.append(r[a-2>>1])),!(n||a==e.sections.length||e.sections[a+1]<0);)s=e.sections[a++],l=e.sections[a++];t(i,u,o,c,h),i=u,o=c}}}function bs(e,t,n){for(var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=[],o=r?[]:null,a=new _s(e),s=new _s(t),l=0,u=0;;)if(-1==a.ins)l+=a.len,a.next();else if(-1==s.ins&&u<l){var c=Math.min(s.len,l-u);s.forward(c),ms(i,c,-1),u+=c}else if(s.ins>=0&&(a.done||u<l||u==l&&(s.len<a.len||s.len==a.len&&!n))){for(ms(i,s.ins,-1);l>u&&!a.done&&l+a.len<u+s.len;)l+=a.len,a.next();u+=s.len,s.next()}else{if(!(a.ins>=0)){if(a.done&&s.done)return o?new gs(i,o):new ps(i);throw new Error("Mismatched change set lengths")}for(var h=0,f=l+a.len;;)if(s.ins>=0&&u>l&&u+s.len<f)h+=s.ins,u+=s.len,s.next();else{if(!(-1==s.ins&&u<f))break;var d=Math.min(s.len,f-u);h+=d,s.forward(d),u+=d}ms(i,h,a.ins),o&&ys(o,i,a.text),l=f,a.next()}}function ws(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=[],i=n?[]:null,o=new _s(e),a=new _s(t),s=!1;;){if(o.done&&a.done)return i?new gs(r,i):new ps(r);if(0==o.ins)ms(r,o.len,0,s),o.next();else if(0!=a.len||a.done){if(o.done||a.done)throw new Error("Mismatched change set lengths");var l=Math.min(o.len2,a.len),u=r.length;if(-1==o.ins){var c=-1==a.ins?-1:a.off?0:a.ins;ms(r,l,c,s),i&&c&&ys(i,r,a.text)}else-1==a.ins?(ms(r,o.off?0:o.len,l,s),i&&ys(i,r,o.textBit(l))):(ms(r,o.off?0:o.len,a.off?0:a.ins,s),i&&!a.off&&ys(i,r,a.text));s=(o.ins>l||a.ins>=0&&a.len>l)&&(s||r.length>u),o.forward2(l),a.forward(l)}else ms(r,0,a.ins,s),i&&ys(i,r,a.text),a.next()}}var _s=function(){function e(t){_classCallCheck(this,e),this.set=t,this.i=0,this.next()}return _createClass(e,[{key:"next",value:function(){var e=this.set.sections;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}},{key:"textBit",value:function(e){var t=this.set.inserted,n=this.i-2>>1;return n>=t.length&&!e?Ha.empty:t[n].slice(this.off,null==e?void 0:this.off+e)}},{key:"forward",value:function(e){e==this.len?this.next():(this.len-=e,this.off+=e)}},{key:"forward2",value:function(e){-1==this.ins?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}},{key:"done",get:function(){return-2==this.ins}},{key:"len2",get:function(){return this.ins<0?this.len:this.ins}},{key:"text",get:function(){var e=this.set.inserted,t=this.i-2>>1;return t>=e.length?Ha.empty:e[t]}}]),e}(),Cs=function(){function e(t,n,r){_classCallCheck(this,e),this.from=t,this.to=n,this.flags=r}return _createClass(e,[{key:"map",value:function(t){var n=t.mapPos(this.from),r=t.mapPos(this.to);return n==this.from&&r==this.to?this:new e(n,r,this.flags)}},{key:"extend",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(e<=this.anchor&&t>=this.anchor)return Os.range(e,t);var n=Math.abs(e-this.anchor)>Math.abs(t-this.anchor)?e:t;return Os.range(this.anchor,n)}},{key:"eq",value:function(e){return this.anchor==e.anchor&&this.head==e.head}},{key:"toJSON",value:function(){return{anchor:this.anchor,head:this.head}}},{key:"anchor",get:function(){return 16&this.flags?this.to:this.from}},{key:"head",get:function(){return 16&this.flags?this.from:this.to}},{key:"empty",get:function(){return this.from==this.to}},{key:"assoc",get:function(){return 4&this.flags?-1:8&this.flags?1:0}},{key:"bidiLevel",get:function(){var e=3&this.flags;return 3==e?null:e}},{key:"goalColumn",get:function(){var e=this.flags>>5;return 33554431==e?void 0:e}}],[{key:"fromJSON",value:function(e){if(!e||"number"!=typeof e.anchor||"number"!=typeof e.head)throw new RangeError("Invalid JSON representation for SelectionRange");return Os.range(e.anchor,e.head)}}]),e}(),Os=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;_classCallCheck(this,e),this.ranges=t,this.primaryIndex=n}return _createClass(e,[{key:"map",value:function(t){return t.empty?this:e.create(this.ranges.map((function(e){return e.map(t)})),this.primaryIndex)}},{key:"eq",value:function(e){if(this.ranges.length!=e.ranges.length||this.primaryIndex!=e.primaryIndex)return!1;for(var t=0;t<this.ranges.length;t++)if(!this.ranges[t].eq(e.ranges[t]))return!1;return!0}},{key:"asSingle",value:function(){return 1==this.ranges.length?this:new e([this.primary])}},{key:"addRange",value:function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e.create([t].concat(this.ranges),n?0:this.primaryIndex+1)}},{key:"replaceRange",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.primaryIndex,r=this.ranges.slice();return r[n]=t,e.create(r,this.primaryIndex)}},{key:"toJSON",value:function(){return{ranges:this.ranges.map((function(e){return e.toJSON()})),primaryIndex:this.primaryIndex}}},{key:"primary",get:function(){return this.ranges[this.primaryIndex]}}],[{key:"fromJSON",value:function(t){if(!t||!Array.isArray(t.ranges)||"number"!=typeof t.primaryIndex||t.primaryIndex>=t.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new e(t.ranges.map((function(e){return Cs.fromJSON(e)})),t.primaryIndex)}},{key:"single",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return new e([e.range(t,n)],0)}},{key:"create",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(0==t.length)throw new RangeError("A selection needs at least one range");for(var r=0,i=0;i<t.length;i++){var o=t[i];if(o.empty?o.from<=r:o.from<r)return xs(t.slice(),n);r=o.to}return new e(t,n)}},{key:"cursor",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return new Cs(e,e,(0==t?0:t<0?4:8)|(null==n?3:Math.min(2,n))|(null!=r?r:33554431)<<5)}},{key:"range",value:function(e,t,n){var r=(null!=n?n:33554431)<<5;return t<e?new Cs(t,e,16|r):new Cs(e,t,r)}}]),e}();function xs(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=e[t];e.sort((function(e,t){return e.from-t.from})),t=e.indexOf(n);for(var r=1;r<e.length;r++){var i=e[r],o=e[r-1];if(i.empty?i.from<=o.to:i.from<o.to){var a=o.from,s=Math.max(i.to,o.to);r<=t&&t--,e.splice(--r,2,i.anchor>i.head?Os.range(s,a):Os.range(a,s))}}return new Os(e,t)}function Ss(e,t){var n,r=_createForOfIteratorHelper(e.ranges);try{for(r.s();!(n=r.n()).done;){if(n.value.to>t)throw new RangeError("Selection points outside of document")}}catch(i){r.e(i)}finally{r.f()}}var As=0,Ps=function(){function e(t,n,r,i){_classCallCheck(this,e),this.combine=t,this.compareInput=n,this.compare=r,this.isStatic=i,this.id=As++,this.default=t([])}return _createClass(e,[{key:"of",value:function(e){return new Is([],this,0,e)}},{key:"compute",value:function(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new Is(e,this,1,t)}},{key:"computeN",value:function(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new Is(e,this,2,t)}},{key:"from",value:function(e,t){var n=this;return function(r){return Rs(t,n.compute([r],(function(t){return e(t.field(r))})))}}},{key:"nFrom",value:function(e,t){var n=this;return function(r){return Rs(t,n.computeN([r],(function(t){return e(t.field(r))})))}}}],[{key:"define",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new e(t.combine||function(e){return e},t.compareInput||function(e,t){return e===t},t.compare||(t.combine?function(e,t){return e===t}:Ts),!!t.static)}}]),e}();function Ts(e,t){return e==t||e.length==t.length&&e.every((function(e,n){return e===t[n]}))}var Is=function(){function e(t,n,r,i){_classCallCheck(this,e),this.dependencies=t,this.facet=n,this.type=r,this.value=i,this.id=As++}return _createClass(e,[{key:"dynamicSlot",value:function(e){var t,n=this.value,r=this.facet.compareInput,i=e[this.id]>>1,o=2==this.type,a=!1,s=!1,l=[],u=_createForOfIteratorHelper(this.dependencies);try{for(u.s();!(t=u.n()).done;){var c=t.value;"doc"==c?a=!0:"selection"==c?s=!0:0==(1&e[c.id])&&l.push(e[c.id])}}catch(h){u.e(h)}finally{u.f()}return function(e,t){if(!t||t.reconfigure)return e.values[i]=n(e),1;if(!(a&&t.docChanged||s&&(t.docChanged||t.selection)||l.some((function(t){return(1&Ls(e,t))>0}))))return 0;var u=n(e),c=t.startState.values[i];return(o?function(e,t,n){if(e.length!=t.length)return!1;for(var r=0;r<e.length;r++)if(!n(e[r],t[r]))return!1;return!0}(u,c,r):r(u,c))?0:(e.values[i]=u,1)}}}]),e}();function Es(e,t,n){var r=n.map((function(t){return e[t.id]})),i=n.map((function(e){return e.type})),o=r.filter((function(e){return!(1&e)})),a=e[t.id]>>1;return function(e,n){var s,l=n?n.reconfigure?n.startState.config.address[t.id]:a<<1:null,u=null==l,c=_createForOfIteratorHelper(o);try{for(c.s();!(s=c.n()).done;){1&Ls(e,s.value)&&(u=!0)}}catch(y){c.e(y)}finally{c.f()}if(!u)return 0;for(var h=[],f=0;f<r.length;f++){var d=Fs(e,r[f]);if(2==i[f]){var v,p=_createForOfIteratorHelper(d);try{for(p.s();!(v=p.n()).done;){var g=v.value;h.push(g)}}catch(y){p.e(y)}finally{p.f()}}else h.push(d)}var m=t.combine(h);return null!=l&&t.compare(m,Fs(n.startState,l))?0:(e.values[a]=m,1)}}var Ds=function(){function e(t,n,r,i,o){_classCallCheck(this,e),this.id=t,this.createF=n,this.updateF=r,this.compareF=i,this.facets=o}return _createClass(e,[{key:"slot",value:function(e){var t=this,n=e[this.id]>>1;return function(e,r){if(!r)return e.values[n]=t.createF(e),1;var i,o=0;if(r.reconfigure){var a=function(e,t){var n=e.config.address[t];return null==n?null:n>>1}(r.startState,t.id);i=null==a?t.createF(r.startState):r.startState.values[a],o=1}else i=r.startState.values[n];var s=t.updateF(i,r);return o||t.compareF(i,s)||(o=1),o&&(e.values[n]=s),o}}}],[{key:"define",value:function(t){var n=[],r=new e(As++,t.create,t.update,t.compare||function(e,t){return e===t},n);if(t.provide){var i,o=_createForOfIteratorHelper(t.provide);try{for(o.s();!(i=o.n()).done;){var a=i.value;n.push(a instanceof Ps?a.compute([r],(function(e){return e.field(r)})):a(r))}}catch(s){o.e(s)}finally{o.f()}}return r}}]),e}(),Ms={fallback:3,default:2,extend:1,override:0};function Qs(e,t){if(!Ms.hasOwnProperty(t))throw new RangeError("Invalid precedence: ".concat(t));return new Hs(e,Ms[t])}function Rs(e,t){return e?Qs(t,e):t}var Hs=function e(t,n){_classCallCheck(this,e),this.e=t,this.prec=n},Ns=function(){function e(t,n,r,i,o){for(_classCallCheck(this,e),this.source=t,this.replacements=n,this.dynamicSlots=r,this.address=i,this.staticValues=o,this.statusTemplate=[];this.statusTemplate.length<o.length;)this.statusTemplate.push(0)}return _createClass(e,[{key:"staticFacet",value:function(e){var t=this.address[e.id];return null==t?e.default:this.staticValues[t>>1]}}],[{key:"resolve",value:function(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object.create(null),i=arguments.length>2?arguments[2]:void 0,o=[],a=Object.create(null),s=_createForOfIteratorHelper(function(e,t){var n=[[],[],[],[]],r=new Map,i=Object.create(null);function o(e,a){var s=r.get(e);if(null!=s){if(s>=a)return;var l=n[s].indexOf(e);l>-1&&n[s].splice(l,1)}if(r.set(e,a),Array.isArray(e)){var u,c=_createForOfIteratorHelper(e);try{for(c.s();!(u=c.n()).done;){o(u.value,a)}}catch(h){c.e(h)}finally{c.f()}}else if(e instanceof function(){return function e(t,n){_classCallCheck(this,e),this.tag=t,this.extension=n}}()){if(e.tag in i)throw new RangeError("Duplicate use of tag '".concat(String(e.tag),"' in extensions"));i[e.tag]=!0,o(t[e.tag]||e.extension,a)}else e.extension?o(e.extension,a):e instanceof Hs?o(e.e,e.prec):(n[a].push(e),e instanceof Ds&&o(e.facets,a))}o(e,Ms.default);var a,s,l=_createForOfIteratorHelper((s=t,(Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(s):[]).concat(Object.keys(s))));try{for(l.s();!(a=l.n()).done;){var u=a.value;!(u in i)&&"full"!=u&&t[u]&&(i[u]=!0,o(t[u],Ms.default))}}catch(c){l.e(c)}finally{l.f()}return n.reduce((function(e,t){return e.concat(t)}))}(t,r));try{for(s.s();!(n=s.n()).done;){var l=n.value;l instanceof Ds?o.push(l):(a[l.facet.id]||(a[l.facet.id]=[])).push(l)}}catch(m){s.e(m)}finally{s.f()}for(var u=Object.create(null),c=[],h=[],f=function(){var e=v[d];u[e.id]=h.length<<1,h.push((function(t){return e.slot(t)}))},d=0,v=o;d<v.length;d++)f();var p=function(e){var t=a[e],n=t[0].facet;if(t.every((function(e){return 0==e.type}))){u[n.id]=c.length<<1|1;var r=n.combine(t.map((function(e){return e.value}))),o=i?i.config.address[n.id]:null;if(null!=o){var s=Fs(i,o);n.compare(r,s)&&(r=s)}c.push(r)}else{var l,f=_createForOfIteratorHelper(t);try{var d=function(){var e=l.value;0==e.type?(u[e.id]=c.length<<1|1,c.push(e.value)):(u[e.id]=h.length<<1,h.push((function(t){return e.dynamicSlot(t)})))};for(f.s();!(l=f.n()).done;)d()}catch(m){f.e(m)}finally{f.f()}u[n.id]=h.length<<1,h.push((function(e){return Es(e,n,t)}))}};for(var g in a)p(g);return new e(t,r,h.map((function(e){return e(u)})),u,c)}}]),e}();function Ls(e,t){if(1&t)return 2;var n=t>>1,r=e.status[n];if(4==r)throw new Error("Cyclic dependency between fields and/or facets");if(2&r)return r;e.status[n]=4;var i=e.config.dynamicSlots[n](e,e.applying);return e.status[n]=2|i}function Fs(e,t){return 1&t?e.config.staticValues[t>>1]:e.values[t>>1]}var $s=Ps.define({combine:function(e){return e.some((function(e){return e}))},static:!0}),Bs=Ps.define({combine:function(e){return e.length?e[0]:void 0},static:!0}),Vs=Ps.define(),zs=Ps.define(),js=new Ka,qs=Ps.define(),Ws=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,e),this.state=t,this.options=n}return _createClass(e,[{key:"textAfterPos",value:function(e){var t,n,r=null===(t=this.options)||void 0===t?void 0:t.simulateBreak;return e==r&&(null===(n=this.options)||void 0===n?void 0:n.simulateDoubleBreak)?"":this.state.sliceDoc(e,Math.min(e+100,null!=r&&r>e?r:1e9,this.state.doc.lineAt(e).to))}},{key:"countColumn",value:function(e,t){return Qa(t<0?e:e.slice(0,t),0,this.state.tabSize)}},{key:"lineIndent",value:function(e){var t,n=null===(t=this.options)||void 0===t?void 0:t.overrideIndentation;if(n){var r=n(e.from);if(r>-1)return r}var i=e.slice(0,Math.min(100,e.length));return this.countColumn(i,i.search(/\S/))}},{key:"column",value:function(e){var t,n=this.state.doc.lineAt(e),r=n.slice(0,e-n.from),i=this.countColumn(r,e-n.from),o=(null===(t=this.options)||void 0===t?void 0:t.overrideIndentation)?this.options.overrideIndentation(n.from):-1;return o>-1&&(i+=o-this.countColumn(r,r.search(/\S/))),i}},{key:"unit",get:function(){return this.state.indentUnit}}]),e}(),Us=function(){function e(t,n){_classCallCheck(this,e),this.type=t,this.value=n}return _createClass(e,null,[{key:"define",value:function(){return new Xs}}]),e}(),Xs=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"of",value:function(e){return new Us(this,e)}}]),e}(),Gs=function(){function e(t,n){_classCallCheck(this,e),this.type=t,this.value=n}return _createClass(e,[{key:"map",value:function(t){var n=this.type.map(this.value,t);return void 0===n?void 0:n==this.value?this:new e(this.type,n)}},{key:"is",value:function(e){return this.type==e}}],[{key:"define",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Zs(e.map||function(e){return e})}},{key:"mapEffects",value:function(e,t){if(!e.length)return e;var n,r=[],i=_createForOfIteratorHelper(e);try{for(i.s();!(n=i.n()).done;){var o=n.value.map(t);o&&r.push(o)}}catch(a){i.e(a)}finally{i.f()}return r}}]),e}(),Zs=function(){function e(t){_classCallCheck(this,e),this.map=t}return _createClass(e,[{key:"of",value:function(e){return new Gs(this,e)}}]),e}(),Ys=function(){function e(t,n,r,i,o,a,s){_classCallCheck(this,e),this.startState=t,this.changes=n,this.selection=r,this.effects=i,this.annotations=o,this.reconfigure=a,this.scrollIntoView=s,this._doc=null,this._state=null,r&&Ss(r,n.newLength),o.some((function(t){return t.type==e.time}))||(this.annotations=o.concat(e.time.of(Date.now())))}return _createClass(e,[{key:"annotation",value:function(e){var t,n=_createForOfIteratorHelper(this.annotations);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.type==e)return r.value}}catch(i){n.e(i)}finally{n.f()}}},{key:"newDoc",get:function(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}},{key:"newSelection",get:function(){return this.selection||this.startState.selection.map(this.changes)}},{key:"state",get:function(){return this._state||this.startState.applyTransaction(this),this._state}},{key:"docChanged",get:function(){return!this.changes.empty}}]),e}();function Ks(e,t){for(var n=[],r=0,i=0;;){var o=void 0,a=void 0;if(r<e.length&&(i==t.length||t[i]>=e[r]))o=e[r++],a=e[r++];else{if(!(i<t.length))return n;o=t[i++],a=t[i++]}!n.length||n[n.length-1]<o?n.push(o,a):n[n.length-1]<a&&(n[n.length-1]=a)}}function Js(e,t,n){var r,i,o,a;return n?(i=t.changes,o=gs.empty(t.changes.length),a=e.changes.compose(t.changes)):(i=t.changes.map(e.changes),o=e.changes.mapDesc(t.changes,!0),a=e.changes.compose(i)),{changes:a,selection:t.selection?t.selection.map(o):null===(r=e.selection)||void 0===r?void 0:r.map(i),effects:Gs.mapEffects(e.effects,i).concat(Gs.mapEffects(t.effects,o)),annotations:e.annotations.length?e.annotations.concat(t.annotations):t.annotations,scrollIntoView:e.scrollIntoView||t.scrollIntoView,reconfigure:t.reconfigure?t.reconfigure.full||!e.reconfigure?t.reconfigure:Object.assign({},e.reconfigure,t.reconfigure):e.reconfigure}}function el(e,t,n){var r=t.reconfigure;r&&r.append&&((r=Object.assign({},r))["undefined"==typeof Symbol?"__append"+Math.floor(4294967295*Math.random()):Symbol("appendConf")]=r.append,r.append=void 0);var i=t.selection;return{changes:t.changes instanceof gs?t.changes:gs.of(t.changes||[],n,e.facet(Bs)),selection:i&&(i instanceof Os?i:Os.single(i.anchor,i.head)),effects:t.effects?Array.isArray(t.effects)?t.effects:[t.effects]:nl,annotations:t.annotations?Array.isArray(t.annotations)?t.annotations:[t.annotations]:nl,scrollIntoView:!!t.scrollIntoView,reconfigure:r}}Ys.time=Us.define(),Ys.userEvent=Us.define(),Ys.addToHistory=Us.define();var tl,nl=[];!function(e){e[e.Word=0]="Word",e[e.Space=1]="Space",e[e.Other=2]="Other"}(tl||(tl={}));var rl,il=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;try{rl=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch(Cy){}var ol=function(){function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(_classCallCheck(this,e),this.config=t,this.doc=n,this.selection=r,this.applying=null,this.status=t.statusTemplate.slice(),i&&!i.reconfigure)this.values=i.startState.values.slice();else if(this.values=t.dynamicSlots.map((function(e){return null})),i)for(var o in t.address){var a=t.address[o],s=i.startState.config.address[o];null!=s&&0==(1&a)&&(this.values[a>>1]=Fs(i.startState,s))}this.applying=i,i&&(i._state=this);for(var l=0;l<this.config.dynamicSlots.length;l++)Ls(this,l<<1);this.applying=null}return _createClass(e,[{key:"field",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.config.address[e.id];if(null!=n)return Ls(this,n),Fs(this,n);if(t)throw new RangeError("Field is not present in this state")}},{key:"update",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function e(t,n,r){var i=el(t,n.length?n[0]:{},t.doc.length);n.length&&!1===n[0].filter&&(r=!1);for(var o=1;o<n.length;o++){!1===n[o].filter&&(r=!1);var a=!!n[o].sequential;i=Js(i,el(t,n[o],a?i.changes.newLength:t.doc.length),a)}var s=new Ys(t,i.changes,i.selection,i.effects,i.annotations,i.reconfigure,i.scrollIntoView);return r?function(t){var n,r=t.startState,i=!0,o=_createForOfIteratorHelper(r.facet(Vs));try{for(o.s();!(n=o.n()).done;){var a=(0,n.value)(t);if(!1===a){i=!1;break}Array.isArray(a)&&(i=!0===i?a:Ks(i,a))}}catch(d){o.e(d)}finally{o.f()}if(!0!==i){var s,l;if(!1===i)l=t.changes.invertedDesc,s=gs.empty(r.doc.length);else{var u=t.changes.filter(i);s=u.changes,l=u.filtered.invertedDesc}t=new Ys(r,s,t.selection&&t.selection.map(l),Gs.mapEffects(t.effects,l),t.annotations,t.reconfigure,t.scrollIntoView)}for(var c=r.facet(zs),h=c.length-1;h>=0;h--){var f=c[h](t);t=f instanceof Ys?f:Array.isArray(f)&&1==f.length&&f[0]instanceof Ys?f[0]:e(r,Array.isArray(f)?f:[f],!1)}return t}(s):s}(this,t,!0)}},{key:"applyTransaction",value:function(t){var n=this.config;t.reconfigure&&(n=Ns.resolve(t.reconfigure.full||n.source,Object.assign(n.replacements,t.reconfigure,{full:void 0}),this)),new e(n,t.newDoc,t.newSelection,t)}},{key:"replaceSelection",value:function(e){return"string"==typeof e&&(e=this.toText(e)),this.changeByRange((function(t){return{changes:{from:t.from,to:t.to,insert:e},range:Os.cursor(t.from+e.length)}}))}},{key:"changeByRange",value:function(e){for(var t=this.selection,n=e(t.ranges[0]),r=this.changes(n.changes),i=[n.range],o=1;o<t.ranges.length;o++){for(var a=e(t.ranges[o]),s=this.changes(a.changes),l=s.map(r),u=0;u<o;u++)i[u]=i[u].map(l);i.push(a.range.map(r.mapDesc(s,!0))),r=r.compose(l)}return{changes:r,selection:Os.create(i,t.primaryIndex)}}},{key:"changes",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t instanceof gs?t:gs.of(t,this.doc.length,this.facet(e.lineSeparator))}},{key:"toText",value:function(t){return Ha.of(t.split(this.facet(e.lineSeparator)||vs))}},{key:"sliceDoc",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.doc.length;return this.doc.sliceString(e,t,this.lineBreak)}},{key:"facet",value:function(e){var t=this.config.address[e.id];return null==t?e.default:(Ls(this,t),Fs(this,t))}},{key:"toJSON",value:function(){return{doc:this.sliceDoc(),selection:this.selection.toJSON()}}},{key:"indentString",value:function(t){var n="";if(9==this.facet(e.indentUnit).charCodeAt(0))for(;t>=this.tabSize;)n+="\t",t-=this.tabSize;for(var r=0;r<t;r++)n+=" ";return n}},{key:"phrase",value:function(t){var n,r=_createForOfIteratorHelper(this.facet(e.phrases));try{for(r.s();!(n=r.n()).done;){var i=n.value;if(Object.prototype.hasOwnProperty.call(i,t))return i[t]}}catch(o){r.e(o)}finally{r.f()}return t}},{key:"charCategorizer",value:function(e){return t=this.languageDataAt("wordChars",e).join(""),function(e){if(!/\S/.test(e))return tl.Space;if(function(e){if(rl)return rl.test(e);for(var t=0;t<e.length;t++){var n=e[t];if(/\w/.test(n)||n>"\x80"&&(n.toUpperCase()!=n.toLowerCase()||il.test(n)))return!0}return!1}(e))return tl.Word;for(var n=0;n<t.length;n++)if(e.indexOf(t[n])>-1)return tl.Word;return tl.Other};var t}},{key:"languageDataAt",value:function(t,n){for(var r=[],i=this.facet(e.syntax),o=i.length?0:1;o<2;o++){var a,s=_createForOfIteratorHelper(this.facet(o?qs:i[0].languageDataFacetAt(this,n)));try{for(s.s();!(a=s.n()).done;){var l=a.value;Object.prototype.hasOwnProperty.call(l,t)&&r.push(l[t])}}catch(u){s.e(u)}finally{s.f()}}return r}},{key:"tabSize",get:function(){return this.facet(e.tabSize)}},{key:"lineBreak",get:function(){return this.facet(e.lineSeparator)||"\n"}},{key:"indentUnit",get:function(){var t=this.facet(e.indentUnit);return 9==t.charCodeAt(0)?this.tabSize*t.length:t.length}},{key:"tree",get:function(){var t=this.facet(e.syntax);return t.length?t[0].getTree(this):rs.empty}}],[{key:"fromJSON",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t||"string"!=typeof t.doc)throw new RangeError("Invalid JSON representation for EditorState");return e.create({doc:t.doc,selection:Os.fromJSON(t.selection),extensions:n.extensions})}},{key:"create",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=Ns.resolve(t.extensions||[]),r=t.doc instanceof Ha?t.doc:Ha.of((t.doc||"").split(n.staticFacet(e.lineSeparator)||vs)),i=t.selection?t.selection instanceof Os?t.selection:Os.single(t.selection.anchor,t.selection.head):Os.single(0);return Ss(i,r.length),n.staticFacet($s)||(i=i.asSingle()),new e(n,r,i)}}]),e}();function al(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i={},o=_createForOfIteratorHelper(e);try{for(o.s();!(n=o.n()).done;)for(var a=n.value,s=0,l=Object.keys(a);s<l.length;s++){var u=l[s],c=a[u],h=i[u];if(void 0===h)i[u]=c;else if(h===c||void 0===c);else{if(!Object.hasOwnProperty.call(r,u))throw new Error("Config merge conflict for field "+u);i[u]=r[u](h,c)}}}catch(d){o.e(d)}finally{o.f()}for(var f in t)void 0===i[f]&&(i[f]=t[f]);return i}ol.allowMultipleSelections=$s,ol.indentation=Ps.define(),ol.tabSize=Ps.define({combine:function(e){return e.length?e[0]:4}}),ol.lineSeparator=Bs,ol.indentUnit=Ps.define({combine:function(e){if(!e.length)return"  ";if(!/^(?: +|\t+)$/.test(e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(e[0]));return e[0]}}),ol.phrases=Ps.define(),ol.syntax=Ps.define(),ol.globalLanguageData=qs,ol.foldable=Ps.define(),ol.changeFilter=Vs,ol.transactionFilter=zs;var sl="undefined"==typeof Symbol?"__\u037c":Symbol.for("\u037c"),ll="undefined"==typeof Symbol?"__styleSet"+Math.floor(1e8*Math.random()):Symbol("styleSet"),ul="undefined"==typeof global?window:global,cl=function(){function e(t,n){_classCallCheck(this,e),this.rules=[];var r=n||{},i=r.process,o=r.extend;function a(e){if(/^@/.test(e))return[e];var t=e.split(",");return i?t.map(i):t}function s(e,t,n){var r=[],i=/^@(\w+)\b/.exec(e[0]);if(i&&null==t)return n.push(e[0]+";");var l=function(l){if(/&/.test(l))s(e.map((function(e){return o?o(l,e):l.replace(/&/,e)})),t[l],n);else if("object"==typeof t[l]){if(!i)throw new RangeError("The value of a property ("+l+") should be a primitive value.");s("keyframes"==i[1]?[l]:a(l),t[l],r)}else r.push(l.replace(/_.*/,"").replace(/[A-Z]/g,(function(e){return"-"+e.toLowerCase()}))+": "+t[l]+";")};for(var u in t)l(u);(r.length||i&&"keyframes"==i[1])&&n.push(e.join(",")+" {"+r.join(" ")+"}")}for(var l in t)s(a(l),t[l],this.rules)}return _createClass(e,null,[{key:"newName",value:function(){var e=ul[sl]||1;return ul[sl]=e+1,"\u037c"+e.toString(36)}},{key:"mount",value:function(e,t){(e[ll]||new fl(e)).mount(Array.isArray(t)?t:[t])}}]),e}(),hl=null,fl=function(){function e(t){if(_classCallCheck(this,e),t.adoptedStyleSheets&&"undefined"!=typeof CSSStyleSheet){if(hl)return t.adoptedStyleSheets=[hl.sheet].concat(t.adoptedStyleSheets),t[ll]=hl;this.sheet=new CSSStyleSheet,t.adoptedStyleSheets=[this.sheet].concat(t.adoptedStyleSheets),hl=this}else{this.styleTag=(t.ownerDocument||t).createElement("style");var n=t.head||t;n.insertBefore(this.styleTag,n.firstChild)}this.modules=[],t[ll]=this}return _createClass(e,[{key:"mount",value:function(e){for(var t=this.sheet,n=0,r=0,i=0;i<e.length;i++){var o=e[i],a=this.modules.indexOf(o);if(a<r&&a>-1&&(this.modules.splice(a,1),r--,a=-1),-1==a){if(this.modules.splice(r++,0,o),t)for(var s=0;s<o.rules.length;s++)t.insertRule(o.rules[s],n++)}else{for(;r<a;)n+=this.modules[r++].rules.length;n+=o.rules.length,r++}}if(!t){for(var l="",u=0;u<this.modules.length;u++)l+=this.modules[u].rules.join("\n")+"\n";this.styleTag.textContent=l}}}]),e}(),dl=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"eq",value:function(e){return this==e}},{key:"range",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return new vl(e,t,this)}}]),e}();dl.prototype.startSide=dl.prototype.endSide=0,dl.prototype.point=!1,dl.prototype.mapMode=ds.TrackDel;var vl=function e(t,n,r){_classCallCheck(this,e),this.from=t,this.to=n,this.value=r};function pl(e,t){return e.from-t.from||e.value.startSide-t.value.startSide}var gl=1e9,ml=function(){function e(t,n,r,i){_classCallCheck(this,e),this.from=t,this.to=n,this.value=r,this.maxPoint=i}return _createClass(e,[{key:"findIndex",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t*gl,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(e<=0)return r;for(var i=t<0?this.to:this.from,o=r,a=i.length;;){if(o==a)return o;var s=o+a>>1,l=i[s]-e||(t<0?this.value[s].startSide:this.value[s].endSide)-n;if(s==o)return l>=0?o:a;l>=0?a=s:o=s+1}}},{key:"between",value:function(e,t,n,r){for(var i=this.findIndex(t,-1),o=this.findIndex(n,1,void 0,i);i<o;i++)if(!1===r(this.from[i]+e,this.to[i]+e,this.value[i]))return!1}},{key:"map",value:function(t,n){for(var r=[],i=[],o=[],a=-1,s=-1,l=0;l<this.value.length;l++){var u=void 0,c=void 0,h=this.value[l],f=this.from[l]+t,d=this.to[l]+t;if(f==d){var v=n.mapPos(f,h.startSide,h.mapMode);if(v<0)continue;u=c=v}else if((u=n.mapPos(f,h.startSide))>(c=n.mapPos(d,h.endSide))||u==c&&h.startSide>0&&h.endSide<=0)continue;(c-u||h.endSide-h.startSide)<0||(a<0&&(a=u),h.point&&(s=Math.max(s,c-u)),r.push(h),i.push(u-a),o.push(c-a))}return{mapped:r.length?new e(i,o,r,s):null,pos:a}}},{key:"length",get:function(){return this.to[this.to.length-1]}}]),e}(),yl=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.empty,i=arguments.length>3?arguments[3]:void 0;_classCallCheck(this,e),this.chunkPos=t,this.chunk=n,this.nextLayer=r,this.maxPoint=i}return _createClass(e,[{key:"chunkEnd",value:function(e){return this.chunkPos[e]+this.chunk[e].length}},{key:"update",value:function(t){var n=t.add,r=void 0===n?[]:n,i=t.sort,o=void 0!==i&&i,a=t.filter,s=t.filterFrom,l=void 0===s?0:s,u=t.filterTo,c=void 0===u?this.length:u;if(0==r.length&&!a)return this;if(o&&r.slice().sort(pl),this==e.empty)return r.length?e.of(r):this;for(var h=new bl(this,null,-1).goto(0),f=0,d=[],v=new kl;h.value||f<r.length;)if(f<r.length&&(h.from-r[f].from||h.startSide-r[f].value.startSide)>=0){var p=r[f++];v.addInner(p.from,p.to,p.value)||d.push(p)}else 1==h.rangeIndex&&h.chunkIndex<this.chunk.length&&(f==r.length||this.chunkEnd(h.chunkIndex)<r[f].from)&&(!a||l>this.chunkEnd(h.chunkIndex)||c<this.chunkPos[h.chunkIndex])&&v.addChunk(this.chunkPos[h.chunkIndex],this.chunk[h.chunkIndex])?h.nextChunk():((!a||l>h.to||c<h.from||a(h.from,h.to,h.value))&&(v.addInner(h.from,h.to,h.value)||d.push(new vl(h.from,h.to,h.value))),h.next());return v.finishInner(this.nextLayer!=e.empty||d.length?this.nextLayer.update({add:d,filter:a,filterFrom:l,filterTo:c}):e.empty)}},{key:"map",value:function(t){if(0==t.length||this==e.empty)return this;for(var n=[],r=[],i=-1,o=0;o<this.chunk.length;o++){var a=this.chunkPos[o],s=this.chunk[o],l=t.touchesRange(a,a+s.length);if(!1===l)i=Math.max(i,s.maxPoint),n.push(s),r.push(t.mapPos(a));else if(!0===l){var u=s.map(a,t),c=u.mapped,h=u.pos;c&&(i=Math.max(i,c.maxPoint),n.push(c),r.push(h))}}var f=this.nextLayer.map(t);return 0==n.length?f:new e(r,n,f,i)}},{key:"between",value:function(t,n,r){if(this!=e.empty){for(var i=0;i<this.chunk.length;i++){var o=this.chunkPos[i],a=this.chunk[i];if(n>=o&&t<=o+a.length&&!1===a.between(o,t-o,n-o,r))return}this.nextLayer.between(t,n,r)}}},{key:"iter",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return wl.from([this]).goto(e)}},{key:"length",get:function(){var e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}},{key:"size",get:function(){if(this==e.empty)return 0;var t,n=this.nextLayer.size,r=_createForOfIteratorHelper(this.chunk);try{for(r.s();!(t=r.n()).done;){n+=t.value.value.length}}catch(i){r.e(i)}finally{r.f()}return n}}],[{key:"iter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return wl.from(e).goto(t)}},{key:"compare",value:function(t,n,r,i){var o,a=null!==(o=i.minPointSize)&&void 0!==o?o:-1,s=t.filter((function(t){return t.maxPoint>=500||t!=e.empty&&n.indexOf(t)<0&&t.maxPoint>=a})),l=n.filter((function(n){return n.maxPoint>=500||n!=e.empty&&t.indexOf(n)<0&&n.maxPoint>=a})),u=function(e,t){var n,r=new Map,i=_createForOfIteratorHelper(e);try{for(i.s();!(n=i.n()).done;)for(var o=n.value,a=0;a<o.chunk.length;a++)o.chunk[a].maxPoint<500&&r.set(o.chunk[a],o.chunkPos[a])}catch(f){i.e(f)}finally{i.f()}var s,l=new Set,u=_createForOfIteratorHelper(t);try{for(u.s();!(s=u.n()).done;)for(var c=s.value,h=0;h<c.chunk.length;h++)r.get(c.chunk[h])==c.chunkPos[h]&&l.add(c.chunk[h])}catch(f){u.e(f)}finally{u.f()}return l}(s,l),c=new Cl(s,u,a),h=new Cl(l,u,a);r.iterGaps((function(e,t,n){return Ol(c,e,h,t,n,i)})),r.empty&&0==r.length&&Ol(c,0,h,0,0,i)}},{key:"spans",value:function(e,t,n,r){for(var i,o=new Cl(e,null,null!==(i=r.minPointSize)&&void 0!==i?i:-1).goto(t),a=t,s=o.openStart;;){var l=Math.min(o.to,n);if(o.point?(r.point(a,l,o.point,o.activeForPoint(o.to),s),s=o.openEnd(l)+(o.to>l?1:0)):l>a&&(r.span(a,l,o.active,s),s=o.openEnd(l)),o.to>n)break;a=o.to,o.next()}return s}},{key:"of",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=new kl,i=_createForOfIteratorHelper(e instanceof vl?[e]:n?e.slice().sort(pl):e);try{for(i.s();!(t=i.n()).done;){var o=t.value;r.add(o.from,o.to,o.value)}}catch(a){i.e(a)}finally{i.f()}return r.finish()}}]),e}();yl.empty=new yl([],[],null,-1),yl.empty.nextLayer=yl.empty;var kl=function(){function e(){_classCallCheck(this,e),this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-gl,this.lastTo=-gl,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}return _createClass(e,[{key:"finishChunk",value:function(e){this.chunks.push(new ml(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}},{key:"add",value:function(t,n,r){this.addInner(t,n,r)||(this.nextLayer||(this.nextLayer=new e)).add(t,n,r)}},{key:"addInner",value:function(e,t,n){var r=e-this.lastTo||n.startSide-this.last.endSide;if(r<=0&&(e-this.lastFrom||n.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return!(r<0||(250==this.from.length&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(t-this.chunkStart),this.last=n,this.lastFrom=e,this.lastTo=t,this.value.push(n),n.point&&(this.maxPoint=Math.max(this.maxPoint,t-e)),0))}},{key:"addChunk",value:function(e,t){if((e-this.lastTo||t.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,t.maxPoint),this.chunks.push(t),this.chunkPos.push(e);var n=t.value.length-1;return this.last=t.value[n],this.lastFrom=t.from[n]+e,this.lastTo=t.to[n]+e,!0}},{key:"finish",value:function(){return this.finishInner(yl.empty)}},{key:"finishInner",value:function(e){if(this.from.length&&this.finishChunk(!1),0==this.chunks.length)return e;var t=new yl(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,t}}]),e}(),bl=function(){function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;_classCallCheck(this,e),this.layer=t,this.skip=n,this.minPoint=r,this.rank=i}return _createClass(e,[{key:"goto",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-gl;return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,t,!1),this}},{key:"gotoInner",value:function(e,t,n){for(;this.chunkIndex<this.layer.chunk.length;){var r=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(r)||this.layer.chunkEnd(this.chunkIndex)<e||r.maxPoint<this.minPoint))break;this.chunkIndex++,n=!1}var i=this.chunkIndex==this.layer.chunk.length?0:this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],-1,t);(!n||this.rangeIndex<i)&&(this.rangeIndex=i),this.next()}},{key:"forward",value:function(e,t){(this.to-e||this.endSide-t)<0&&this.gotoInner(e,t,!0)}},{key:"next",value:function(){for(;;){if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=gl,this.value=null;break}var e=this.layer.chunkPos[this.chunkIndex],t=this.layer.chunk[this.chunkIndex];if(this.from=e+t.from[this.rangeIndex],this.to=e+t.to[this.rangeIndex],this.value=t.value[this.rangeIndex],++this.rangeIndex==t.value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}if(this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}},{key:"nextChunk",value:function(){this.chunkIndex++,this.rangeIndex=0,this.next()}},{key:"compare",value:function(e){return this.from-e.from||this.startSide-e.startSide||this.to-e.to||this.endSide-e.endSide}},{key:"startSide",get:function(){return this.value?this.value.startSide:0}},{key:"endSide",get:function(){return this.value?this.value.endSide:0}}]),e}(),wl=function(){function e(t){_classCallCheck(this,e),this.heap=t}return _createClass(e,[{key:"goto",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-gl,r=_createForOfIteratorHelper(this.heap);try{for(r.s();!(t=r.n()).done;){var i=t.value;i.goto(e,n)}}catch(a){r.e(a)}finally{r.f()}for(var o=this.heap.length>>1;o>=0;o--)_l(this.heap,o);return this.next(),this}},{key:"forward",value:function(e,t){var n,r=_createForOfIteratorHelper(this.heap);try{for(r.s();!(n=r.n()).done;){n.value.forward(e,t)}}catch(o){r.e(o)}finally{r.f()}for(var i=this.heap.length>>1;i>=0;i--)_l(this.heap,i);(this.to-e||this.value.endSide-t)<0&&this.next()}},{key:"next",value:function(){if(0==this.heap.length)this.from=this.to=gl,this.value=null,this.rank=-1;else{var e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),_l(this.heap,0)}}},{key:"startSide",get:function(){return this.value?this.value.startSide:0}}],[{key:"from",value:function(t){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,i=[],o=0;o<t.length;o++)for(var a=t[o];a!=yl.empty;a=a.nextLayer)a.maxPoint>=r&&i.push(new bl(a,n,r,o));return 1==i.length?i[0]:new e(i)}}]),e}();function _l(e,t){for(var n=e[t];;){var r=1+(t<<1);if(r>=e.length)break;var i=e[r];if(r+1<e.length&&i.compare(e[r+1])>=0&&(i=e[r+1],r++),n.compare(i)<0)break;e[r]=n,e[t]=i,t=r}}var Cl=function(){function e(t,n,r){_classCallCheck(this,e),this.minPoint=r,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-gl,this.endSide=0,this.openStart=-1,this.cursor=wl.from(t,n,r)}return _createClass(e,[{key:"goto",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-gl;return this.cursor.goto(e,t),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=t,this.openStart=-1,this.next(),this}},{key:"forward",value:function(e,t){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-t)<0;)this.removeActive(this.minActive);this.cursor.forward(e,t)}},{key:"removeActive",value:function(e){Sl(this.active,e),Sl(this.activeTo,e),Sl(this.activeRank,e),this.minActive=Pl(this.active,this.activeTo)}},{key:"addActive",value:function(e){for(var t=0,n=this.cursor,r=n.value,i=n.to,o=n.rank;t<this.activeRank.length&&this.activeRank[t]<=o;)t++;Al(this.active,t,r),Al(this.activeTo,t,i),Al(this.activeRank,t,o),e&&Al(e,t,this.cursor.from),this.minActive=Pl(this.active,this.activeTo)}},{key:"next",value:function(){var e=this.to;this.point=null;for(var t=this.openStart<0?[]:null,n=0;;){var r=this.minActive;if(r>-1&&(this.activeTo[r]-this.cursor.from||this.active[r].endSide-this.cursor.startSide)<0){if(this.activeTo[r]>e){this.to=this.activeTo[r],this.endSide=this.active[r].endSide;break}this.removeActive(r),t&&Sl(t,r)}else{if(!this.cursor.value){this.to=this.endSide=gl;break}if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}var i=this.cursor.value;if(i.point){this.point=i,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=i.endSide,this.cursor.from<e&&(n=1),this.cursor.next(),this.to>e&&this.forward(this.to,this.endSide);break}this.addActive(t),this.cursor.next()}}if(t){for(var o=0;o<t.length&&t[o]<e;)o++;this.openStart=o+n}}},{key:"activeForPoint",value:function(e){if(!this.active.length)return this.active;for(var t=[],n=0;n<this.active.length&&!(this.activeRank[n]>this.pointRank);n++)(this.activeTo[n]>e||this.activeTo[n]==e&&this.active[n].endSide>this.point.endSide)&&t.push(this.active[n]);return t}},{key:"openEnd",value:function(e){for(var t=0;t<this.activeTo.length&&this.activeTo[t]>e;)t++;return t}}]),e}();function Ol(e,t,n,r,i,o){e.goto(t),n.goto(r);for(var a=r+i,s=r,l=r-t;;){var u=e.to+l-n.to||e.endSide-n.endSide,c=u<0?e.to+l:n.to,h=Math.min(c,a);if(e.point||n.point?e.point&&n.point&&(e.point==n.point||e.point.eq(n.point))||o.comparePoint(s,h,e.point,n.point):h>s&&!xl(e.active,n.active)&&o.compareRange(s,h,e.active,n.active),c>a)break;s=c,u<=0&&e.next(),u>=0&&n.next()}}function xl(e,t){if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!=t[n]&&!e[n].eq(t[n]))return!1;return!0}function Sl(e,t){for(var n=t,r=e.length-1;n<r;n++)e[n]=e[n+1];e.pop()}function Al(e,t,n){for(var r=e.length-1;r>=t;r--)e[r+1]=e[r];e[t]=n}function Pl(e,t){for(var n=-1,r=gl,i=0;i<t.length;i++)(t[i]-r||e[i].endSide-e[n].endSide)<0&&(n=i,r=t[i]);return n}for(var Tl={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",229:"q"},Il={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"',229:"Q"},El="undefined"!=typeof navigator&&/Chrome\/(\d+)/.exec(navigator.userAgent),Dl="undefined"!=typeof navigator&&/Apple Computer/.test(navigator.vendor),Ml="undefined"!=typeof navigator&&/Gecko\/\d+/.test(navigator.userAgent),Ql="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),Rl="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),Hl=El&&(Ql||+El[1]<57)||Ml&&Ql,Nl=0;Nl<10;Nl++)Tl[48+Nl]=Tl[96+Nl]=String(Nl);for(Nl=1;Nl<=24;Nl++)Tl[Nl+111]="F"+Nl;for(Nl=65;Nl<=90;Nl++)Tl[Nl]=String.fromCharCode(Nl+32),Il[Nl]=String.fromCharCode(Nl);for(var Ll in Tl)Il.hasOwnProperty(Ll)||(Il[Ll]=Tl[Ll]);var Fl=_slicedToArray("undefined"!=typeof navigator?[navigator,document]:[{userAgent:"",vendor:"",platform:""},{documentElement:{style:{}}}],2),$l=Fl[0],Bl=Fl[1],Vl=/Edge\/(\d+)/.exec($l.userAgent),zl=/MSIE \d/.test($l.userAgent),jl=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec($l.userAgent),ql=!!(zl||jl||Vl),Wl=!ql&&/gecko\/(\d+)/i.test($l.userAgent),Ul=!ql&&/Chrome\/(\d+)/.exec($l.userAgent),Xl="webkitFontSmoothing"in Bl.documentElement.style,Gl={mac:/Mac/.test($l.platform),ie:ql,ie_version:zl?Bl.documentMode||6:jl?+jl[1]:Vl?+Vl[1]:0,gecko:Wl,gecko_version:Wl?+(/Firefox\/(\d+)/.exec($l.userAgent)||[0,0])[1]:0,chrome:!!Ul,chrome_version:Ul?+Ul[1]:0,ios:!ql&&/AppleWebKit/.test($l.userAgent)&&/Mobile\/\w+/.test($l.userAgent),android:/Android\b/.test($l.userAgent),webkit:Xl,safari:/Apple Computer/.test($l.vendor),webkit_version:Xl?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:null!=Bl.documentElement.style.tabSize?"tab-size":"-moz-tab-size"};function Zl(e){return e.getSelection?e.getSelection():document.getSelection()}function Yl(e,t){if(!t.anchorNode)return!1;try{return e.contains(3==t.anchorNode.nodeType?t.anchorNode.parentNode:t.anchorNode)}catch(Cy){return!1}}function Kl(e){if(3==e.nodeType){var t=uu();return t.setEnd(e,e.nodeValue.length),t.setStart(e,0),t.getClientRects()}return 1==e.nodeType?e.getClientRects():[]}function Jl(e,t,n,r){return!!n&&(tu(e,t,n,r,-1)||tu(e,t,n,r,1))}function eu(e){for(var t=0;;t++)if(!(e=e.previousSibling))return t}function tu(e,t,n,r,i){for(;;){if(e==n&&t==r)return!0;if(t==(i<0?0:nu(e))){if("DIV"==e.nodeName)return!1;var o=e.parentNode;if(!o||1!=o.nodeType)return!1;t=eu(e)+(i<0?0:1),e=o}else{if(1!=e.nodeType)return!1;e=e.childNodes[t+(i<0?-1:0)],t=i<0?nu(e):0}}}function nu(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function ru(e,t){var n=t?e.left:e.right;return{left:n,right:n,top:e.top,bottom:e.bottom}}function iu(e){return{left:0,right:e.innerWidth,top:0,bottom:e.innerHeight}}var ou,au=function(){function e(){_classCallCheck(this,e),this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}return _createClass(e,[{key:"eq",value:function(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}},{key:"set",value:function(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}}]),e}(),su=null;function lu(e){if(e.setActive)return e.setActive();if(su)return e.focus(su);for(var t=[],n=e;n&&(t.push(n,n.scrollTop,n.scrollLeft),n!=n.ownerDocument);n=n.parentNode);if(e.focus(null==su?{get preventScroll(){return su={preventScroll:!0},!0}}:void 0),!su){su=!1;for(var r=0;r<t.length;){var i=t[r++],o=t[r++],a=t[r++];i.scrollTop!=o&&(i.scrollTop=o),i.scrollLeft!=a&&(i.scrollLeft=a)}}}function uu(){return ou||(ou=document.createRange())}var cu=function(){function e(t,n){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];_classCallCheck(this,e),this.node=t,this.offset=n,this.precise=r}return _createClass(e,null,[{key:"before",value:function(t,n){return new e(t.parentNode,eu(t),n)}},{key:"after",value:function(t,n){return new e(t.parentNode,eu(t)+1,n)}}]),e}(),hu=[],fu=function(){function e(){_classCallCheck(this,e),this.parent=null,this.dom=null,this.dirty=2}return _createClass(e,[{key:"posBefore",value:function(e){var t,n=this.posAtStart,r=_createForOfIteratorHelper(this.children);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(i==e)return n;n+=i.length+i.breakAfter}}catch(o){r.e(o)}finally{r.f()}throw new RangeError("Invalid child in posBefore")}},{key:"posAfter",value:function(e){return this.posBefore(e)+e.length}},{key:"coordsAt",value:function(e,t){return null}},{key:"sync",value:function(t){if(2&this.dirty){var n,r=this.dom,i=null,o=_createForOfIteratorHelper(this.children);try{for(o.s();!(n=o.n()).done;){var a=n.value;if(a.dirty){var s=i?i.nextSibling:r.firstChild;!s||a.dom||e.get(s)||a.reuseDOM(s),a.sync(t),a.dirty=0}t&&t.node==r&&i!=a.dom&&(t.written=!0),vu(r,i,a.dom),i=a.dom}}catch(f){o.e(f)}finally{o.f()}var l=i?i.nextSibling:r.firstChild;for(l&&t&&t.node==r&&(t.written=!0);l;)l=du(l)}else if(1&this.dirty){var u,c=_createForOfIteratorHelper(this.children);try{for(c.s();!(u=c.n()).done;){var h=u.value;h.dirty&&(h.sync(t),h.dirty=0)}}catch(f){c.e(f)}finally{c.f()}}}},{key:"reuseDOM",value:function(e){return!1}},{key:"localPosFromDOM",value:function(t,n){var r;if(t==this.dom)r=this.dom.childNodes[n];else{for(var i=0==nu(t)?0:0==n?-1:1;;){var o=t.parentNode;if(o==this.dom)break;0==i&&o.firstChild!=o.lastChild&&(i=t==o.firstChild?-1:1),t=o}r=i<0?t:t.nextSibling}if(r==this.dom.firstChild)return 0;for(;r&&!e.get(r);)r=r.nextSibling;if(!r)return this.length;for(var a=0,s=0;;a++){var l=this.children[a];if(l.dom==r)return s;s+=l.length+l.breakAfter}}},{key:"domBoundsAround",value:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=-1,i=-1,o=-1,a=-1,s=0,l=n;s<this.children.length;s++){var u=this.children[s],c=l+u.length;if(l<e&&c>t)return u.domBoundsAround(e,t,l);if(c>=e&&-1==r&&(r=s,i=l),c>=t&&-1==o){o=s,a=c;break}l=c+u.breakAfter}return{from:i,to:a,startDOM:(r?this.children[r-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:o<this.children.length-1?this.children[o+1].dom:null}}},{key:"markDirty",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];2&this.dirty||(this.dirty|=2,this.markParentsDirty(e))}},{key:"markParentsDirty",value:function(e){for(var t=this.parent;t;t=t.parent){if(e&&(t.dirty|=2),1&t.dirty)return;t.dirty|=1,e=!1}}},{key:"setParent",value:function(e){this.parent!=e&&(this.parent=e,this.dirty&&this.markParentsDirty(!0))}},{key:"setDOM",value:function(e){this.dom=e,e.cmView=this}},{key:"replaceChildren",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:hu;this.markDirty();for(var i=e;i<t;i++)this.children[i].parent=null;(n=this.children).splice.apply(n,[e,t-e].concat(_toConsumableArray(r)));for(var o=0;o<r.length;o++)r[o].setParent(this)}},{key:"ignoreMutation",value:function(e){return!1}},{key:"ignoreEvent",value:function(e){return!1}},{key:"childCursor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.length;return new pu(this.children,e,this.children.length)}},{key:"childPos",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this.childCursor().findPos(e,t)}},{key:"toString",value:function(){var e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+("Text"==e?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}},{key:"editorView",get:function(){if(!this.parent)throw new Error("Accessing view in orphan content view");return this.parent.editorView}},{key:"overrideDOMText",get:function(){return null}},{key:"posAtStart",get:function(){return this.parent?this.parent.posBefore(this):0}},{key:"posAtEnd",get:function(){return this.posAtStart+this.length}},{key:"rootView",get:function(){for(var e=this;;){var t=e.parent;if(!t)return e;e=t}}}],[{key:"get",value:function(e){return e.cmView}}]),e}();function du(e){var t=e.nextSibling;return e.parentNode.removeChild(e),t}function vu(e,t,n){var r=t?t.nextSibling:e.firstChild;if(n.parentNode==e)for(;r!=n;)r=du(r);else e.insertBefore(n,r)}fu.prototype.breakAfter=0;var pu=function(){function e(t,n,r){_classCallCheck(this,e),this.children=t,this.pos=n,this.i=r,this.off=0}return _createClass(e,[{key:"findPos",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;;){if(e>this.pos||e==this.pos&&(t>0||0==this.i||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;var n=this.children[--this.i];this.pos-=n.length+n.breakAfter}}}]),e}(),gu=[],mu=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"become",value:function(e){return!1}},{key:"getSide",value:function(){return 0}}]),n}(fu);mu.prototype.children=gu;var yu=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this)).text=e,r}return _createClass(n,[{key:"createDOM",value:function(e){this.setDOM(e||document.createTextNode(this.text))}},{key:"sync",value:function(e){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(e&&e.node==this.dom&&(e.written=!0),this.dom.nodeValue=this.text)}},{key:"reuseDOM",value:function(e){return 3==e.nodeType&&(this.createDOM(e),!0)}},{key:"merge",value:function(e,t,r){return(!r||r instanceof n&&!(this.length-(t-e)+r.length>256))&&(this.text=this.text.slice(0,e)+(r?r.text:"")+this.text.slice(t),this.markDirty(),!0)}},{key:"slice",value:function(e){return new n(this.text.slice(e))}},{key:"localPosFromDOM",value:function(e,t){return e==this.dom?t:t?this.text.length:0}},{key:"domAtPos",value:function(e){return new cu(this.dom,e)}},{key:"domBoundsAround",value:function(e,t,n){return{from:n,to:n+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}},{key:"coordsAt",value:function(e,t){return bu(this.dom,e,t,this.length)}},{key:"length",get:function(){return this.text.length}}]),n}(mu),ku=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;_classCallCheck(this,n),(r=t.call(this)).mark=e,r.children=i,r.length=o;var a,s=_createForOfIteratorHelper(i);try{for(s.s();!(a=s.n()).done;){var l=a.value;l.setParent(_assertThisInitialized(r))}}catch(u){s.e(u)}finally{s.f()}return r}return _createClass(n,[{key:"createDOM",value:function(){var e=document.createElement(this.mark.tagName);if(this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(var t in this.mark.attrs)e.setAttribute(t,this.mark.attrs[t]);this.setDOM(e)}},{key:"sync",value:function(e){this.dom||this.createDOM(),_get(_getPrototypeOf(n.prototype),"sync",this).call(this,e)}},{key:"merge",value:function(e,t,r,i,o){return!(r&&(!(r instanceof n&&r.mark.eq(this.mark))||e&&i<=0||t<this.length&&o<=0)||(Cu(this,e,t,r?r.children:gu,i-1,o-1),this.markDirty(),0))}},{key:"slice",value:function(e){return new n(this.mark,function(e,t){var n,r=[],i=0,o=_createForOfIteratorHelper(e);try{for(o.s();!(n=o.n()).done;){var a=n.value,s=i+a.length;s>t&&r.push(i<t?a.slice(t-i):a),i=s}}catch(l){o.e(l)}finally{o.f()}return r}(this.children,e),this.length-e)}},{key:"domAtPos",value:function(e){return Ou(this.dom,this.children,e)}},{key:"coordsAt",value:function(e,t){return xu(this,e,t)}}]),n}(mu);function bu(e,t,n,r){var i=t,o=t,a=0;0==t&&n<0||t==r&&n>=0?Gl.chrome||Gl.gecko||(t?(i--,a=1):(o++,a=-1)):n<0?i--:o++;var s=uu();s.setEnd(e,o),s.setStart(e,i);var l=s.getBoundingClientRect();return a?ru(l,a<0):l}var wu=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,i){var o;return _classCallCheck(this,n),(o=t.call(this)).widget=e,o.length=r,o.side=i,o}return _createClass(n,[{key:"slice",value:function(e){return n.create(this.widget,this.length-e,this.side)}},{key:"sync",value:function(){this.dom&&this.widget.updateDOM(this.dom)||(this.setDOM(this.widget.toDOM(this.editorView)),this.dom.contentEditable="false")}},{key:"getSide",value:function(){return this.side}},{key:"merge",value:function(e,t,r,i,o){return!(r&&(!(r instanceof n&&this.widget.compare(r.widget))||e>0&&i<=0||t<this.length&&o<=0)||(this.length=e+(r?r.length:0)+(this.length-t),0))}},{key:"become",value:function(e){return e.length==this.length&&e instanceof n&&e.side==this.side&&this.widget.constructor==e.widget.constructor&&(this.widget.eq(e.widget)||this.markDirty(!0),this.widget=e.widget,!0)}},{key:"ignoreMutation",value:function(){return!0}},{key:"ignoreEvent",value:function(e){return this.widget.ignoreEvent(e)}},{key:"domAtPos",value:function(e){return 0==e?cu.before(this.dom):cu.after(this.dom,e==this.length)}},{key:"domBoundsAround",value:function(){return null}},{key:"coordsAt",value:function(e,t){for(var n=this.dom.getClientRects(),r=null,i=e>0?n.length-1:0;r=n[i],!(e>0?0==i:i==n.length-1||r.top<r.bottom);i+=e>0?-1:1);return r}},{key:"overrideDOMText",get:function(){if(0==this.length)return Ha.empty;for(var e=this;e.parent;)e=e.parent;var t=e.editorView,n=t&&t.state.doc,r=this.posAtStart;return n?n.slice(r,r+this.length):Ha.empty}}],[{key:"create",value:function(e,t,r){return new(e.customView||n)(e,t,r)}}]),n}(mu),_u=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"domAtPos",value:function(e){return new cu(this.widget.text,e)}},{key:"sync",value:function(){this.dom||this.setDOM(this.widget.toDOM())}},{key:"localPosFromDOM",value:function(e,t){return t?3==e.nodeType?Math.min(t,this.length):this.length:0}},{key:"ignoreMutation",value:function(){return!1}},{key:"coordsAt",value:function(e,t){return bu(this.widget.text,e,t,this.length)}},{key:"overrideDOMText",get:function(){return null}}]),n}(wu);function Cu(e,t,n,r,i,o){var a,s=e.childCursor(),l=s.findPos(n,1),u=l.i,c=l.off,h=s.findPos(t,-1),f=h.i,d=h.off,v=t-n,p=_createForOfIteratorHelper(r);try{for(p.s();!(a=p.n()).done;){v+=a.value.length}}catch(_){p.e(_)}finally{p.f()}e.length+=v;var g=e.children;if(f==u&&d){var m=g[f];if(1==r.length&&m.merge(d,c,r[0],i,o))return;if(0==r.length)return void m.merge(d,c,null,i,o);var y=m.slice(c);y.merge(0,0,r[r.length-1],0,o)?r[r.length-1]=y:r.push(y),u++,o=c=0}if(c){var k=g[u];r.length&&k.merge(0,c,r[r.length-1],0,o)?(r.pop(),o=0):k.merge(0,c,null,0,0)}else u<g.length&&r.length&&g[u].merge(0,0,r[r.length-1],0,o)&&(r.pop(),o=0);if(d){var b=g[f];r.length&&b.merge(d,b.length,r[0],i,0)?(r.shift(),i=0):b.merge(d,b.length,null,0,0),f++}else if(f&&r.length){var w=g[f-1];w.merge(w.length,w.length,r[0],i,0)&&(r.shift(),i=0)}for(;f<u&&r.length&&g[u-1].become(r[r.length-1]);)r.pop(),u--,o=0;for(;f<u&&r.length&&g[f].become(r[0]);)r.shift(),f++,i=0;!r.length&&f&&u<g.length&&i&&o&&g[u].merge(0,0,g[f-1],i,o)&&f--,(r.length||f!=u)&&e.replaceChildren(f,u,r)}function Ou(e,t,n){for(var r=0,i=0;r<t.length;r++){var o=t[r],a=i+o.length;if(!(a==i&&o.getSide()<=0)){if(n>i&&n<a&&o.dom.parentNode==e)return o.domAtPos(n-i);if(n<=i)break;i=a}}for(;r>0;r--){var s=t[r-1].dom;if(s.parentNode==e)return cu.after(s)}return new cu(e,0)}function xu(e,t,n){for(var r=0,i=0;i<e.children.length;i++){var o=e.children[i],a=r+o.length;if(!(a==r&&o.getSide()<=0)){if(n<=0||a==e.length?a>=t:a>t)return o.coordsAt(t-r,n);r=a}}return(e.dom.lastChild||e.dom).getBoundingClientRect()}function Su(e,t){for(var n in e)"class"==n&&t.class?t.class+=" "+e.class:"style"==n&&t.style?t.style+=";"+e.style:t[n]=e[n];return t}function Au(e,t){if(e==t)return!0;if(!e||!t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!=r.length)return!1;for(var i=0,o=n;i<o.length;i++){var a=o[i];if(-1==r.indexOf(a)||e[a]!==t[a])return!1}return!0}function Pu(e,t,n){if(t)for(var r in t)n&&r in n||e.removeAttribute(r);if(n)for(var i in n)t&&t[i]==n[i]||e.setAttribute(i,n[i])}var Tu,Iu=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"eq",value:function(e){return!1}},{key:"updateDOM",value:function(e){return!1}},{key:"compare",value:function(e){return this==e||this.constructor==e.constructor&&this.eq(e)}},{key:"ignoreEvent",value:function(e){return!0}},{key:"estimatedHeight",get:function(){return-1}},{key:"customView",get:function(){return null}}]),e}();!function(e){e[e.Text=0]="Text",e[e.WidgetBefore=1]="WidgetBefore",e[e.WidgetAfter=2]="WidgetAfter",e[e.WidgetRange=3]="WidgetRange"}(Tu||(Tu={}));var Eu=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,i,o){var a;return _classCallCheck(this,n),(a=t.call(this)).startSide=e,a.endSide=r,a.widget=i,a.spec=o,a}return _createClass(n,[{key:"hasHeight",value:function(){return!!this.widget&&this.widget.estimatedHeight>-1}},{key:"heightRelevant",get:function(){return!1}}],[{key:"mark",value:function(e){return new Du(e)}},{key:"widget",value:function(e){var t=e.side||0;return e.block&&(t+=200000001*(t>0?1:-1)),new Qu(e,t,t,!!e.block,e.widget||null,!1)}},{key:"replace",value:function(e){var t=!!e.block,n=Ru(e),r=n.start,i=n.end;return new Qu(e,t?-2e8*(r?2:1):1e8*(r?-1:1),t?2e8*(i?2:1):1e8*(i?1:-1),t,e.widget||null,!0)}},{key:"line",value:function(e){return new Mu(e)}},{key:"set",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return yl.of(e,t)}}]),n}(dl);Eu.none=yl.empty;var Du=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;_classCallCheck(this,n);var i=Ru(e),o=i.start,a=i.end;return(r=t.call(this,1e8*(o?-1:1),1e8*(a?1:-1),null,e)).tagName=e.tagName||"span",r.class=e.class||"",r.attrs=e.attributes||null,r}return _createClass(n,[{key:"eq",value:function(e){return this==e||e instanceof n&&this.tagName==e.tagName&&this.class==e.class&&Au(this.attrs,e.attrs)}},{key:"range",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(e>=t)throw new RangeError("Mark decorations may not be empty");return _get(_getPrototypeOf(n.prototype),"range",this).call(this,e,t)}}]),n}(Eu);Du.prototype.point=!1;var Mu=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,-1e8,-1e8,null,e)}return _createClass(n,[{key:"eq",value:function(e){return e instanceof n&&Au(this.spec.attributes,e.spec.attributes)}},{key:"range",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(t!=e)throw new RangeError("Line decoration ranges must be zero-length");return _get(_getPrototypeOf(n.prototype),"range",this).call(this,e,t)}}]),n}(Eu);Mu.prototype.mapMode=ds.TrackBefore,Mu.prototype.point=!0;var Qu=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,i,o,a,s){var l;return _classCallCheck(this,n),(l=t.call(this,r,i,a,e)).block=o,l.isReplace=s,l.mapMode=o?r<0?ds.TrackBefore:ds.TrackAfter:ds.TrackDel,l}return _createClass(n,[{key:"eq",value:function(e){return e instanceof n&&((t=this.widget)==(r=e.widget)||!!(t&&r&&t.compare(r)))&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide;var t,r}},{key:"range",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(this.isReplace&&(e>t||e==t&&this.startSide>0&&this.endSide<0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&t!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return _get(_getPrototypeOf(n.prototype),"range",this).call(this,e,t)}},{key:"type",get:function(){return this.startSide<this.endSide?Tu.WidgetRange:this.startSide<0?Tu.WidgetBefore:Tu.WidgetAfter}},{key:"heightRelevant",get:function(){return this.block||!!this.widget&&this.widget.estimatedHeight>=5}}]),n}(Eu);function Ru(e){var t=e.inclusiveStart,n=e.inclusiveEnd;return null==t&&(t=e.inclusive),null==n&&(n=e.inclusive),{start:t||!1,end:n||!1}}function Hu(e,t,n){var r=n.length-1;r>=0&&n[r]+4>e?n[r]=Math.max(n[r],t):n.push(e,t)}Qu.prototype.point=!0;var Nu=Ps.define({combine:function(e){return e.join(" ")}}),Lu=Ps.define({combine:function(e){return e.indexOf(!0)>-1}}),Fu=cl.newName();function $u(e){return e.replace(/\$\w[\w\.]*/g,(function(e){for(var t=e.slice(1).split("."),n="",r=1;r<=t.length;r++)n+=".cm-"+t.slice(0,r).join("-");return n}))}function Bu(e,t){var n="."+e;return new cl(t,{process:function(e){return e=$u(e),/\$/.test(e)?e.replace(/\$/,n):n+" "+e},extend:function(e,t){return e=$u(e),t.slice(0,n.length+1)==n+" "?n+" "+e.replace(/&/,t.slice(n.length+1)):e.replace(/&/,t)}})}function Vu(e){if(e.indexOf(".")<0)return"cm-"+e;for(var t=e.split("."),n="",r=1;r<=t.length;r++)n+=(n?" ":"")+"cm-"+t.slice(0,r).join("-");return n}var zu,ju=Bu(Fu,{$:{position:"relative !important",boxSizing:"border-box","&$focused":{outline_fallback:"1px dotted #212121",outline:"5px auto -webkit-focus-ring-color"},display:"flex !important",flexDirection:"column"},$scroller:{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative"},$content:{margin:0,flexGrow:2,minHeight:"100%",display:"block",whiteSpace:"pre",boxSizing:"border-box",padding:"4px 0",outline:"none"},"$$light $content":{caretColor:"black"},"$$dark $content":{caretColor:"white"},$line:{display:"block",padding:"0 2px 0 4px"},$selectionLayer:{zIndex:-1,contain:"size style"},$selectionBackground:{position:"absolute"},"$$light $selectionBackground":{background:"#d9d9d9"},"$$dark $selectionBackground":{background:"#222"},"$$focused$light $selectionBackground":{background:"#d7d4f0"},"$$focused$dark $selectionBackground":{background:"#233"},$cursorLayer:{zIndex:100,contain:"size style",pointerEvents:"none"},"$$focused $cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{visibility:"hidden"},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{visibility:"hidden"},"100%":{}},$cursor:{position:"absolute",borderLeft:"1.2px solid #aaa",marginLeft:"-0.6px",pointerEvents:"none"},"$$focused $cursor":{borderLeft:"1.2px solid black"},$placeholder:{color:"#888",display:"inline-block"},$button:{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"3px"},"$$light $button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"$$dark $button":{backgroundImage:"linear-gradient(#555, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},$textfield:{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"$$light $textfield":{backgroundColor:"white"},"$$dark $textfield":{border:"1px solid #555",backgroundColor:"inherit"}}),qu=Vu("line"),Wu=function(e){_inherits(n,e);var t=_createSuper(n);function n(){var e;return _classCallCheck(this,n),(e=t.apply(this,arguments)).children=[],e.length=0,e.prevAttrs=void 0,e.attrs=null,e.breakAfter=0,e}return _createClass(n,[{key:"merge",value:function(e,t,r,i,o,a){if(r){if(!(r instanceof n))return!1;this.dom||r.transferDOM(this)}return i&&this.setDeco(r?r.attrs:null),Cu(this,e,t,r?r.children:Uu,o,a),!0}},{key:"split",value:function(e){var t=new n;if(t.breakAfter=this.breakAfter,0==this.length)return t;var r=this.childPos(e),i=r.i,o=r.off;o&&(t.append(this.children[i].slice(o),0),this.children[i].merge(o,this.children[i].length,null,0,0),i++);for(var a=i;a<this.children.length;a++)t.append(this.children[a],0);for(;i>0&&0==this.children[i-1].length;)this.children[i-1].parent=null,i--;return this.children.length=i,this.markDirty(),this.length=e,t}},{key:"transferDOM",value:function(e){this.dom&&(e.setDOM(this.dom),e.prevAttrs=void 0===this.prevAttrs?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}},{key:"setDeco",value:function(e){Au(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}},{key:"append",value:function(e,t){!function e(t,n,r){var i,o=t.children;r>0&&n instanceof ku&&o.length&&(i=o[o.length-1])instanceof ku&&i.mark.eq(n.mark)?e(i,n.children[0],r-1):(o.push(n),n.setParent(t)),t.length+=n.length}(this,e,t)}},{key:"addLineDeco",value:function(e){var t=e.spec.attributes;t&&(this.attrs=Su(t,this.attrs||{}))}},{key:"domAtPos",value:function(e){return Ou(this.dom,this.children,e)}},{key:"sync",value:function(e){this.dom||(this.setDOM(document.createElement("div")),this.dom.className=qu,this.prevAttrs=this.attrs?null:void 0),void 0!==this.prevAttrs&&(Pu(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add(qu),this.prevAttrs=void 0),_get(_getPrototypeOf(n.prototype),"sync",this).call(this,e);var t=this.dom.lastChild;if(!t||"BR"!=t.nodeName&&fu.get(t)instanceof wu){var r=document.createElement("BR");r.cmIgnore=!0,this.dom.appendChild(r)}}},{key:"measureTextSize",value:function(){if(0==this.children.length||this.length>20)return null;var e,t=0,n=_createForOfIteratorHelper(this.children);try{for(n.s();!(e=n.n()).done;){var r=e.value;if(!(r instanceof yu))return null;var i=Kl(r.dom);if(1!=i.length)return null;t+=i[0].width}}catch(o){n.e(o)}finally{n.f()}return{lineHeight:this.dom.getBoundingClientRect().height,charWidth:t/this.length}}},{key:"coordsAt",value:function(e,t){return xu(this,e,t)}},{key:"match",value:function(e){return!1}},{key:"type",get:function(){return Tu.Text}}],[{key:"find",value:function(e,t){for(var r=0,i=0;;r++){var o=e.children[r],a=i+o.length;if(a>=t){if(o instanceof n)return o;if(o.length)return null}i=a+o.breakAfter}}}]),n}(fu),Uu=[],Xu=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,i){var o;return _classCallCheck(this,n),(o=t.call(this)).widget=e,o.length=r,o.type=i,o.breakAfter=0,o}return _createClass(n,[{key:"merge",value:function(e,t,r,i,o,a){return!(r&&(!(r instanceof n&&this.widget.compare(r.widget))||e>0&&o<=0||t<this.length&&a<=0)||(this.length=e+(r?r.length:0)+(this.length-t),0))}},{key:"domAtPos",value:function(e){return 0==e?cu.before(this.dom):cu.after(this.dom,e==this.length)}},{key:"split",value:function(e){var t=this.length-e;return this.length=e,new n(this.widget,t,this.type)}},{key:"sync",value:function(){this.dom&&this.widget.updateDOM(this.dom)||(this.setDOM(this.widget.toDOM(this.editorView)),this.dom.contentEditable="false")}},{key:"domBoundsAround",value:function(){return null}},{key:"match",value:function(e){return e instanceof n&&e.type==this.type&&e.widget.constructor==this.widget.constructor&&(e.widget.eq(this.widget)||this.markDirty(!0),this.widget=e.widget,this.length=e.length,this.breakAfter=e.breakAfter,!0)}},{key:"children",get:function(){return Uu}},{key:"overrideDOMText",get:function(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):Ha.empty}}]),n}(fu),Gu=function(){function e(t,n,r){_classCallCheck(this,e),this.doc=t,this.pos=n,this.end=r,this.content=[],this.curLine=null,this.breakAtStart=0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=t.iter(),this.skip=n}return _createClass(e,[{key:"posCovered",value:function(){if(0==this.content.length)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;var e=this.content[this.content.length-1];return!(e.breakAfter||e instanceof Xu&&e.type==Tu.WidgetBefore)}},{key:"getLine",value:function(){return this.curLine||this.content.push(this.curLine=new Wu),this.curLine}},{key:"addWidget",value:function(e){this.curLine=null,this.content.push(e)}},{key:"finish",value:function(){this.posCovered()||this.getLine()}},{key:"wrapMarks",value:function(e,t){for(var n=t.length-1;n>=0;n--)e=new ku(t[n],[e],e.length);return e}},{key:"buildText",value:function(e,t,n){for(;e>0;){if(this.textOff==this.text.length){var r=this.cursor.next(this.skip),i=r.value,o=r.lineBreak,a=r.done;if(this.skip=0,a)throw new Error("Ran out of text content when drawing inline views");if(o){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.curLine=null,e--;continue}this.text=i,this.textOff=0}var s=Math.min(this.text.length-this.textOff,e);this.getLine().append(this.wrapMarks(new yu(this.text.slice(this.textOff,this.textOff+s)),t),n),e-=s,this.textOff+=s}}},{key:"span",value:function(e,t,n,r){this.buildText(t-e,n,r),this.pos=t,this.openStart<0&&(this.openStart=r)}},{key:"point",value:function(e,t,n,r,i){var o=t-e;if(n instanceof Qu)if(n.block){var a=n.type;a!=Tu.WidgetAfter||this.posCovered()||this.getLine(),this.addWidget(new Xu(n.widget||new Zu("div"),o,a))}else{var s=this.wrapMarks(wu.create(n.widget||new Zu("span"),o,n.startSide),r);this.getLine().append(s,i)}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(n);o&&(this.textOff+o<=this.text.length?this.textOff+=o:(this.skip+=o-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=t),this.openStart<0&&(this.openStart=i)}}],[{key:"build",value:function(t,n,r,i){var o=new e(t,n,r);return o.openEnd=yl.spans(i,n,r,o),o.openStart<0&&(o.openStart=o.openEnd),o.finish(),o}}]),e}(),Zu=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this)).tag=e,r}return _createClass(n,[{key:"eq",value:function(e){return e.tag==this.tag}},{key:"toDOM",value:function(){return document.createElement(this.tag)}},{key:"updateDOM",value:function(e){return e.nodeName.toLowerCase()==this.tag}}]),n}(Iu);!function(e){e[e.LTR=0]="LTR",e[e.RTL=1]="RTL"}(zu||(zu={}));var Yu=zu.LTR,Ku=zu.RTL;function Ju(e){for(var t=[],n=0;n<e.length;n++)t.push(1<<+e[n]);return t}var ec=Ju("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),tc=Ju("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),nc=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,rc=function(){function e(t,n,r){_classCallCheck(this,e),this.from=t,this.to=n,this.level=r}return _createClass(e,[{key:"side",value:function(e,t){return this.dir==t==e?this.to:this.from}},{key:"dir",get:function(){return this.level%2?Ku:Yu}}],[{key:"find",value:function(e,t,n,r){for(var i=-1,o=0;o<e.length;o++){var a=e[o];if(a.from<=t&&a.to>=t){if(a.level==n)return o;(i<0||(0!=r?r<0?a.from<t:a.to>t:e[i].level>a.level))&&(i=o)}}if(i<0)throw new RangeError("Index out of range");return i}}]),e}(),ic=[];function oc(e){return[new rc(0,e,0)]}var ac="";function sc(e,t,n,r,i){var o,a=r.head-e.from,s=-1;if(0==a){if(!i||!e.length)return null;t[0].level!=n&&(a=t[0].side(!1,n),s=0)}else if(a==e.length){if(i)return null;var l=t[t.length-1];l.level!=n&&(a=l.side(!0,n),s=t.length-1)}s<0&&(s=rc.find(t,a,null!==(o=r.bidiLevel)&&void 0!==o?o:-1,r.assoc));var u=t[s];a==u.side(i,n)&&(a=(u=t[s+=i?1:-1]).side(!i,n));var c=i==(u.dir==n),h=e.findClusterBreak(a,c);if(ac=e.slice(Math.min(a,h),Math.max(a,h)),h!=u.side(i,n))return Os.cursor(h+e.from,c?-1:1,u.level);var f=s==(i?t.length-1:0)?null:t[s+(i?1:-1)];return f||u.level==n?f&&f.level<u.level?Os.cursor(f.side(!i,n)+e.from,0,f.level):Os.cursor(h+e.from,0,u.level):Os.cursor(i?e.to:e.from,i?-1:1,n)}var lc,uc=["pre-wrap","normal","pre-line"],cc=function(){function e(){_classCallCheck(this,e),this.doc=Ha.empty,this.lineWrapping=!1,this.direction=zu.LTR,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.lineLength=30,this.heightChanged=!1}return _createClass(e,[{key:"heightForGap",value:function(e,t){var n=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(n+=Math.ceil((t-e-n*this.lineLength*.5)/this.lineLength)),this.lineHeight*n}},{key:"heightForLine",value:function(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}},{key:"setDoc",value:function(e){return this.doc=e,this}},{key:"mustRefresh",value:function(e,t,n){for(var r=!1,i=0;i<e.length;i++){var o=e[i];o<0?i++:this.heightSamples[Math.floor(10*o)]||(r=!0,this.heightSamples[Math.floor(10*o)]=!0)}return r||uc.indexOf(t)>-1!=this.lineWrapping||this.direction!=n}},{key:"refresh",value:function(e,t,n,r,i,o){var a=uc.indexOf(e)>-1,s=Math.round(n)!=Math.round(this.lineHeight)||this.lineWrapping!=a||this.direction!=t;if(this.lineWrapping=a,this.direction=t,this.lineHeight=n,this.charWidth=r,this.lineLength=i,s){this.heightSamples={};for(var l=0;l<o.length;l++){var u=o[l];u<0?l++:this.heightSamples[Math.floor(10*u)]=!0}}return s}}]),e}(),hc=function(){function e(t,n){_classCallCheck(this,e),this.from=t,this.heights=n,this.index=0}return _createClass(e,[{key:"more",get:function(){return this.index<this.heights.length}}]),e}(),fc=function(){function e(t,n,r,i,o){_classCallCheck(this,e),this.from=t,this.length=n,this.top=r,this.height=i,this.type=o}return _createClass(e,[{key:"join",value:function(t){var n=(Array.isArray(this.type)?this.type:[this]).concat(Array.isArray(t.type)?t.type:[t]);return new e(this.from,this.length+t.length,this.top,this.height+t.height,n)}},{key:"to",get:function(){return this.from+this.length}},{key:"bottom",get:function(){return this.top+this.height}}]),e}();!function(e){e[e.ByPos=0]="ByPos",e[e.ByHeight=1]="ByHeight",e[e.ByPosNoHeight=2]="ByPosNoHeight"}(lc||(lc={}));var dc=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;_classCallCheck(this,e),this.length=t,this.height=n,this.flags=r}return _createClass(e,[{key:"setHeight",value:function(e,t){this.height!=t&&(Math.abs(this.height-t)>1e-4&&(e.heightChanged=!0),this.height=t)}},{key:"replace",value:function(t,n,r){return e.of(r)}},{key:"decomposeLeft",value:function(e,t){t.push(this)}},{key:"decomposeRight",value:function(e,t){t.push(this)}},{key:"applyChanges",value:function(e,t,n,r){for(var i=this,o=r.length-1;o>=0;o--){var a=r[o],s=a.fromA,l=a.toA,u=a.fromB,c=a.toB,h=i.lineAt(s,lc.ByPosNoHeight,t,0,0),f=h.to>=l?h:i.lineAt(l,lc.ByPosNoHeight,t,0,0);for(c+=f.to-l,l=f.to;o>0&&h.from<=r[o-1].toA;)s=r[o-1].fromA,u=r[o-1].fromB,o--,s<h.from&&(h=i.lineAt(s,lc.ByPosNoHeight,t,0,0));u+=h.from-s,s=h.from;var d=kc.build(n,e,u,c);i=i.replace(s,l,d)}return i.updateHeight(n,0)}},{key:"outdated",get:function(){return(2&this.flags)>0},set:function(e){this.flags=(e?2:0)|-3&this.flags}}],[{key:"empty",value:function(){return new pc(0,0)}},{key:"of",value:function(t){if(1==t.length)return t[0];for(var n=0,r=t.length,i=0,o=0;;)if(n==r)if(i>2*o){var a=t[n-1];a.break?t.splice(--n,1,a.left,null,a.right):t.splice(--n,1,a.left,a.right),r+=1+a.break,i-=a.size}else{if(!(o>2*i))break;var s=t[r];s.break?t.splice(r,1,s.left,null,s.right):t.splice(r,1,s.left,s.right),r+=2+s.break,o-=s.size}else if(i<o){var l=t[n++];l&&(i+=l.size)}else{var u=t[--r];u&&(o+=u.size)}var c=0;return null==t[n-1]?(c=1,n--):null==t[n]&&(c=1,r++),new mc(e.of(t.slice(0,n)),c,e.of(t.slice(r)))}}]),e}();dc.prototype.size=1;var vc=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,i){var o;return _classCallCheck(this,n),(o=t.call(this,e,r)).type=i,o}return _createClass(n,[{key:"blockAt",value:function(e,t,n,r){return new fc(r,this.length,n,this.height,this.type)}},{key:"lineAt",value:function(e,t,n,r,i){return this.blockAt(0,n,r,i)}},{key:"forEachLine",value:function(e,t,n,r,i,o){o(this.blockAt(0,n,r,i))}},{key:"updateHeight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(arguments.length>2&&void 0!==arguments[2]&&arguments[2],arguments.length>3?arguments[3]:void 0);return n&&n.from<=t&&n.more&&this.setHeight(e,n.heights[n.index++]),this.outdated=!1,this}},{key:"toString",value:function(){return"block(".concat(this.length,")")}}]),n}(dc),pc=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var i;return _classCallCheck(this,n),(i=t.call(this,e,r,Tu.Text)).collapsed=0,i.widgetHeight=0,i}return _createClass(n,[{key:"replace",value:function(e,t,r){var i=r[0];return 1==r.length&&(i instanceof n||i instanceof gc&&4&i.flags)&&Math.abs(this.length-i.length)<10?(i instanceof gc?i=new n(i.length,this.height):i.height=this.height,this.outdated||(i.outdated=!1),i):dc.of(r)}},{key:"updateHeight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0;return r&&r.from<=t&&r.more?this.setHeight(e,r.heights[r.index++]):(n||this.outdated)&&this.setHeight(e,Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))),this.outdated=!1,this}},{key:"toString",value:function(){return"line(".concat(this.length).concat(this.collapsed?-this.collapsed:"").concat(this.widgetHeight?":"+this.widgetHeight:"",")")}}]),n}(vc),gc=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,e,0)}return _createClass(n,[{key:"lines",value:function(e,t){var n=e.lineAt(t).number,r=e.lineAt(t+this.length).number;return{firstLine:n,lastLine:r,lineHeight:this.height/(r-n+1)}}},{key:"blockAt",value:function(e,t,n,r){var i=this.lines(t,r),o=i.firstLine,a=i.lastLine,s=i.lineHeight,l=Math.max(0,Math.min(a-o,Math.floor((e-n)/s))),u=t.line(o+l),c=u.from,h=u.length;return new fc(c,h,n+s*l,s,Tu.Text)}},{key:"lineAt",value:function(e,t,n,r,i){if(t==lc.ByHeight)return this.blockAt(e,n,r,i);if(t==lc.ByPosNoHeight){var o=n.lineAt(e),a=o.from,s=o.to;return new fc(a,s-a,0,0,Tu.Text)}var l=this.lines(n,i),u=l.firstLine,c=l.lineHeight,h=n.lineAt(e),f=h.from,d=h.length,v=h.number;return new fc(f,d,r+c*(v-u),c,Tu.Text)}},{key:"forEachLine",value:function(e,t,n,r,i,o){for(var a=this.lines(n,i),s=a.firstLine,l=a.lineHeight,u=e;u<t;){var c=n.lineAt(u);u==e&&(r+=l*(c.number-s)),o(new fc(c.from,c.length,r,r+=l,Tu.Text)),u=c.to+1}}},{key:"replace",value:function(e,t,r){var i=this.length-t;if(i>0){var o=r[r.length-1];o instanceof n?r[r.length-1]=new n(o.length+i):r.push(null,new n(i-1))}if(e>0){var a=r[0];a instanceof n?r[0]=new n(e+a.length):r.unshift(new n(e-1),null)}return dc.of(r)}},{key:"decomposeLeft",value:function(e,t){t.push(new n(e-1),null)}},{key:"decomposeRight",value:function(e,t){t.push(null,new n(this.length-e-1))}},{key:"updateHeight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3?arguments[3]:void 0,o=t+this.length;if(i&&i.from<=t+this.length&&i.more){var a=[],s=Math.max(t,i.from);for(i.from>t&&a.push(new n(i.from-t-1).updateHeight(e,t));s<=o&&i.more;){var l=e.doc.lineAt(s).length;a.length&&a.push(null);var u=new pc(l,i.heights[i.index++]);u.outdated=!1,a.push(u),s+=l+1}return s<=o&&a.push(null,new n(o-s).updateHeight(e,s)),e.heightChanged=!0,dc.of(a)}return(r||this.outdated)&&(this.setHeight(e,e.heightForGap(t,t+this.length)),this.outdated=!1),this}},{key:"toString",value:function(){return"gap(".concat(this.length,")")}}]),n}(dc),mc=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,i){var o;return _classCallCheck(this,n),(o=t.call(this,e.length+r+i.length,e.height+i.height,r|(e.outdated||i.outdated?2:0))).left=e,o.right=i,o.size=e.size+i.size,o}return _createClass(n,[{key:"blockAt",value:function(e,t,n,r){var i=n+this.left.height;return e<i||0==this.right.height?this.left.blockAt(e,t,n,r):this.right.blockAt(e,t,i,r+this.left.length+this.break)}},{key:"lineAt",value:function(e,t,n,r,i){var o=r+this.left.height,a=i+this.left.length+this.break,s=t==lc.ByHeight?e<o||0==this.right.height:e<a,l=s?this.left.lineAt(e,t,n,r,i):this.right.lineAt(e,t,n,o,a);if(this.break||(s?l.to<a:l.from>a))return l;var u=t==lc.ByPosNoHeight?lc.ByPosNoHeight:lc.ByPos;return s?l.join(this.right.lineAt(a,u,n,o,a)):this.left.lineAt(a,u,n,r,i).join(l)}},{key:"forEachLine",value:function(e,t,n,r,i,o){var a=r+this.left.height,s=i+this.left.length+this.break;if(this.break)e<s&&this.left.forEachLine(e,t,n,r,i,o),t>=s&&this.right.forEachLine(e,t,n,a,s,o);else{var l=this.lineAt(s,lc.ByPos,n,r,i);e<l.from&&this.left.forEachLine(e,l.from-1,n,r,i,o),l.to>=e&&l.from<=t&&o(l),t>l.to&&this.right.forEachLine(l.to+1,t,n,a,s,o)}}},{key:"replace",value:function(e,t,n){var r=this.left.length+this.break;if(t<r)return this.balanced(this.left.replace(e,t,n),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-r,t-r,n));var i=[];e>0&&this.decomposeLeft(e,i);var o,a=i.length,s=_createForOfIteratorHelper(n);try{for(s.s();!(o=s.n()).done;){var l=o.value;i.push(l)}}catch(c){s.e(c)}finally{s.f()}if(e>0&&yc(i,a-1),t<this.length){var u=i.length;this.decomposeRight(t,i),yc(i,u)}return dc.of(i)}},{key:"decomposeLeft",value:function(e,t){var n=this.left.length;if(e<=n)return this.left.decomposeLeft(e,t);t.push(this.left),this.break&&(e>=++n&&t.push(null)),e>n&&this.right.decomposeLeft(e-n,t)}},{key:"decomposeRight",value:function(e,t){var n=this.left.length,r=n+this.break;if(e>=r)return this.right.decomposeRight(e-r,t);e<n&&this.left.decomposeRight(e,t),this.break&&e<r&&t.push(null),t.push(this.right)}},{key:"balanced",value:function(e,t){return e.size>2*t.size||t.size>2*e.size?dc.of(this.break?[e,null,t]:[e,t]):(this.left=e,this.right=t,this.height=e.height+t.height,this.outdated=e.outdated||t.outdated,this.size=e.size+t.size,this.length=e.length+this.break+t.length,this)}},{key:"updateHeight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0,i=this.left,o=this.right,a=t+i.length+this.break,s=null;return r&&r.from<=t+i.length&&r.more?s=i=i.updateHeight(e,t,n,r):i.updateHeight(e,t,n),r&&r.from<=a+o.length&&r.more?s=o=o.updateHeight(e,a,n,r):o.updateHeight(e,a,n),s?this.balanced(i,o):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}},{key:"toString",value:function(){return this.left+(this.break?" ":"-")+this.right}},{key:"break",get:function(){return 1&this.flags}}]),n}(dc);function yc(e,t){var n,r;null==e[t]&&(n=e[t-1])instanceof gc&&(r=e[t+1])instanceof gc&&e.splice(t-1,3,new gc(n.length+1+r.length))}var kc=function(){function e(t,n){_classCallCheck(this,e),this.pos=t,this.oracle=n,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=t}return _createClass(e,[{key:"span",value:function(e,t){if(this.lineStart>-1){var n=Math.min(t,this.lineEnd),r=this.nodes[this.nodes.length-1];r instanceof pc?r.length+=n-this.pos:(n>this.pos||!this.isCovered)&&this.nodes.push(new pc(n-this.pos,-1)),this.writtenTo=n,t>n&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=t}},{key:"point",value:function(e,t,n){if(e<t||n.heightRelevant){var r=n.widget?Math.max(0,n.widget.estimatedHeight):0,i=t-e;n.block?this.addBlock(new vc(i,r,n.type)):(i||r>=5)&&this.addLineDeco(r,i)}else t>e&&this.span(e,t);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}},{key:"enterLine",value:function(){if(!(this.lineStart>-1)){var e=this.oracle.doc.lineAt(this.pos),t=e.from,n=e.to;this.lineStart=t,this.lineEnd=n,this.writtenTo<t&&((this.writtenTo<t-1||null==this.nodes[this.nodes.length-1])&&this.nodes.push(this.blankContent(this.writtenTo,t-1)),this.nodes.push(null)),this.pos>t&&this.nodes.push(new pc(this.pos-t,-1)),this.writtenTo=this.pos}}},{key:"blankContent",value:function(e,t){var n=new gc(t-e);return this.oracle.doc.lineAt(e).to==t&&(n.flags|=4),n}},{key:"ensureLine",value:function(){this.enterLine();var e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof pc)return e;var t=new pc(0,-1);return this.nodes.push(t),t}},{key:"addBlock",value:function(e){this.enterLine(),e.type!=Tu.WidgetAfter||this.isCovered||this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,e.type!=Tu.WidgetBefore&&(this.covering=e)}},{key:"addLineDeco",value:function(e,t){var n=this.ensureLine();n.length+=t,n.collapsed+=t,n.widgetHeight=Math.max(n.widgetHeight,e),this.writtenTo=this.pos=this.pos+t}},{key:"finish",value:function(e){var t=0==this.nodes.length?null:this.nodes[this.nodes.length-1];!(this.lineStart>-1)||t instanceof pc||this.isCovered?(this.writtenTo<this.pos||null==t)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos)):this.nodes.push(new pc(0,-1));var n,r=e,i=_createForOfIteratorHelper(this.nodes);try{for(i.s();!(n=i.n()).done;){var o=n.value;o instanceof pc&&o.updateHeight(this.oracle,r),r+=o?o.length:1}}catch(a){i.e(a)}finally{i.f()}return this.nodes}},{key:"isCovered",get:function(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}},{key:"minPointSize",get:function(){return 0}}],[{key:"build",value:function(t,n,r,i){var o=new e(r,t);return yl.spans(n,r,i,o),o.finish(r)}}]),e}(),bc=function(){function e(){_classCallCheck(this,e),this.changes=[]}return _createClass(e,[{key:"compareRange",value:function(){}},{key:"comparePoint",value:function(e,t,n,r){(e<t||n&&n.heightRelevant||r&&r.heightRelevant)&&Hu(e,t,this.changes)}},{key:"minPointSize",get:function(){return 0}}]),e}(),wc=[],_c=Ps.define(),Cc=Ps.define(),Oc=Ps.define(),xc=Ps.define(),Sc=Ps.define(),Ac=Ps.define();function Pc(e,t,n){var r=e.facet(xc);r.length?r[0](t):window.onerror?window.onerror(String(t),n,void 0,void 0,t):n?console.error(n+":",t):console.error(t)}var Tc=Ps.define({combine:function(e){return!e.length||e[0]}}),Ic=function e(t,n){_classCallCheck(this,e),this.field=t,this.get=n},Ec=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"from",value:function(e){return new Ic(this,e)}}],[{key:"define",value:function(){return new e}}]),e}();Ec.scrollMargins=Ec.define();var Dc=0,Mc=Ps.define(),Qc=function(){function e(t,n,r){_classCallCheck(this,e),this.id=t,this.create=n,this.fields=r,this.extension=Mc.of(this)}return _createClass(e,null,[{key:"define",value:function(t,n){var r=n||{},i=r.eventHandlers,o=r.provide,a=r.decorations,s=[];if(o){var l,u=_createForOfIteratorHelper(Array.isArray(o)?o:[o]);try{for(u.s();!(l=u.n()).done;){var c=l.value;s.push(c)}}catch(v){u.e(v)}finally{u.f()}}if(i&&s.push(Hc.from((function(e){return{plugin:e,handlers:i}}))),a){var h,f=_createForOfIteratorHelper(Array.isArray(a)?a:[a]);try{for(f.s();!(h=f.n()).done;){var d=h.value;s.push(Rc.from(d))}}catch(v){f.e(v)}finally{f.f()}}return new e(Dc++,t,s)}},{key:"fromClass",value:function(t,n){return e.define((function(e){return new t(e)}),n)}}]),e}(),Rc=Ec.define(),Hc=Ec.define(),Nc=function(){function e(t,n){_classCallCheck(this,e),this.value=t,this.spec=n}return _createClass(e,[{key:"takeField",value:function(e,t){var n,r=_createForOfIteratorHelper(this.spec.fields);try{for(r.s();!(n=r.n()).done;){var i=n.value,o=i.field,a=i.get;o==e&&t.push(a(this.value))}}catch(s){r.e(s)}finally{r.f()}}},{key:"update",value:function(t){if(!this.value.update)return this;try{return this.value.update(t),this}catch(n){if(Pc(t.state,n,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch(Cy){}return e.dummy}}},{key:"destroy",value:function(e){if(this.value.destroy)try{this.value.destroy()}catch(t){Pc(e.state,t,"CodeMirror plugin crashed")}}}],[{key:"create",value:function(t,n){var r;try{r=t.create(n)}catch(i){return Pc(n.state,i,"CodeMirror plugin crashed"),e.dummy}return new e(r,t)}}]),e}();Nc.dummy=new Nc({},Qc.define((function(){return{}})));var Lc=Ps.define({combine:function(e){return e.reduce((function(e,t){return Su(t,e)}),{})}}),Fc=Ps.define({combine:function(e){return e.reduce((function(e,t){return Su(t,e)}),{})}}),$c=Ps.define(),Bc=Ps.define(),Vc=function(){function e(t,n,r,i){_classCallCheck(this,e),this.fromA=t,this.toA=n,this.fromB=r,this.toB=i}return _createClass(e,[{key:"join",value:function(t){return new e(Math.min(this.fromA,t.fromA),Math.max(this.toA,t.toA),Math.min(this.fromB,t.fromB),Math.max(this.toB,t.toB))}},{key:"addToSet",value:function(e){for(var t=e.length,n=this;t>0;t--){var r=e[t-1];if(!(r.fromA>n.toA)){if(r.toA<n.fromA)break;n=n.join(r),e.splice(t-1,1)}}return e.splice(t,0,n),e}}],[{key:"extendWithRanges",value:function(t,n){if(0==n.length)return t;for(var r=[],i=0,o=0,a=0,s=0;;i++){for(var l=i==t.length?null:t[i],u=a-s,c=l?l.fromB:1e9;o<n.length&&n[o]<c;){var h=n[o+1],f=Math.max(s,n[o]),d=Math.min(c,h);if(f<=d&&new e(f+u,d+u,f,d).addToSet(r),h>c)break;o+=2}if(!l)return r;new e(l.fromA,l.toA,l.fromB,l.toB).addToSet(r),a=l.toA,s=l.toB}}}]),e}(),zc=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:wc;_classCallCheck(this,e),this.view=t,this.state=n,this.transactions=r,this.flags=0,this.prevState=t.state,this.changes=gs.empty(this.prevState.doc.length);var i,o=_createForOfIteratorHelper(r);try{for(o.s();!(i=o.n()).done;){var a=i.value;this.changes=this.changes.compose(a.changes)}}catch(u){o.e(u)}finally{o.f()}var s=[];this.changes.iterChangedRanges((function(e,t,n,r){return s.push(new Vc(e,t,n,r))})),this.changedRanges=s;var l=t.hasFocus;l!=t.inputState.notifiedFocused&&(t.inputState.notifiedFocused=l),this.docChanged&&(this.flags|=2)}return _createClass(e,[{key:"viewportChanged",get:function(){return(4&this.flags)>0}},{key:"heightChanged",get:function(){return(2&this.flags)>0}},{key:"geometryChanged",get:function(){return this.docChanged||(18&this.flags)>0}},{key:"focusChanged",get:function(){return(1&this.flags)>0}},{key:"docChanged",get:function(){return this.transactions.some((function(e){return e.docChanged}))}},{key:"selectionSet",get:function(){return this.transactions.some((function(e){return e.selection}))}},{key:"empty",get:function(){return 0==this.flags&&0==this.transactions.length}}]),e}(),jc=function(){function e(t,n,r){_classCallCheck(this,e),this.from=t,this.to=n,this.size=r}return _createClass(e,[{key:"draw",value:function(e){return Eu.replace({widget:new qc(this.size,e)}).range(this.from,this.to)}}],[{key:"same",value:function(e,t){if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++){var r=e[n],i=t[n];if(r.from!=i.from||r.to!=i.to||r.size!=i.size)return!1}return!0}}]),e}(),qc=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var i;return _classCallCheck(this,n),(i=t.call(this)).size=e,i.vertical=r,i}return _createClass(n,[{key:"eq",value:function(e){return e.size==this.size&&e.vertical==this.vertical}},{key:"toDOM",value:function(){var e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}},{key:"estimatedHeight",get:function(){return this.vertical?this.size:-1}}]),n}(Iu),Wc=function(){function e(t){_classCallCheck(this,e),this.state=t,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentWidth=0,this.heightOracle=new cc,this.heightMap=dc.empty(),this.scrollTo=null,this.printing=!1,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1,this.heightMap=this.heightMap.applyChanges(t.facet($c),Ha.empty,this.heightOracle.setDoc(t.doc),[new Vc(0,0,0,t.doc.length)]),this.viewport=this.getViewport(0,null),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=Eu.set(this.lineGaps.map((function(e){return e.draw(!1)}))),this.computeVisibleRanges()}return _createClass(e,[{key:"update",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.state;this.state=e.state;var r,i,o,a,s=this.state.facet($c),l=Vc.extendWithRanges(e.changedRanges,(r=e.prevState.facet($c),i=s,o=e?e.changes:gs.empty(this.state.doc.length),a=new bc,yl.compare(r,i,o,a),a.changes)),u=this.heightMap.height;this.heightMap=this.heightMap.applyChanges(s,n.doc,this.heightOracle.setDoc(this.state.doc),l),this.heightMap.height!=u&&(e.flags|=2);var c=l.length?this.mapViewport(this.viewport,e.changes):this.viewport;(t&&(t.head<c.from||t.head>c.to)||!this.viewportIsAppropriate(c))&&(c=this.getViewport(0,t)),c.eq(this.viewport)||(this.viewport=c,e.flags|=4),(this.lineGaps.length||this.viewport.to-this.viewport.from>15e3)&&(e.flags|=this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes)))),this.computeVisibleRanges(),t&&(this.scrollTo=t),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.primary.empty&&e.state.selection.primary.assoc&&(this.mustEnforceCursorAssoc=!0)}},{key:"measure",value:function(e,t){var n=e.dom,r="",i=zu.LTR;if(!t){var o=window.getComputedStyle(n);r=o.whiteSpace,i="rtl"==o.direction?zu.RTL:zu.LTR,this.paddingTop=parseInt(o.paddingTop)||0,this.paddingBottom=parseInt(o.paddingBottom)||0}var a=this.printing?{top:-1e8,bottom:1e8,left:-1e8,right:1e8}:function(e,t){for(var n=e.getBoundingClientRect(),r=Math.max(0,n.left),i=Math.min(innerWidth,n.right),o=Math.max(0,n.top),a=Math.min(innerHeight,n.bottom),s=e.parentNode;s;)if(1==s.nodeType){if((s.scrollHeight>s.clientHeight||s.scrollWidth>s.clientWidth)&&"visible"!=window.getComputedStyle(s).overflow){var l=s.getBoundingClientRect();r=Math.max(r,l.left),i=Math.min(i,l.right),o=Math.max(o,l.top),a=Math.min(a,l.bottom)}s=s.parentNode}else{if(11!=s.nodeType)break;s=s.host}return{left:r-n.left,right:i-n.left,top:o-(n.top+t),bottom:a-(n.top+t)}}(n,this.paddingTop),s=a.top-this.pixelViewport.top,l=a.bottom-this.pixelViewport.bottom;if(this.pixelViewport=a,this.inView=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left,!this.inView)return 0;var u=e.measureVisibleLineHeights(),c=!1,h=0,f=0,d=this.heightOracle;if(!t){var v=e.dom.clientWidth;if(d.mustRefresh(u,r,i)||d.lineWrapping&&Math.abs(v-this.contentWidth)>d.charWidth){var p=e.measureTextSize(),g=p.lineHeight,m=p.charWidth;(c=d.refresh(r,i,g,m,v/m,u))&&(e.minWidth=0,f|=16)}this.contentWidth!=v&&(this.contentWidth=v,f|=16),s>0&&l>0?h=Math.max(s,l):s<0&&l<0&&(h=Math.min(s,l))}return d.heightChanged=!1,this.heightMap=this.heightMap.updateHeight(d,0,c,new hc(this.viewport.from,u)),d.heightChanged&&(f|=2),(!this.viewportIsAppropriate(this.viewport,h)||this.scrollTo&&(this.scrollTo.head<this.viewport.from||this.scrollTo.head>this.viewport.to))&&(this.viewport=this.getViewport(h,this.scrollTo),f|=4),(this.lineGaps.length||this.viewport.to-this.viewport.from>15e3)&&(f|=this.updateLineGaps(this.ensureLineGaps(c?[]:this.lineGaps))),this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.enforceCursorAssoc()),f}},{key:"getViewport",value:function(e,t){var n=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),r=this.heightMap,i=this.state.doc,o=this.pixelViewport,a=o.top,s=o.bottom,l=new Uc(r.lineAt(a-1e3*n,lc.ByHeight,i,0,0).from,r.lineAt(s+1e3*(1-n),lc.ByHeight,i,0,0).to);if(t)if(t.head<l.from){var u=r.lineAt(t.head,lc.ByPos,i,0,0).top;l=new Uc(r.lineAt(u-500,lc.ByHeight,i,0,0).from,r.lineAt(u+(s-a)+500,lc.ByHeight,i,0,0).to)}else if(t.head>l.to){var c=r.lineAt(t.head,lc.ByPos,i,0,0).bottom;l=new Uc(r.lineAt(c-(s-a)-500,lc.ByHeight,i,0,0).from,r.lineAt(c+500,lc.ByHeight,i,0,0).to)}return l}},{key:"mapViewport",value:function(e,t){var n=t.mapPos(e.from,-1),r=t.mapPos(e.to,1);return new Uc(this.heightMap.lineAt(n,lc.ByPos,this.state.doc,0,0).from,this.heightMap.lineAt(r,lc.ByPos,this.state.doc,0,0).to)}},{key:"viewportIsAppropriate",value:function(e){var t=e.from,n=e.to,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=this.heightMap.lineAt(t,lc.ByPos,this.state.doc,0,0),o=i.top,a=this.heightMap.lineAt(n,lc.ByPos,this.state.doc,0,0),s=a.bottom;return(0==t||o<=this.pixelViewport.top-Math.max(10,Math.min(-r,250)))&&(n==this.state.doc.length||s>=this.pixelViewport.bottom+Math.max(10,Math.min(r,250)))&&o>this.pixelViewport.top-2e3&&s<this.pixelViewport.bottom+2e3}},{key:"mapLineGaps",value:function(e,t){if(!e.length||t.empty)return e;var n,r=[],i=_createForOfIteratorHelper(e);try{for(i.s();!(n=i.n()).done;){var o=n.value;t.touchesRange(o.from,o.to)||r.push(new jc(t.mapPos(o.from),t.mapPos(o.to),o.size))}}catch(a){i.e(a)}finally{i.f()}return r}},{key:"ensureLineGaps",value:function(e){var t=this,n=[];return this.heightOracle.direction!=zu.LTR||this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.state.doc,0,0,(function(r){if(!(r.length<1e4)){var i,o,a,s,l,u,c,h,f=(a=r.from,s=r.to,l=t.state,u=[],c=a,h=0,yl.spans(l.facet($c),a,s,{span:function(){},point:function(e,t){e>c&&(u.push({from:c,to:e}),h+=e-c),c=t},minPointSize:20}),c<s&&(u.push({from:c,to:s}),h+=s-c),{total:h,ranges:u});if(!(f.total<1e4)){if(t.heightOracle.lineWrapping)i=r.from!=t.viewport.from?r.from:Xc(f,(t.pixelViewport.top-r.top)/r.height),o=r.to!=t.viewport.to?r.to:Xc(f,(t.pixelViewport.bottom-r.top)/r.height);else{var d=f.total*t.heightOracle.charWidth;i=Xc(f,t.pixelViewport.left/d),o=Xc(f,t.pixelViewport.right/d)}var v=t.state.selection.primary;v.from<=i&&v.to>=r.from&&(i=v.from),v.from<=r.to&&v.to>=o&&(o=v.to);var p=i-1e4,g=o+1e4;p>r.from+5e3&&n.push(Zc(e,(function(e){return e.from==r.from&&e.to>p-5e3&&e.to<p+5e3}))||new jc(r.from,p,t.gapSize(r,p,!0,f))),g<r.to-5e3&&n.push(Zc(e,(function(e){return e.to==r.to&&e.from>g-5e3&&e.from<g+5e3}))||new jc(g,r.to,t.gapSize(r,g,!1,f)))}}})),n}},{key:"gapSize",value:function(e,t,n,r){if(this.heightOracle.lineWrapping){var i=e.height*Gc(r,t);return n?i:e.height-i}var o=Gc(r,t);return r.total*this.heightOracle.charWidth*(n?o:1-o)}},{key:"updateLineGaps",value:function(e){var t=this;return jc.same(e,this.lineGaps)?0:(this.lineGaps=e,this.lineGapDeco=Eu.set(e.map((function(e){return e.draw(t.heightOracle.lineWrapping)}))),8)}},{key:"computeVisibleRanges",value:function(){var e=this.state.facet($c);this.lineGaps.length&&(e=e.concat(this.lineGapDeco));var t=[];yl.spans(e,this.viewport.from,this.viewport.to,{span:function(e,n){t.push({from:e,to:n})},point:function(){},minPointSize:20}),this.visibleRanges=t}},{key:"lineAt",value:function(e,t){return this.heightMap.lineAt(e,lc.ByPos,this.state.doc,t+this.paddingTop,0)}},{key:"lineAtHeight",value:function(e,t){return this.heightMap.lineAt(e,lc.ByHeight,this.state.doc,t+this.paddingTop,0)}},{key:"blockAtHeight",value:function(e,t){return this.heightMap.blockAt(e,this.state.doc,t+this.paddingTop,0)}},{key:"forEachLine",value:function(e,t,n,r){return this.heightMap.forEachLine(e,t,this.state.doc,r+this.paddingTop,0,n)}}]),e}(),Uc=function(){function e(t,n){_classCallCheck(this,e),this.from=t,this.to=n}return _createClass(e,[{key:"eq",value:function(e){return this.from==e.from&&this.to==e.to}}]),e}();function Xc(e,t){var n=e.total,r=e.ranges;if(t<=0)return r[0].from;if(t>=1)return r[r.length-1].to;for(var i=Math.floor(n*t),o=0;;o++){var a=r[o],s=a.from,l=a.to-s;if(i<=l)return s+i;i-=l}}function Gc(e,t){var n,r=0,i=_createForOfIteratorHelper(e.ranges);try{for(i.s();!(n=i.n()).done;){var o=n.value,a=o.from,s=o.to;if(t<=s){r+=t-a;break}r+=s-a}}catch(l){i.e(l)}finally{i.f()}return r/e.total}function Zc(e,t){var n,r=_createForOfIteratorHelper(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(t(i))return i}}catch(o){r.e(o)}finally{r.f()}}var Yc=[],Kc=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this)).view=e,r.viewports=Yc,r.compositionDeco=Eu.none,r.decorations=[],r.minWidth=0,r.minWidthFrom=0,r.minWidthTo=0,r.impreciseAnchor=null,r.impreciseHead=null,r.setDOM(e.contentDOM),r.children=[new Wu],r.children[0].setParent(_assertThisInitialized(r)),r.updateInner([new Vc(0,0,0,e.state.doc.length)],r.updateDeco(),0),r}return _createClass(n,[{key:"update",value:function(e){var t,n=this,r=e.changedRanges;this.minWidth>0&&r.length&&(r.every((function(e){var t=e.fromA;return e.toA<n.minWidthFrom||t>n.minWidthTo}))?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=0),(null===(t=this.view.inputState)||void 0===t?void 0:t.composing)?e.transactions.length&&(this.compositionDeco=function(e,t){var n=Zl(e.root),r=n.focusNode&&th(n.focusNode,n.focusOffset,0);if(!r)return Eu.none;var i,o,a=e.docView.nearest(r),s=r;if(a instanceof mu){for(;a.parent instanceof mu;)a=a.parent;o=(i=a.posAtStart)+a.length,s=a.dom}else{if(!(a instanceof Wu))return Eu.none;for(;s.parentNode!=a.dom;)s=s.parentNode;for(var l=s.previousSibling;l&&!fu.get(l);)l=l.previousSibling;i=o=l?fu.get(l).posAtEnd:a.posAtStart}var u=t.mapPos(i,1),c=Math.max(u,t.mapPos(o,-1)),h=r.nodeValue,f=e.state;if(c-u<h.length)if(f.sliceDoc(u,Math.min(f.doc.length,u+h.length))==h)c=u+h.length;else{if(f.sliceDoc(Math.max(0,c-h.length),c)!=h)return Eu.none;u=c-h.length}else if(f.sliceDoc(u,c)!=h)return Eu.none;return Eu.set(Eu.replace({widget:new eh(s,r)}).range(u,c))}(this.view,e.changes)):this.compositionDeco=Eu.none;var i,o,a,s,l=(Gl.ie||Gl.chrome)&&!this.compositionDeco.size&&e&&e.state.doc.lines!=e.prevState.doc.lines,u=this.decorations,c=this.updateDeco(),h=(i=u,o=c,a=e.changes,s=new rh,yl.compare(i,o,a,s),s.changes);r=Vc.extendWithRanges(r,h);var f=e.transactions.some((function(e){return"pointerselection"==e.annotation(Ys.userEvent)}));return 0==this.dirty&&0==r.length&&!(12&e.flags)&&e.state.selection.primary.from>=this.view.viewport.from&&e.state.selection.primary.to<=this.view.viewport.to?(this.updateSelection(l,f),!1):(this.updateInner(r,c,e.prevState.doc.length,l,f),!0)}},{key:"updateInner",value:function(e,t,n){var r=this,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.updateChildren(e,t,n),this.view.observer.ignore((function(){r.dom.style.height=r.view.viewState.heightMap.height+"px",r.dom.style.minWidth=r.minWidth?r.minWidth+"px":"";var e=Gl.chrome?{node:Zl(r.view.root).focusNode,written:!1}:void 0;r.sync(e),r.dirty=0,(null==e?void 0:e.written)&&(i=!0),r.updateSelection(i,o),r.dom.style.height=""}))}},{key:"updateChildren",value:function(e,t,n){for(var r=this.childCursor(n),i=e.length-1;;i--){var o=i>=0?e[i]:null;if(!o)break;var a=o.fromA,s=o.toA,l=o.fromB,u=o.toB,c=Gu.build(this.view.state.doc,l,u,t),h=c.content,f=c.breakAtStart,d=c.openStart,v=c.openEnd,p=r.findPos(s,1),g=p.i,m=p.off,y=r.findPos(a,-1),k=y.i,b=y.off;this.replaceRange(k,b,g,m,h,f,d,v)}}},{key:"replaceRange",value:function(e,t,n,r,i,o,a,s){var l=this.children[e],u=i.length?i[i.length-1]:null,c=u?u.breakAfter:o;if(e!=n||o||c||!(i.length<2)||!l.merge(t,r,i.length?u:null,0==t,a,s)){var h=this.children[n];for(r<h.length||h.children.length&&0==h.children[h.children.length-1].length?(e==n&&(h=h.split(r),r=0),!c&&u&&h.merge(0,r,u,!0,0,s)?i[i.length-1]=h:((r||h.children.length&&0==h.children[0].length)&&h.merge(0,r,null,!1,0,s),i.push(h))):h.breakAfter&&(u?u.breakAfter=1:o=1),n++,l.breakAfter=o,t>0&&(!o&&i.length&&l.merge(t,l.length,i[0],!1,a,0)?l.breakAfter=i.shift().breakAfter:(t<l.length||l.children.length&&0==l.children[l.children.length-1].length)&&l.merge(t,l.length,null,!1,a,0),e++);e<n&&i.length;)if(this.children[n-1].match(i[i.length-1]))n--,i.pop();else{if(!this.children[e].match(i[0]))break;e++,i.shift()}(e<n||i.length)&&this.replaceChildren(e,n,i)}}},{key:"updateSelection",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t||this.mayControlSelection()){var n=this.view.state.selection.primary,r=this.domAtPos(n.anchor),i=this.domAtPos(n.head),o=Zl(this.root);(e||!o.focusNode||Gl.gecko&&n.empty&&nh(o.focusNode,o.focusOffset)||!Jl(r.node,r.offset,o.anchorNode,o.anchorOffset)||!Jl(i.node,i.offset,o.focusNode,o.focusOffset))&&this.view.observer.ignore((function(){if(n.empty){if(Gl.gecko){var e=nh(r.node,r.offset);if(e&&3!=e){var t=th(r.node,r.offset,1==e?1:-1);t&&(r=new cu(t,1==e?0:t.nodeValue.length))}}o.collapse(r.node,r.offset),null!=n.bidiLevel&&null!=o.cursorBidiLevel&&(o.cursorBidiLevel=n.bidiLevel)}else if(o.extend)o.collapse(r.node,r.offset),o.extend(i.node,i.offset);else{var a,s=document.createRange();n.anchor>n.head&&(r=(a=[i,r])[0],i=a[1]),s.setEnd(i.node,i.offset),s.setStart(r.node,r.offset),o.removeAllRanges(),o.addRange(s)}})),this.impreciseAnchor=r.precise?null:new cu(o.anchorNode,o.anchorOffset),this.impreciseHead=i.precise?null:new cu(o.focusNode,o.focusOffset)}}},{key:"enforceCursorAssoc",value:function(){var e=this.view.state.selection.primary,t=Zl(this.root);if(e.empty&&e.assoc&&t.modify){var n=Wu.find(this,e.head);if(n){var r=n.posAtStart;if(e.head!=r&&e.head!=r+n.length){var i=this.coordsAt(e.head,-1),o=this.coordsAt(e.head,1);if(i&&o&&!(i.bottom>o.top)){var a=this.domAtPos(e.head+e.assoc);t.collapse(a.node,a.offset),t.modify("move",e.assoc<0?"forward":"backward","lineboundary")}}}}}},{key:"mayControlSelection",value:function(){return this.view.state.facet(Tc)?this.root.activeElement==this.dom:Yl(this.dom,Zl(this.root))}},{key:"nearest",value:function(e){for(var t=e;t;){var n=fu.get(t);if(n&&n.rootView==this)return n;t=t.parentNode}return null}},{key:"posFromDOM",value:function(e,t){var n=this.nearest(e);if(!n)throw new RangeError("Trying to find position for a DOM position outside of the document");return n.localPosFromDOM(e,t)+n.posAtStart}},{key:"domAtPos",value:function(e){for(var t=this.childCursor().findPos(e,-1),n=t.i,r=t.off;n<this.children.length-1;){var i=this.children[n];if(r<i.length||i instanceof Wu)break;n++,r=0}return this.children[n].domAtPos(r)}},{key:"coordsAt",value:function(e,t){for(var n=this.length,r=this.children.length-1;;r--){var i=this.children[r],o=n-i.breakAfter-i.length;if(e>=o&&i.type!=Tu.WidgetAfter)return i.coordsAt(e-o,t);n=o}}},{key:"measureVisibleLineHeights",value:function(){for(var e=[],t=this.view.viewState.viewport,n=t.from,r=t.to,i=Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,o=0,a=0;a<this.children.length;a++){var s=this.children[a],l=o+s.length;if(l>r)break;if(o>=n){e.push(s.dom.getBoundingClientRect().height);var u=s.dom.scrollWidth;u>i&&(this.minWidth=i=u,this.minWidthFrom=o,this.minWidthTo=l)}o=l+s.breakAfter}return e}},{key:"measureTextSize",value:function(){var e,t=this,n=_createForOfIteratorHelper(this.children);try{for(n.s();!(e=n.n()).done;){var r=e.value;if(r instanceof Wu){var i=r.measureTextSize();if(i)return i}}}catch(l){n.e(l)}finally{n.f()}var o,a,s=document.createElement("div");return s.className="cm-line",s.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore((function(){t.dom.appendChild(s);var e=Kl(s.firstChild)[0];o=s.getBoundingClientRect().height,a=e?e.width/27:7,s.remove()})),{lineHeight:o,charWidth:a}}},{key:"childCursor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.length,t=this.children.length;return t&&(e-=this.children[--t].length),new pu(this.children,e,t)}},{key:"computeBlockGapDeco",value:function(){var e=this.view.viewState.viewport,t=[e],n=this.view.state.selection.primary,r=n.head,i=n.anchor;if(r<e.from||r>e.to){var o=this.view.viewState.lineAt(r,0),a=o.from,s=o.to;t.push(new Uc(a,s))}if(!t.some((function(e){var t=e.from,n=e.to;return i>=t&&i<=n}))){var l=this.view.viewState.lineAt(i,0),u=l.from,c=l.to;t.push(new Uc(u,c))}this.viewports=t.sort((function(e,t){return e.from-t.from}));for(var h=[],f=0,d=0;;d++){var v=d==t.length?null:t[d],p=v?v.from-1:this.length;if(p>f){var g=this.view.viewState.lineAt(p,0).bottom-this.view.viewState.lineAt(f,0).top;h.push(Eu.replace({widget:new Jc(g),block:!0,inclusive:!0}).range(f,p))}if(!v)break;f=v.to+1}return Eu.set(h)}},{key:"updateDeco",value:function(){return this.decorations=[this.computeBlockGapDeco(),this.view.viewState.lineGapDeco,this.compositionDeco].concat(_toConsumableArray(this.view.state.facet($c)),_toConsumableArray(this.view.pluginField(Rc)))}},{key:"scrollPosIntoView",value:function(e,t){var n=this.coordsAt(e,t);if(n){var r,i=0,o=0,a=0,s=0,l=_createForOfIteratorHelper(this.view.pluginField(Ec.scrollMargins));try{for(l.s();!(r=l.n()).done;){var u=r.value;if(u){var c=u.left,h=u.right,f=u.top,d=u.bottom;null!=c&&(i=Math.max(i,c)),null!=h&&(o=Math.max(o,h)),null!=f&&(a=Math.max(a,f)),null!=d&&(s=Math.max(s,d))}}}catch(v){l.e(v)}finally{l.f()}!function(e,t){for(var n=e.ownerDocument.defaultView,r=e.parentNode;r;)if(1==r.nodeType){var i=void 0,o=r==document.body;if(o)i=iu(n);else{if(r.scrollHeight<=r.clientHeight&&r.scrollWidth<=r.clientWidth){r=r.parentNode;continue}var a=r.getBoundingClientRect();i={left:a.left,right:a.left+r.clientWidth,top:a.top,bottom:a.top+r.clientHeight}}var s=0,l=0;if(t.top<i.top?l=-(i.top-t.top+5):t.bottom>i.bottom&&(l=t.bottom-i.bottom+5),t.left<i.left?s=-(i.left-t.left+5):t.right>i.right&&(s=t.right-i.right+5),s||l)if(o)n.scrollBy(s,l);else{if(l){var u=r.scrollTop;r.scrollTop+=l,l=r.scrollTop-u}if(s){var c=r.scrollLeft;r.scrollLeft+=s,s=r.scrollLeft-c}t={left:t.left-s,top:t.top-l,right:t.right-s,bottom:t.bottom-l}}if(o)break;r=r.parentNode}else{if(11!=r.nodeType)break;r=r.host}}(this.dom,{left:n.left-i,top:n.top-a,right:n.right+o,bottom:n.bottom+s})}}},{key:"root",get:function(){return this.view.root}},{key:"editorView",get:function(){return this.view}},{key:"length",get:function(){return this.view.state.doc.length}}]),n}(fu),Jc=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this)).height=e,r}return _createClass(n,[{key:"toDOM",value:function(){var e=document.createElement("div");return this.updateDOM(e),e}},{key:"eq",value:function(e){return e.height==this.height}},{key:"updateDOM",value:function(e){if(this.height<1e7){for(;e.lastChild;)e.lastChild.remove();e.style.height=this.height+"px"}else{e.style.height="";for(var t=this.height;t>0;t-=1e7)e.appendChild(document.createElement("div")).style.height=Math.min(t,1e7)+"px"}return!0}},{key:"estimatedHeight",get:function(){return this.height}}]),n}(Iu),eh=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var i;return _classCallCheck(this,n),(i=t.call(this)).top=e,i.text=r,i}return _createClass(n,[{key:"eq",value:function(e){return this.top==e.top&&this.text==e.text}},{key:"toDOM",value:function(){return this.top}},{key:"ignoreEvent",value:function(){return!1}},{key:"customView",get:function(){return _u}}]),n}(Iu);function th(e,t,n){for(;;){if(3==e.nodeType)return e;if(1==e.nodeType&&t>0&&n<=0)t=nu(e=e.childNodes[t-1]);else{if(!(1==e.nodeType&&t<e.childNodes.length&&n>=0))return null;e=e.childNodes[t],t=0}}}function nh(e,t){return 1!=e.nodeType?0:(t&&"false"==e.childNodes[t-1].contentEditable?1:0)|(t<e.childNodes.length&&"false"==e.childNodes[t].contentEditable?2:0)}var rh=function(){function e(){_classCallCheck(this,e),this.changes=[]}return _createClass(e,[{key:"compareRange",value:function(e,t){Hu(e,t,this.changes)}},{key:"comparePoint",value:function(e,t){Hu(e,t,this.changes)}}]),e}();function ih(e,t){return t.left>e?t.left-e:Math.max(0,e-t.right)}function oh(e,t){return t.top>e?t.top-e:Math.max(0,e-t.bottom)}function ah(e,t){return e.top<t.bottom-1&&e.bottom>t.top+1}function sh(e,t){return t<e.top?{top:t,left:e.left,right:e.right,bottom:e.bottom}:e}function lh(e,t){return t>e.bottom?{top:e.top,left:e.left,right:e.right,bottom:t}:e}function uh(e,t,n){for(var r=e.nodeValue.length,i=uu(),o=0;o<r;o++){i.setEnd(e,o+1),i.setStart(e,o);for(var a=i.getClientRects(),s=0;s<a.length;s++){var l=a[s];if(l.top!=l.bottom&&l.left-1<=t&&l.right+1>=t&&l.top-1<=n&&l.bottom+1>=n){var u=t>=(l.left+l.right)/2,c=u;return(Gl.chrome||Gl.gecko)&&(i.setEnd(e,o),i.getBoundingClientRect().left==l.right&&(c=!u)),{node:e,offset:o+(c?1:0)}}}}return{node:e,offset:0}}function ch(e,t){for(var n,r=t.x,i=t.y,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,a=e.contentDOM.getBoundingClientRect(),s=e.defaultLineHeight/2,l=!1;;){if((n=e.blockAtHeight(i,a.top)).top>i||n.bottom<i){if(o=n.top>i?-1:1,i=Math.min(n.bottom-s,Math.max(n.top+s,i)),l)return-1;l=!0}if(n.type==Tu.Text)break;i=o>0?n.bottom+s:n.top-s}var u=n.from;if(u<e.viewport.from)return 0==e.viewport.from?0:-1;if(u>e.viewport.to)return e.viewport.to==e.state.doc.length?e.state.doc.length:-1;r=Math.max(a.left+1,Math.min(a.right-1,r));var c,h=e.root,f=h.elementFromPoint(r,i),d=-1;if(f&&e.contentDOM.contains(f)&&!(e.docView.nearest(f)instanceof wu))if(h.caretPositionFromPoint){var v,p=h.caretPositionFromPoint(r,i);p&&(c=(v=p).offsetNode,d=v.offset)}else if(h.caretRangeFromPoint){var g,m=h.caretRangeFromPoint(r,i);m&&(c=(g=m).startContainer,d=g.startOffset)}if(!c){var y=Wu.find(e.docView,u),k=function e(t,n,r){for(var i,o,a,s,l,u,c,h,f=t.firstChild;f;f=f.nextSibling)for(var d=Kl(f),v=0;v<d.length;v++){var p=d[v];o&&ah(o,p)&&(p=sh(lh(p,o.bottom),o.top));var g=ih(n,p),m=oh(r,p);if(0==g&&0==m)return 3==f.nodeType?uh(f,n,r):e(f,n,r);(!i||s>m||s==m&&a>g)&&(i=f,o=p,a=g,s=m),0==g?r>p.bottom&&(!c||c.bottom<p.bottom)?(l=f,c=p):r<p.top&&(!h||h.top>p.top)&&(u=f,h=p):c&&ah(c,p)?c=lh(c,p.bottom):h&&ah(h,p)&&(h=sh(h,p.top))}if(c&&c.bottom>=r?(i=l,o=c):h&&h.top<=r&&(i=u,o=h),!i)return{node:t,offset:0};var y=Math.max(o.left,Math.min(o.right,n));return 3==i.nodeType?uh(i,y,r):a||"true"!=i.contentEditable?{node:t,offset:Array.prototype.indexOf.call(t.childNodes,i)+(n>=(o.left+o.right)/2?1:0)}:e(i,y,r)}(y.dom,r,i);c=k.node,d=k.offset}return e.docView.posFromDOM(c,d)}function hh(e,t,n,r){for(var i=e.state.doc.lineAt(t.head),o=e.bidiSpans(i),a=t,s=null;;){var l=sc(i,o,e.textDirection,a,n),u=ac;if(!l){if(i.number==(n?e.state.doc.lines:1))return a;u="\n",i=e.state.doc.line(i.number+(n?1:-1)),o=e.bidiSpans(i),l=Os.cursor(n?i.from:i.to)}if(s){if(!s(u))return a}else{if(!r)return l;s=r(u)}a=l}}var fh=function(){function e(t){var n=this;_classCallCheck(this,e),this.lastKeyCode=0,this.lastKeyTime=0,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.scrollHandlers=[],this.registeredEvents=[],this.customHandlers=[],this.composing=!1,this.compositionEndedAt=0,this.mouseSelection=null;var r=function(e){var r=ph[e];t.contentDOM.addEventListener(e,(function(i){vh(t,i)&&!n.ignoreDuringComposition(i)&&(n.mustFlushObserver(i)&&t.observer.forceFlush(),n.runCustomHandlers(e,t,i)?i.preventDefault():r(t,i))})),n.registeredEvents.push(e)};for(var i in ph)r(i);t.contentDOM.addEventListener("keydown",(function(e){t.inputState.lastKeyCode=e.keyCode,t.inputState.lastKeyTime=Date.now()})),this.notifiedFocused=t.hasFocus,this.ensureHandlers(t)}return _createClass(e,[{key:"setSelectionOrigin",value:function(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}},{key:"ensureHandlers",value:function(e){var t,n=this,r=_createForOfIteratorHelper(this.customHandlers=e.pluginField(Hc));try{for(r.s();!(t=r.n()).done;){var i=t.value,o=function(t){n.registeredEvents.indexOf(t)<0&&"scroll"!=t&&(n.registeredEvents.push(t),e.contentDOM.addEventListener(t,(function(r){vh(e,r)&&n.runCustomHandlers(t,e,r)&&r.preventDefault()})))};for(var a in i.handlers)o(a)}}catch(s){r.e(s)}finally{r.f()}}},{key:"runCustomHandlers",value:function(e,t,n){var r,i=_createForOfIteratorHelper(this.customHandlers);try{for(i.s();!(r=i.n()).done;){var o=r.value,a=o.handlers[e];if(a)try{if(a.call(o.plugin,n,t)||n.defaultPrevented)return!0}catch(s){Pc(t.state,s)}}}catch(l){i.e(l)}finally{i.f()}return!1}},{key:"runScrollHandlers",value:function(e,t){var n,r=_createForOfIteratorHelper(this.customHandlers);try{for(r.s();!(n=r.n()).done;){var i=n.value,o=i.handlers.scroll;if(o)try{o.call(i.plugin,t,e)}catch(a){Pc(e.state,a)}}}catch(s){r.e(s)}finally{r.f()}}},{key:"ignoreDuringComposition",value:function(e){return!(!/^key/.test(e.type)||!this.composing&&(!(Gl.safari&&e.timeStamp-this.compositionEndedAt<500)||(this.compositionEndedAt=0,0)))}},{key:"mustFlushObserver",value:function(e){return"keydown"==e.type||"compositionend"==e.type}},{key:"startMouseSelection",value:function(e,t,n){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=new dh(this,e,t,n)}},{key:"update",value:function(e){this.mouseSelection&&this.mouseSelection.update(e),this.lastKeyCode=this.lastSelectionTime=0}},{key:"destroy",value:function(){this.mouseSelection&&this.mouseSelection.destroy()}}]),e}(),dh=function(){function e(t,n,r,i){_classCallCheck(this,e),this.inputState=t,this.view=n,this.startEvent=r,this.style=i;var o=n.contentDOM.ownerDocument;o.addEventListener("mousemove",this.move=this.move.bind(this)),o.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=r.shiftKey,this.multiple=n.state.facet(ol.allowMultipleSelections)&&function(e,t){var n=e.state.facet(_c);return n.length?n[0](t):Gl.mac?t.metaKey:t.ctrlKey}(n,r),this.dragMove=function(e,t){var n=e.state.facet(Cc);return n.length?n[0](t):Gl.mac?!t.altKey:!t.ctrlKey}(n,r),this.dragging=!!function(e,t){if(e.state.selection.primary.empty)return!1;var n=Zl(e.root);if(0==n.rangeCount)return!0;for(var r=n.getRangeAt(0).getClientRects(),i=0;i<r.length;i++){var o=r[i];if(o.left<=t.clientX&&o.right>=t.clientX&&o.top<=t.clientY&&o.bottom>=t.clientY)return!0}return!1}(n,r)&&null,!1===this.dragging&&(r.preventDefault(),this.select(r))}return _createClass(e,[{key:"move",value:function(e){if(0==e.buttons)return this.destroy();!1===this.dragging&&this.select(e)}},{key:"up",value:function(e){null==this.dragging&&this.select(this.startEvent),this.dragging||e.preventDefault(),this.destroy()}},{key:"destroy",value:function(){var e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.inputState.mouseSelection=null}},{key:"select",value:function(e){var t=this.style.get(e,this.extend,this.multiple);t.eq(this.view.state.selection)&&t.primary.assoc==this.view.state.selection.primary.assoc||this.view.dispatch({selection:t,annotations:Ys.userEvent.of("pointerselection"),scrollIntoView:!0})}},{key:"update",value:function(e){e.docChanged&&this.dragging&&(this.dragging=this.dragging.map(e.changes)),this.style.update(e)}}]),e}();function vh(e,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(var n,r=t.target;r!=e.contentDOM;r=r.parentNode)if(!r||11==r.nodeType||(n=fu.get(r))&&n.ignoreEvent(t))return!1;return!0}var ph=Object.create(null),gh=Gl.ie&&Gl.ie_version<15||Gl.ios&&Gl.webkit_version<604;function mh(e,t){var n,r=e.state,i=1,o=r.toText(t),a=o.lines==r.selection.ranges.length;n=Sh&&r.selection.ranges.every((function(e){return e.empty}))&&Sh==o.toString()?{changes:r.selection.ranges.map((function(e){return r.doc.lineAt(e.from)})).filter((function(e,t,n){return 0==t||n[t-1]!=e})).map((function(e){return{from:e.from,insert:(a?o.line(i++).slice():t)+r.lineBreak}}))}:a?r.changeByRange((function(e){var t=o.line(i++);return{changes:{from:e.from,to:e.to,insert:t.slice()},range:Os.cursor(e.from+t.length)}})):r.replaceSelection(o),e.dispatch(n,{annotations:Ys.userEvent.of("paste"),scrollIntoView:!0})}function yh(e,t,n,r){if(1==r)return Os.cursor(t,n);if(2==r)return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=e.charCategorizer(t),i=e.doc.lineAt(t),o=t-i.from;if(0==i.length)return Os.cursor(t);0==o?n=1:o==i.length&&(n=-1);var a=o,s=o;n<0?a=i.findClusterBreak(o,!1):s=i.findClusterBreak(o,!0);for(var l=r(i.slice(a,s));a>0;){var u=i.findClusterBreak(a,!1);if(r(i.slice(u,a))!=l)break;a=u}for(;s<i.length;){var c=i.findClusterBreak(s,!0);if(r(i.slice(s,c))!=l)break;s=c}return Os.range(a+i.from,s+i.from)}(e.state,t,n);var i=Wu.find(e.docView,t);if(i)return Os.range(i.posAtStart,i.posAtEnd);var o=e.state.doc.lineAt(t),a=o.from,s=o.to;return Os.range(a,s)}ph.keydown=function(e,t){(function(e){var t=(e.ctrlKey?1:0)|(e.metaKey?8:0)|(e.altKey?2:0)|(e.shiftKey?4:0),n=e.keyCode,r=Gl.mac&&1==t;return 8==n||r&&72==n||46==n||r&&68==n||27==n||t==(Gl.mac?8:1)&&(66==n||73==n||89==n||90==n)})(t)&&t.preventDefault(),e.inputState.setSelectionOrigin("keyboardselection")},ph.touchdown=ph.touchmove=function(e){e.inputState.setSelectionOrigin("pointerselection")},ph.mousedown=function(e,t){var n,r=null,i=_createForOfIteratorHelper(e.state.facet(Oc));try{for(i.s();!(n=i.n()).done;){if(r=(0,n.value)(e,t))break}}catch(o){i.e(o)}finally{i.f()}r||0!=t.button||(r=function(e,t){var n=_h(e,t),r=function(e){if(!Ch)return e.detail;var t=Oh;return Oh=e,xh=!t||t.timeStamp>Date.now()-400&&Math.abs(t.clientX-e.clientX)<2&&Math.abs(t.clientY-e.clientY)<2?(xh+1)%3:1}(t),i=e.state.selection,o=n,a=t;return{update:function(e){e.changes&&(n&&(n.pos=e.changes.mapPos(n.pos)),i=i.map(e.changes))},get:function(t,s,l){var u;if(t.clientX==a.clientX&&t.clientY==a.clientY?u=o:(u=o=_h(e,t),a=t),!u||!n)return i;var c=yh(e,u.pos,u.bias,r);if(n.pos!=u.pos&&!s){var h=yh(e,n.pos,n.bias,r),f=Math.min(h.from,c.from),d=Math.max(h.to,c.to);c=f<c.from?Os.range(f,d):Os.range(d,f)}return s?i.replaceRange(i.primary.extend(c.from,c.to)):l?i.addRange(c):Os.create([c])}}}(e,t)),r&&(e.root.activeElement!=e.contentDOM&&e.observer.ignore((function(){return lu(e.contentDOM)})),e.inputState.startMouseSelection(e,t,r))};var kh=function(e,t){return e>=t.top&&e<=t.bottom},bh=function(e,t,n){return kh(t,n)&&e>=n.left&&e<=n.right};function wh(e,t,n,r){var i=Wu.find(e.docView,t);if(!i)return 1;var o=t-i.posAtStart;if(0==o)return 1;if(o==i.length)return-1;var a=i.coordsAt(o,-1);if(a&&bh(n,r,a))return-1;var s=i.coordsAt(o,1);return s&&bh(n,r,s)?1:a&&kh(r,a)?-1:1}function _h(e,t){var n=e.posAtCoords({x:t.clientX,y:t.clientY});return n<0?null:{pos:n,bias:wh(e,n,t.clientX,t.clientY)}}var Ch=Gl.ie&&Gl.ie_version<=11,Oh=null,xh=0;ph.dragstart=function(e,t){var n=e.state.selection.primary,r=e.inputState.mouseSelection;r&&(r.dragging=n),t.dataTransfer&&(t.dataTransfer.setData("Text",e.state.sliceDoc(n.from,n.to)),t.dataTransfer.effectAllowed="copyMove")},ph.drop=function(e,t){if(t.dataTransfer){var n=e.posAtCoords({x:t.clientX,y:t.clientY}),r=t.dataTransfer.getData("Text");if(!(n<0)&&r){t.preventDefault();var i=e.inputState.mouseSelection,o=i&&i.dragging&&i.dragMove?{from:i.dragging.from,to:i.dragging.to}:null,a={from:n,insert:r},s=e.state.changes(o?[o,a]:a);e.focus(),e.dispatch({changes:s,selection:{anchor:s.mapPos(n,-1),head:s.mapPos(n,1)},annotations:Ys.userEvent.of("drop")})}}},ph.paste=function(e,t){e.observer.flush();var n=gh?null:t.clipboardData,r=n&&n.getData("text/plain");r?(mh(e,r),t.preventDefault()):function(e){var t=e.dom.parentNode;if(t){var n=t.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.focus(),setTimeout((function(){e.focus(),n.remove(),mh(e,n.value)}),50)}}(e)};var Sh=null;function Ah(e){e.docView.compositionDeco.size&&e.update([])}ph.copy=ph.cut=function(e,t){var n=function(e){var t,n=[],r=[],i=!1,o=_createForOfIteratorHelper(e.selection.ranges);try{for(o.s();!(t=o.n()).done;){var a=t.value;a.empty||(n.push(e.sliceDoc(a.from,a.to)),r.push(a))}}catch(f){o.e(f)}finally{o.f()}if(!n.length){var s,l=-1,u=_createForOfIteratorHelper(e.selection.ranges);try{for(u.s();!(s=u.n()).done;){var c=s.value.from,h=e.doc.lineAt(c);h.number>l&&(n.push(h.slice()),r.push({from:h.from,to:Math.min(e.doc.length,h.to+1)})),l=h.number}}catch(f){u.e(f)}finally{u.f()}i=!0}return{text:n.join(e.lineBreak),ranges:r,linewise:i}}(e.state),r=n.text,i=n.ranges,o=n.linewise;if(r){Sh=o?r:null;var a=gh?null:t.clipboardData;a?(t.preventDefault(),a.clearData(),a.setData("text/plain",r)):function(e,t){var n=e.dom.parentNode;if(n){var r=n.appendChild(document.createElement("textarea"));r.style.cssText="position: fixed; left: -10000px; top: 10px",r.value=t,r.focus(),r.selectionEnd=t.length,r.selectionStart=0,setTimeout((function(){r.remove(),e.focus()}),50)}}(e,r),"cut"==t.type&&e.dispatch({changes:i,scrollIntoView:!0,annotations:Ys.userEvent.of("cut")})}},ph.focus=ph.blur=function(e){setTimeout((function(){e.hasFocus!=e.inputState.notifiedFocused&&e.update([])}),10)},ph.beforeprint=function(e){e.viewState.printing=!0,e.requestMeasure(),setTimeout((function(){e.viewState.printing=!1,e.requestMeasure()}),2e3)},ph.compositionstart=ph.compositionupdate=function(e){e.inputState.composing||(e.docView.compositionDeco.size&&(e.observer.flush(),Ah(e)),e.inputState.composing=!0)},ph.compositionend=function(e){e.inputState.composing=!1,e.inputState.compositionEndedAt=Date.now(),setTimeout((function(){e.inputState.composing||Ah(e)}),50)};var Ph={childList:!0,characterData:!0,subtree:!0,characterDataOldValue:!0},Th=Gl.ie&&Gl.ie_version<=11,Ih=function(){function e(t,n,r){var i=this;_classCallCheck(this,e),this.view=t,this.onChange=n,this.onScrollChanged=r,this.active=!1,this.ignoreSelection=new au,this.delayedFlush=-1,this.queue=[],this.scrollTargets=[],this.intersection=null,this.intersecting=!1,this.parentCheck=-1,this.dom=t.contentDOM,this.observer=new MutationObserver((function(e){var t,n=_createForOfIteratorHelper(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;i.queue.push(r)}}catch(o){n.e(o)}finally{n.f()}Gl.ie&&Gl.ie_version<=11&&e.some((function(e){return"childList"==e.type&&e.removedNodes.length||"characterData"==e.type&&e.oldValue.length>e.target.nodeValue.length}))?i.flushSoon():i.flush()})),Th&&(this.onCharData=function(e){i.queue.push({target:e.target,type:"characterData",oldValue:e.prevValue}),i.flushSoon()}),this.onSelectionChange=function(){if(i.view.root.activeElement==i.dom){if(Gl.ie&&Gl.ie_version<=11&&!i.view.state.selection.primary.empty){var e=Zl(i.view.root);if(e.focusNode&&Jl(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return i.flushSoon()}i.flush()}},this.start(),this.onScroll=this.onScroll.bind(this),window.addEventListener("scroll",this.onScroll),"function"==typeof IntersectionObserver&&(this.intersection=new IntersectionObserver((function(e){i.parentCheck<0&&(i.parentCheck=setTimeout(i.listenForScroll.bind(i),1e3)),e[e.length-1].intersectionRatio>0!=i.intersecting&&(i.intersecting=!i.intersecting,i.onScrollChanged(document.createEvent("Event")))}),{}),this.intersection.observe(this.dom)),this.listenForScroll()}return _createClass(e,[{key:"onScroll",value:function(e){this.intersecting&&(this.flush(),this.onScrollChanged(e))}},{key:"listenForScroll",value:function(){this.parentCheck=-1;for(var e=0,t=null,n=this.dom;n;)if(1==n.nodeType)!t&&e<this.scrollTargets.length&&this.scrollTargets[e]==n?e++:t||(t=this.scrollTargets.slice(0,e)),t&&t.push(n),n=n.parentNode;else{if(11!=n.nodeType)break;n=n.host}if(e<this.scrollTargets.length&&!t&&(t=this.scrollTargets.slice(0,e)),t){var r,i=_createForOfIteratorHelper(this.scrollTargets);try{for(i.s();!(r=i.n()).done;){r.value.removeEventListener("scroll",this.onScroll)}}catch(s){i.e(s)}finally{i.f()}var o,a=_createForOfIteratorHelper(this.scrollTargets=t);try{for(a.s();!(o=a.n()).done;){o.value.addEventListener("scroll",this.onScroll)}}catch(s){a.e(s)}finally{a.f()}}}},{key:"ignore",value:function(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}},{key:"start",value:function(){this.active||(this.observer.observe(this.dom,Ph),this.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange),Th&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}},{key:"stop",value:function(){this.active&&(this.active=!1,this.observer.disconnect(),this.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange),Th&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}},{key:"clearSelection",value:function(){this.ignoreSelection.set(Zl(this.view.root))}},{key:"clear",value:function(){this.observer.takeRecords(),this.queue.length=0,this.clearSelection()}},{key:"flushSoon",value:function(){var e=this;this.delayedFlush<0&&(this.delayedFlush=window.setTimeout((function(){e.delayedFlush=-1,e.flush()}),20))}},{key:"forceFlush",value:function(){this.delayedFlush>=0&&(window.clearTimeout(this.delayedFlush),this.delayedFlush=-1,this.flush())}},{key:"flush",value:function(){var e=this;if(!(this.delayedFlush>=0)){var t,n=this.queue,r=_createForOfIteratorHelper(this.observer.takeRecords());try{for(r.s();!(t=r.n()).done;){var i=t.value;n.push(i)}}catch(g){r.e(g)}finally{r.f()}n.length&&(this.queue=[]);var o=Zl(this.view.root),a=!this.ignoreSelection.eq(o)&&Yl(this.dom,o);if(0!=n.length||a){var s,l=-1,u=-1,c=!1,h=_createForOfIteratorHelper(n);try{for(h.s();!(s=h.n()).done;){var f,d=s.value,v=this.readMutation(d);v&&(v.typeOver&&(c=!0),-1==l?(l=(f=v).from,u=f.to):(l=Math.min(v.from,l),u=Math.max(v.to,u)))}}catch(g){h.e(g)}finally{h.f()}var p=this.view.state;(l>-1||a)&&this.onChange(l,u,c),this.view.state==p&&(this.view.docView.dirty&&(this.ignore((function(){return e.view.docView.sync()})),this.view.docView.dirty=0),this.view.docView.updateSelection()),this.clearSelection()}}}},{key:"readMutation",value:function(e){var t=this.view.docView.nearest(e.target);if(!t||t.ignoreMutation(e))return null;if(t.markDirty(),"childList"==e.type){var n=Eh(t,e.previousSibling||e.target.previousSibling,-1),r=Eh(t,e.nextSibling||e.target.nextSibling,1);return{from:n?t.posAfter(n):t.posAtStart,to:r?t.posBefore(r):t.posAtEnd,typeOver:!1}}return{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}}},{key:"destroy",value:function(){this.stop(),this.intersection&&this.intersection.disconnect();var e,t=_createForOfIteratorHelper(this.scrollTargets);try{for(t.s();!(e=t.n()).done;){e.value.removeEventListener("scroll",this.onScroll)}}catch(n){t.e(n)}finally{t.f()}window.removeEventListener("scroll",this.onScroll),clearTimeout(this.parentCheck)}}]),e}();function Eh(e,t,n){for(;t;){var r=fu.get(t);if(r&&r.parent==e)return r;var i=t.parentNode;t=i!=e.dom?i:n>0?t.nextSibling:t.previousSibling}return null}var Dh=function(){function e(t){_classCallCheck(this,e),this.points=t,this.text=""}return _createClass(e,[{key:"readRange",value:function(e,t){if(e){for(var n=e.parentNode,r=e;;){this.findPointBefore(n,r),this.readNode(r);var i=r.nextSibling;if(i==t)break;var o=fu.get(r),a=fu.get(i);((o?o.breakAfter:Mh(r))||(a?a.breakAfter:Mh(i))&&("BR"!=r.nodeName||r.cmIgnore))&&(this.text+="\ufdda"),r=i}this.findPointBefore(n,t)}}},{key:"readNode",value:function(e){if(!e.cmIgnore){var t,n=fu.get(e),r=n&&n.overrideDOMText;null!=r?t=r.sliceString(0,void 0,"\ufdda"):3==e.nodeType?t=e.nodeValue:"BR"==e.nodeName?t=e.nextSibling?"\ufdda":"":1==e.nodeType&&this.readRange(e.firstChild,null),null!=t&&(this.findPointIn(e,t.length),this.text+=t)}}},{key:"findPointBefore",value:function(e,t){var n,r=_createForOfIteratorHelper(this.points);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.node==e&&e.childNodes[i.offset]==t&&(i.pos=this.text.length)}}catch(o){r.e(o)}finally{r.f()}}},{key:"findPointIn",value:function(e,t){var n,r=_createForOfIteratorHelper(this.points);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.node==e&&(i.pos=this.text.length+Math.min(i.offset,t))}}catch(o){r.e(o)}finally{r.f()}}}]),e}();function Mh(e){return 1==e.nodeType&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(e.nodeName)}var Qh=function e(t,n){_classCallCheck(this,e),this.node=t,this.offset=n,this.pos=-1};function Rh(e,t,n){var r={key:t,code:t,keyCode:n,which:n,cancelable:!0},i=new KeyboardEvent("keydown",r);e.contentDOM.dispatchEvent(i);var o=new KeyboardEvent("keyup",r);return e.contentDOM.dispatchEvent(o),i.defaultPrevented||o.defaultPrevented}var Hh=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,e),this.plugins=[],this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.className=Vu("scroller"),this.scrollDOM.appendChild(this.contentDOM),this.dom=document.createElement("div"),this.dom.appendChild(this.scrollDOM),this._dispatch=n.dispatch||function(e){return t.update([e])},this.dispatch=this.dispatch.bind(this),this.root=n.root||document,this.viewState=new Wc(n.state||ol.create()),this.plugins=this.state.facet(Mc).map((function(e){return Nc.create(e,t)})),this.observer=new Ih(this,(function(e,n,r){return function(e,t,n,r){var i,o,a,s=e.state.selection.primary;if(t>-1&&(a=e.docView.domBoundsAround(t,n,0))){var l=a,u=l.from,c=l.to,h=e.docView.impreciseHead||e.docView.impreciseAnchor?[]:function(e,t){var n=[];if(t.activeElement!=e)return n;var r=Zl(t),i=r.anchorNode,o=r.anchorOffset,a=r.focusNode,s=r.focusOffset;return i&&(n.push(new Qh(i,o)),a==i&&s==o||n.push(new Qh(a,s))),n}(e.contentDOM,e.root),f=new Dh(h);f.readRange(a.startDOM,a.endDOM),o=function(e,t){if(0==e.length)return null;var n=e[0].pos,r=2==e.length?e[1].pos:n;return n>-1&&r>-1?Os.single(n+t,r+t):null}(h,u);var d=s.from,v=null;8===e.inputState.lastKeyCode&&e.inputState.lastKeyTime>Date.now()-100&&(d=s.to,v="end");var p=function(e,t,n,r){for(var i=Math.min(e.length,t.length),o=0;o<i&&e.charCodeAt(o)==t.charCodeAt(o);)o++;if(o==i&&e.length==t.length)return null;for(var a=e.length,s=t.length;a>0&&s>0&&e.charCodeAt(a-1)==t.charCodeAt(s-1);)a--,s--;return"end"==r&&(n-=a+Math.max(0,o-Math.min(a,s))-o),a<o&&e.length<t.length?(s=(o-=n<=o&&n>=a?o-n:0)+(s-a),a=o):s<o&&(a=(o-=n<=o&&n>=s?o-n:0)+(a-s),s=o),{from:o,toA:a,toB:s}}(e.state.doc.sliceString(u,c,"\ufdda"),f.text,d-u,v);p&&(i={from:u+p.from,to:u+p.toA,insert:Ha.of(f.text.slice(p.from,p.toB).split("\ufdda"))})}else if(e.hasFocus){var g=Zl(e.root),m=e.docView,y=m.impreciseHead,k=m.impreciseAnchor,b=y&&y.node==g.focusNode&&y.offset==g.focusOffset?e.state.selection.primary.head:e.docView.posFromDOM(g.focusNode,g.focusOffset),w=k&&k.node==g.anchorNode&&k.offset==g.anchorOffset?e.state.selection.primary.anchor:function(e){var t=e.isCollapsed;return t&&Gl.chrome&&e.rangeCount&&!e.getRangeAt(0).collapsed&&(t=!1),t}(g)?b:e.docView.posFromDOM(g.anchorNode,g.anchorOffset);b==s.head&&w==s.anchor||(o=Os.single(w,b))}if(i||o)if(!i&&r&&!s.empty&&o&&o.primary.empty&&(i={from:s.from,to:s.to,insert:e.state.doc.slice(s.from,s.to)}),i){var _=e.state;if(Gl.android&&(i.from==s.from&&i.to==s.to&&1==i.insert.length&&2==i.insert.lines&&Rh(e,"Enter",10)||i.from==s.from-1&&i.to==s.to&&0==i.insert.length&&Rh(e,"Backspace",8)||i.from==s.from&&i.to==s.to+1&&0==i.insert.length&&Rh(e,"Delete",46)))return;var C,O=i.insert.toString();if(e.state.facet(Ac).some((function(t){return t(e,i.from,i.to,O)})))return;if(i.from>=s.from&&i.to<=s.to&&i.to-i.from>=(s.to-s.from)/3){var x=s.from<i.from?_.doc.sliceString(s.from,i.from,"\ufdda"):"",S=s.to>i.to?_.doc.sliceString(i.to,s.to,"\ufdda"):"";C=_.replaceSelection(Ha.of((x+i.insert.sliceString(0,void 0,"\ufdda")+S).split("\ufdda")))}else{var A=_.changes(i);C={changes:A,selection:o&&!_.selection.primary.eq(o.primary)&&o.primary.to<=A.newLength?_.selection.replaceRange(o.primary):void 0}}e.dispatch(C,{scrollIntoView:!0,annotations:Ys.userEvent.of("input")})}else if(o&&!o.primary.eq(s)){var P,T=!1;e.inputState.lastSelectionTime>Date.now()-50&&("keyboardselection"==e.inputState.lastSelectionOrigin?T=!0:P=Ys.userEvent.of(e.inputState.lastSelectionOrigin)),e.dispatch({selection:o,scrollIntoView:T,annotations:P})}}(t,e,n,r)}),(function(e){t.inputState.runScrollHandlers(t,e),t.measure()})),this.docView=new Kc(this),this.inputState=new fh(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,window.addEventListener("resize",(function(){-1==Fh&&(Fh=setTimeout($h,50))})),this.requestMeasure(),n.parent&&n.parent.appendChild(this.dom)}return _createClass(e,[{key:"dispatch",value:function(){var e;this._dispatch(1==arguments.length&&(arguments.length<=0?void 0:arguments[0])instanceof Ys?arguments.length<=0?void 0:arguments[0]:(e=this.state).update.apply(e,arguments))}},{key:"update",value:function(e){if(0!=this.updateState)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");this.updateState=2;var t,n=this.state,r=_createForOfIteratorHelper(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(i.startState!=n)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");n=i.state}}catch(c){r.e(c)}finally{r.f()}var o=new zc(this,n,e),a=e.some((function(e){return e.scrollIntoView}))?n.selection.primary:null;this.viewState.update(o,a),this.bidiCache=Vh.update(this.bidiCache,o.changes),o.empty||this.updatePlugins(o);var s=this.docView.update(o);this.state.facet(Bc)!=this.styleModules&&this.mountStyles(),this.updateAttrs(),this.updateState=0,(s||a||this.viewState.mustEnforceCursorAssoc)&&this.requestMeasure();var l,u=_createForOfIteratorHelper(this.state.facet(Sc));try{for(u.s();!(l=u.n()).done;){(0,l.value)(o)}}catch(c){u.e(c)}finally{u.f()}}},{key:"setState",value:function(e){var t=this;if(0!=this.updateState)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");this.updateState=2;var n,r=_createForOfIteratorHelper(this.plugins);try{for(r.s();!(n=r.n()).done;){n.value.destroy(this)}}catch(i){r.e(i)}finally{r.f()}this.viewState=new Wc(e),this.plugins=e.facet(Mc).map((function(e){return Nc.create(e,t)})),this.docView=new Kc(this),this.inputState.ensureHandlers(this),this.mountStyles(),this.updateAttrs(),this.bidiCache=[],this.updateState=0,this.requestMeasure()}},{key:"updatePlugins",value:function(e){var t=e.prevState.facet(Mc),n=e.state.facet(Mc);if(t!=n){var r,i=[],o=[],a=_createForOfIteratorHelper(n);try{for(a.s();!(r=a.n()).done;){var s=r.value,l=t.indexOf(s);if(l<0)i.push(Nc.create(s,this));else{var u=this.plugins[l].update(e);o.push(u),i.push(u)}}}catch(v){a.e(v)}finally{a.f()}var c,h=_createForOfIteratorHelper(this.plugins);try{for(h.s();!(c=h.n()).done;){var f=c.value;o.indexOf(f)<0&&f.destroy(this)}}catch(v){h.e(v)}finally{h.f()}this.plugins=i,this.inputState.ensureHandlers(this)}else for(var d=0;d<this.plugins.length;d++)this.plugins[d]=this.plugins[d].update(e)}},{key:"measure",value:function(){var e=this;this.measureScheduled>-1&&cancelAnimationFrame(this.measureScheduled),this.measureScheduled=-1;for(var t=null,n=0;;n++){this.updateState=1;var r=this.viewState.measure(this.docView,n>0),i=this.measureRequests;if(!r&&!i.length&&null==this.viewState.scrollTo)break;if(this.measureRequests=[],n>5){console.warn("Viewport failed to stabilize");break}var o=i.map((function(t){try{return t.read(e)}catch(n){return Pc(e.state,n),Bh}})),a=new zc(this,this.state);a.flags|=r,t?t.flags|=r:t=a,this.updateState=2,this.updatePlugins(a),r&&this.docView.update(a);for(var s=0;s<i.length;s++)if(o[s]!=Bh)try{i[s].write(o[s],this)}catch(c){Pc(this.state,c)}if(this.viewState.scrollTo&&(this.docView.scrollPosIntoView(this.viewState.scrollTo.head,this.viewState.scrollTo.assoc),this.viewState.scrollTo=null),!(4&r)&&0==this.measureRequests.length)break}if(this.updateState=0,this.measureScheduled=-1,t){var l,u=_createForOfIteratorHelper(this.state.facet(Sc));try{for(u.s();!(l=u.n()).done;){(0,l.value)(t)}}catch(h){u.e(h)}finally{u.f()}}}},{key:"updateAttrs",value:function(){var e=Su(this.state.facet(Lc),{class:Vu("wrap")+(this.hasFocus?" cm-focused ":" ")+this.themeClasses});Pu(this.dom,this.editorAttrs,e),this.editorAttrs=e;var t=Su(this.state.facet(Fc),{spellcheck:"false",contenteditable:String(this.state.facet(Tc)),class:Vu("content"),style:"".concat(Gl.tabSize,": ").concat(this.state.tabSize),role:"textbox","aria-multiline":"true"});Pu(this.contentDOM,this.contentAttrs,t),this.contentAttrs=t}},{key:"mountStyles",value:function(){this.styleModules=this.state.facet(Bc),cl.mount(this.root,this.styleModules.concat(ju).reverse())}},{key:"domAtPos",value:function(e){return this.docView.domAtPos(e)}},{key:"posAtDOM",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.docView.posFromDOM(e,t)}},{key:"readMeasured",value:function(){if(2==this.updateState)throw new Error("Reading the editor layout isn't allowed during an update");0==this.updateState&&this.measureScheduled>-1&&this.measure()}},{key:"requestMeasure",value:function(e){var t=this;if(this.measureScheduled<0&&(this.measureScheduled=requestAnimationFrame((function(){return t.measure()}))),e){if(null!=e.key)for(var n=0;n<this.measureRequests.length;n++)if(this.measureRequests[n].key===e.key)return void(this.measureRequests[n]=e);this.measureRequests.push(e)}}},{key:"pluginField",value:function(e){var t,n=[],r=_createForOfIteratorHelper(this.plugins);try{for(r.s();!(t=r.n()).done;){t.value.takeField(e,n)}}catch(i){r.e(i)}finally{r.f()}return n}},{key:"plugin",value:function(e){var t,n=_createForOfIteratorHelper(this.plugins);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.spec==e)return r.value}}catch(i){n.e(i)}finally{n.f()}return null}},{key:"blockAtHeight",value:function(e,t){return this.readMeasured(),this.viewState.blockAtHeight(e,Lh(t,this.contentDOM))}},{key:"visualLineAtHeight",value:function(e,t){return this.readMeasured(),this.viewState.lineAtHeight(e,Lh(t,this.contentDOM))}},{key:"visualLineAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.viewState.lineAt(e,t)}},{key:"viewportLines",value:function(e,t){var n=this.viewport,r=n.from,i=n.to;this.viewState.forEachLine(r,i,e,Lh(t,this.contentDOM))}},{key:"moveByChar",value:function(e,t,n){return hh(this,e,t,n)}},{key:"moveByGroup",value:function(e,t){var n=this;return hh(this,e,t,(function(t){return function(e,t,n){var r=e.state.charCategorizer(t),i=r(n);return function(e){var t=r(e);return i==tl.Space&&(i=t),i==t}}(n,e.head,t)}))}},{key:"moveToLineBoundary",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return function(e,t,n,r){var i=e.state.doc.lineAt(t.head),o=r&&e.lineWrapping?e.coordsAtPos(t.assoc<0&&t.head>i.from?t.head-1:t.head):null;if(o){var a=e.dom.getBoundingClientRect(),s=e.posAtCoords({x:n==(e.textDirection==zu.LTR)?a.right-1:a.left+1,y:(o.top+o.bottom)/2});if(s>-1)return Os.cursor(s,n?-1:1)}var l=Wu.find(e.docView,t.head);return Os.cursor(l?n?l.posAtEnd:l.posAtStart:n?i.to:i.from,n?-1:1)}(this,e,t,n)}},{key:"moveVertically",value:function(e,t,n){return function(e,t,n,r){var i,o=t.head,a=n?1:-1;if(o==(n?e.state.doc.length:0))return Os.cursor(o);var s=e.coordsAtPos(o);if(s)for(var l=e.dom.getBoundingClientRect(),u=null!==(i=t.goalColumn)&&void 0!==i?i:s.left-l.left,c=l.left+u,h=null!=r?r:5,f=a<0?s.top:s.bottom,d=0;d<50;d+=10){var v=ch(e,{x:c,y:f+(h+d)*a},a);if(v<0)break;if(v!=o)return Os.cursor(v,void 0,void 0,u)}var p=e.state.doc,g=p.lineAt(o),m=e.state.tabSize,y=t.goalColumn,k=0;if(null==y){for(var b=p.iterRange(g.from,o);!b.next().done;)k=Qa(b.value,k,m);y=k*e.defaultCharacterWidth}else k=Math.round(y/e.defaultCharacterWidth);if(a<0&&0==g.from)return Os.cursor(0);if(a>0&&g.to==p.length)return Os.cursor(g.to);for(var w=p.line(g.number+a),_=w.from,C=0,O=p.iterRange(w.from,w.to);C>=k&&!O.next().done;){var x=Ra(O.value,C,k,m),S=x.offset;C=k-x.leftOver,_+=S}return Os.cursor(_,void 0,void 0,y)}(this,e,t,n)}},{key:"scrollPosIntoView",value:function(e){this.viewState.scrollTo=Os.cursor(e),this.requestMeasure()}},{key:"posAtCoords",value:function(e){return this.readMeasured(),ch(this,e)}},{key:"coordsAtPos",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.readMeasured();var n=this.docView.coordsAt(e,t);if(!n||n.left==n.right)return n;var r=this.state.doc.lineAt(e),i=this.bidiSpans(r);return ru(n,i[rc.find(i,e-r.from,-1,t)].dir==zu.LTR==t>0)}},{key:"bidiSpans",value:function(e){if(e.length>Nh)return oc(e.length);var t,n=this.textDirection,r=_createForOfIteratorHelper(this.bidiCache);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(i.from==e.from&&i.dir==n)return i.order}}catch(a){r.e(a)}finally{r.f()}var o=function(e,t){var n,r=e.length,i=t==Yu?1:2;if(!e||1==i&&!nc.test(e))return oc(r);for(var o=0,a=i,s=i;o<r;o++){var l=(n=e.charCodeAt(o))<=247?ec[n]:1424<=n&&n<=1524?2:1536<=n&&n<=1785?tc[n-1536]:1774<=n&&n<=2220?4:8192<=n&&n<=8203||8204==n?256:1;512==l?l=a:8==l&&4==s&&(l=16),ic[o]=4==l?2:l,7&l&&(s=l),a=l}for(var u=0,c=i,h=i;u<r;u++){var f=ic[u];if(128==f)u<r-1&&c==ic[u+1]&&24&c?f=ic[u]=c:ic[u]=256;else if(64==f){for(var d=u+1;d<r&&64==ic[d];)d++;for(var v=u&&8==c||d<r&&8==ic[d]?1==h?1:8:256,p=u;p<d;p++)ic[p]=v;u=d-1}else 8==f&&1==h&&(ic[u]=1);c=f,7&f&&(h=f)}for(var g=0;g<r;g++)if(256==ic[g]){for(var m=g+1;m<r&&256==ic[m];)m++;for(var y=1==(g?ic[g-1]:i),k=y==(1==(m<r?ic[m]:i))?y?1:2:i,b=g;b<m;b++)ic[b]=k;g=m-1}var w=[];if(1==i)for(var _=0;_<r;){for(var C=_,O=1!=ic[_++];_<r&&O==(1!=ic[_]);)_++;if(O)for(var x=_;x>C;){for(var S=x,A=2!=ic[--x];x>C&&A==(2!=ic[x-1]);)x--;w.push(new rc(x,S,A?2:1))}else w.push(new rc(C,_,0))}else for(var P=0;P<r;){for(var T=P,I=2==ic[P++];P<r&&I==(2==ic[P]);)P++;w.push(new rc(T,P,I?1:2))}return w}(e.slice(),this.textDirection);return this.bidiCache.push(new Vh(e.from,e.to,n,o)),o}},{key:"focus",value:function(){var e=this;this.observer.ignore((function(){lu(e.contentDOM),e.docView.updateSelection()}))}},{key:"destroy",value:function(){var e,t=_createForOfIteratorHelper(this.plugins);try{for(t.s();!(e=t.n()).done;){e.value.destroy(this)}}catch(n){t.e(n)}finally{t.f()}this.inputState.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&cancelAnimationFrame(this.measureScheduled)}},{key:"state",get:function(){return this.viewState.state}},{key:"viewport",get:function(){return this.viewState.viewport}},{key:"visibleRanges",get:function(){return this.viewState.visibleRanges}},{key:"inView",get:function(){return this.viewState.inView}},{key:"composing",get:function(){return this.inputState.composing}},{key:"themeClasses",get:function(){return Fu+" "+(this.state.facet(Lu)?"cm-dark":"cm-light")+" "+this.state.facet(Nu)}},{key:"contentHeight",get:function(){return this.viewState.heightMap.height+this.viewState.paddingTop+this.viewState.paddingBottom}},{key:"defaultCharacterWidth",get:function(){return this.viewState.heightOracle.charWidth}},{key:"defaultLineHeight",get:function(){return this.viewState.heightOracle.lineHeight}},{key:"textDirection",get:function(){return this.viewState.heightOracle.direction}},{key:"lineWrapping",get:function(){return this.viewState.heightOracle.lineWrapping}},{key:"hasFocus",get:function(){return this.root.activeElement==this.contentDOM}}],[{key:"domEventHandlers",value:function(e){return Qc.define((function(){return{}}),{eventHandlers:e})}},{key:"theme",value:function(e,t){var n=cl.newName(),r=[Nu.of(n),Bc.of(Bu(n,e))];return t&&t.dark&&r.push(Lu.of(!0)),r}},{key:"baseTheme",value:function(e){return Qs(Bc.of(Bu(Fu,e)),"fallback")}}]),e}();Hh.styleModule=Bc,Hh.inputHandler=Ac,Hh.exceptionSink=xc,Hh.updateListener=Sc,Hh.editable=Tc,Hh.dragMovesSelection=Cc,Hh.clickAddsSelectionRange=_c,Hh.mouseSelectionStyle=Oc,Hh.decorations=$c,Hh.lineWrapping=Hh.theme({$content:{whiteSpace:"pre-wrap"}}),Hh.contentAttributes=Fc,Hh.editorAttributes=Lc;var Nh=4096;function Lh(e,t){return null==e?t.getBoundingClientRect().top:e}var Fh=-1;function $h(){Fh=-1;for(var e=document.querySelectorAll(".cm-content"),t=0;t<e.length;t++){var n=fu.get(e[t]);n&&n.editorView.requestMeasure()}}var Bh={},Vh=function(){function e(t,n,r,i){_classCallCheck(this,e),this.from=t,this.to=n,this.dir=r,this.order=i}return _createClass(e,null,[{key:"update",value:function(t,n){if(n.empty)return t;for(var r=[],i=t.length?t[t.length-1].dir:zu.LTR,o=Math.max(0,t.length-10);o<t.length;o++){var a=t[o];a.dir!=i||n.touchesRange(a.from,a.to)||r.push(new e(n.mapPos(a.from,1),n.mapPos(a.to,-1),a.dir,a.order))}return r}}]),e}(),zh="undefined"==typeof navigator?"key":/Mac/.test(navigator.platform)?"mac":/Win/.test(navigator.platform)?"win":/Linux|X11/.test(navigator.platform)?"linux":"key";function jh(e,t,n){return t.altKey&&(e="Alt-"+e),t.ctrlKey&&(e="Ctrl-"+e),t.metaKey&&(e="Meta-"+e),!1!==n&&t.shiftKey&&(e="Shift-"+e),e}var qh=Ps.define(),Wh=Hh.domEventHandlers({keydown:function(e,t){return Zh(t.state.facet(qh),e,t,"editor")}});function Uh(e,t){return[Wh,qh.of(Gh(e,t))]}var Xh=null;function Gh(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:zh,r=Object.create(null),i=Object.create(null),o=function(e,t){var n=i[e];if(null==n)i[e]=t;else if(n!=t)throw new Error("Key binding "+e+" is used both as a regular binding and as a multi-stroke prefix")},a=function(e,t,i,a){for(var s=r[e]||(r[e]=Object.create(null)),l=t.split(/ (?!$)/).map((function(e){return function(e,t){var n,r,i,o,a=e.split(/-(?!$)/),s=a[a.length-1];"Space"==s&&(s=" ");for(var l=0;l<a.length-1;++l){var u=a[l];if(/^(cmd|meta|m)$/i.test(u))o=!0;else if(/^a(lt)?$/i.test(u))n=!0;else if(/^(c|ctrl|control)$/i.test(u))r=!0;else if(/^s(hift)?$/i.test(u))i=!0;else{if(!/^mod$/i.test(u))throw new Error("Unrecognized modifier name: "+u);"mac"==t?o=!0:r=!0}}return n&&(s="Alt-"+s),r&&(s="Ctrl-"+s),o&&(s="Meta-"+s),i&&(s="Shift-"+s),s}(e,n)})),u=function(t){var n=l.slice(0,t).join(" ");o(n,!0),s[n]||(s[n]={preventDefault:!0,commands:[function(t){var r=Xh={view:t,prefix:n,scope:e};return setTimeout((function(){Xh==r&&(Xh=null)}),4e3),!0}]})},c=1;c<l.length;c++)u(c);var h=l.join(" ");o(h,!1);var f=s[h]||(s[h]={preventDefault:!1,commands:[]});f.commands.push(i),a&&(f.preventDefault=!0)},s=_createForOfIteratorHelper(e);try{for(s.s();!(t=s.n()).done;){var l=t.value,u=l[n]||l.key;if(u){var c,h=_createForOfIteratorHelper(l.scope?l.scope.split(" "):["editor"]);try{for(h.s();!(c=h.n()).done;){var f=c.value;a(f,u,l.run,l.preventDefault),l.shift&&a(f,"Shift-"+u,l.shift,l.preventDefault)}}catch(d){h.e(d)}finally{h.f()}}}}catch(d){s.e(d)}finally{s.f()}return r}function Zh(e,t,n,r){var i=function(e){var t=!(Hl&&(e.ctrlKey||e.altKey||e.metaKey)||(Dl||Rl)&&e.shiftKey&&e.key&&1==e.key.length)&&e.key||(e.shiftKey?Il:Tl)[e.keyCode]||e.key||"Unidentified";return"Esc"==t&&(t="Escape"),"Del"==t&&(t="Delete"),"Left"==t&&(t="ArrowLeft"),"Up"==t&&(t="ArrowUp"),"Right"==t&&(t="ArrowRight"),"Down"==t&&(t="ArrowDown"),t}(t),o=1==i.length&&" "!=i,a="";Xh&&Xh.view==n&&Xh.scope==r&&(a=Xh.prefix+" ",Xh=null);var s,l=!!a,u=function(e){if(e){var t,r=_createForOfIteratorHelper(e.commands);try{for(r.s();!(t=r.n()).done;){if((0,t.value)(n))return!0}}catch(i){r.e(i)}finally{r.f()}e.preventDefault&&(l=!0)}return!1},c=_createForOfIteratorHelper(e);try{for(c.s();!(s=c.n()).done;){var h=s.value,f=void 0,d=h[r];if(d){if(u(d[a+jh(i,t,!o)]))return!0;if(o&&(t.shiftKey||t.altKey||t.metaKey)&&(f=Tl[t.keyCode])&&f!=i){if(u(d[a+jh(f,t,!0)]))return!0}else if(o&&t.shiftKey&&u(d[a+jh(i,t,!0)]))return!0}}}catch(v){c.e(v)}finally{c.f()}return l}var Yh=!Gl.ios,Kh=Ps.define({combine:function(e){return al(e,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:function(e,t){return Math.min(e,t)},drawRangeCursor:function(e,t){return e||t}})}}),Jh=function(){function e(t,n,r,i,o){_classCallCheck(this,e),this.left=t,this.top=n,this.width=r,this.height=i,this.className=o}return _createClass(e,[{key:"draw",value:function(){var e=document.createElement("div");return e.className=this.className,e.style.left=this.left+"px",e.style.top=this.top+"px",this.width>=0&&(e.style.width=this.width+"px"),e.style.height=this.height+"px",e}},{key:"eq",value:function(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}}]),e}(),ef=Qc.fromClass(function(){function e(t){_classCallCheck(this,e),this.view=t,this.rangePieces=[],this.cursors=[],this.measureReq={read:this.readPos.bind(this),write:this.drawSel.bind(this)},this.selectionLayer=t.scrollDOM.appendChild(document.createElement("div")),this.selectionLayer.className=Vu("selectionLayer"),this.selectionLayer.setAttribute("aria-hidden","true"),this.cursorLayer=t.scrollDOM.appendChild(document.createElement("div")),this.cursorLayer.className=Vu("cursorLayer"),this.cursorLayer.setAttribute("aria-hidden","true"),t.requestMeasure(this.measureReq),this.setBlinkRate()}return _createClass(e,[{key:"setBlinkRate",value:function(){this.cursorLayer.style.animationDuration=this.view.state.facet(Kh).cursorBlinkRate+"ms"}},{key:"update",value:function(e){var t=e.prevState.facet(Kh)!=e.state.facet(Kh);(t||e.selectionSet||e.geometryChanged||e.viewportChanged)&&this.view.requestMeasure(this.measureReq),e.transactions.some((function(e){return e.scrollIntoView}))&&(this.cursorLayer.style.animationName="cm-blink"==this.cursorLayer.style.animationName?"cm-blink2":"cm-blink"),t&&this.setBlinkRate()}},{key:"readPos",value:function(){var e,t=this,n=this.view.state,r=n.facet(Kh),i=n.selection.ranges.map((function(e){return e.empty?[]:function(e,t){if(t.to<=e.viewport.from||t.from>=e.viewport.to)return[];var n=Math.max(t.from,e.viewport.from),r=Math.min(t.to,e.viewport.to),i=e.textDirection==zu.LTR,o=e.contentDOM,a=o.getBoundingClientRect(),s=e.scrollDOM.getBoundingClientRect(),l=window.getComputedStyle(o.firstChild),u=a.left+parseInt(l.paddingLeft),c=a.right-parseInt(l.paddingRight),h=e.visualLineAt(n),f=e.visualLineAt(r);if(h.from==f.from)return m(y(t.from,t.to));var d=y(t.from,null),v=y(null,t.to),p=[];return h.to<f.from-1?p.push(g(u,d.bottom,c,v.top)):d.bottom<v.top&&v.top-d.bottom<4&&(d.bottom=v.top=(d.bottom+v.top)/2),m(d).concat(p).concat(m(v));function g(e,t,n,r){return new Jh(e-s.left,t-s.top,n-e,r-t,rf)}function m(e){for(var t=e.top,n=e.bottom,r=e.horizontal,i=[],o=0;o<r.length;o+=2)i.push(g(r[o],t,r[o+1],n));return i}function y(t,n){var r=1e9,o=-1e9,a=[];function s(t,n,s,l,h){var f=e.coordsAtPos(t,1),d=e.coordsAtPos(s,-1);r=Math.min(f.top,d.top,r),o=Math.max(f.bottom,d.bottom,o),h==zu.LTR?a.push(i&&n?u:f.left,i&&l?c:d.right):a.push(!i&&l?u:d.left,!i&&n?c:f.right)}var l,h=null!=t?t:e.moveToLineBoundary(Os.cursor(n,1),!1).head,f=null!=n?n:e.moveToLineBoundary(Os.cursor(t,-1),!0).head,d=_createForOfIteratorHelper(e.visibleRanges);try{for(d.s();!(l=d.n()).done;){var v=l.value;if(v.to>h&&v.from<f)for(var p=Math.max(v.from,h),g=Math.min(v.to,f);;){var m,y=e.state.doc.lineAt(p),k=_createForOfIteratorHelper(e.bidiSpans(y));try{for(k.s();!(m=k.n()).done;){var b=m.value,w=b.from+y.from,_=b.to+y.from;if(w>=g)break;_>p&&s(Math.max(w,p),null==t&&w<=h,Math.min(_,g),null==n&&_>=f,b.dir)}}catch(O){k.e(O)}finally{k.f()}if((p=y.to+1)>=g)break}}}catch(O){d.e(O)}finally{d.f()}if(0==a.length){var C=e.coordsAtPos(h,-1);r=Math.min(C.top,r),o=Math.max(C.bottom,o)}return{top:r,bottom:o,horizontal:a}}}(t.view,e)})).reduce((function(e,t){return e.concat(t)})),o=[],a=_createForOfIteratorHelper(n.selection.ranges);try{for(a.s();!(e=a.n()).done;){var s=e.value,l=s==n.selection.primary;if(s.empty?!l||Yh:r.drawRangeCursor){var u=sf(this.view,s,l);u&&o.push(u)}}}catch(c){a.e(c)}finally{a.f()}return{rangePieces:i,cursors:o}}},{key:"drawSel",value:function(e){var t=this,n=e.rangePieces,r=e.cursors;if(n.length!=this.rangePieces.length||n.some((function(e,n){return!e.eq(t.rangePieces[n])}))){this.selectionLayer.textContent="";var i,o=_createForOfIteratorHelper(n);try{for(o.s();!(i=o.n()).done;){var a=i.value;this.selectionLayer.appendChild(a.draw())}}catch(c){o.e(c)}finally{o.f()}this.rangePieces=n}if(r.length!=this.cursors.length||r.some((function(e,n){return!e.eq(t.cursors[n])}))){this.cursorLayer.textContent="";var s,l=_createForOfIteratorHelper(r);try{for(l.s();!(s=l.n()).done;){var u=s.value;this.cursorLayer.appendChild(u.draw())}}catch(c){l.e(c)}finally{l.f()}this.cursors=r}}},{key:"destroy",value:function(){this.selectionLayer.remove(),this.cursorLayer.remove()}}]),e}()),tf={$content:{"& ::selection":{backgroundColor:"transparent !important"}}};Yh&&(tf.$content.caretColor="transparent !important");var nf=Qs(Hh.theme(tf),"override"),rf=Vu("selectionBackground"),of=Vu("cursor.primary"),af=Vu("cursor.secondary");function sf(e,t,n){var r=e.coordsAtPos(t.head,t.assoc||1);if(!r)return null;var i=e.scrollDOM.getBoundingClientRect();return new Jh(r.left-i.left,r.top-i.top,-1,r.bottom-r.top,n?of:af)}var lf=/[\0-\x08\n-\x1F\x7F-\x9F\xAD\u061C\u200B\u200C\u200E\u200F\u2028\u2029\uFEFF\uFFF9-\uFFFC]/g,uf={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"},cf=null;function hf(){if(null==cf&&"undefined"!=typeof document&&document.body){var e=document.body.style;cf=null!=(e.tabSize||e.MozTabSize)}return cf||!1}var ff=null!=/x/.unicode?"gu":"g",df=Ps.define({combine:function(e){var t=al(e,{render:null,specialChars:lf,addSpecialChars:null});return(t.replaceTabs=!hf())&&(t.specialChars=new RegExp("\t|"+t.specialChars.source,ff)),t.addSpecialChars&&(t.specialChars=new RegExp(t.specialChars.source+"|"+t.addSpecialChars.source,ff)),t}}),vf=Qc.fromClass(function(){function e(t){_classCallCheck(this,e),this.view=t,this.decorations=Eu.none,this.decorationCache=Object.create(null),this.recompute()}return _createClass(e,[{key:"update",value:function(e){var t=e.prevState.facet(df)!=e.state.facet(df);t&&(this.decorationCache=Object.create(null)),(t||e.changes.length||e.viewportChanged)&&this.recompute()}},{key:"recompute",value:function(){var e,t=[],n=_createForOfIteratorHelper(this.view.visibleRanges);try{for(n.s();!(e=n.n()).done;){var r=e.value,i=r.from,o=r.to;this.getDecorationsFor(i,o,t)}}catch(a){n.e(a)}finally{n.f()}this.decorations=Eu.set(t)}},{key:"getDecorationsFor",value:function(e,t,n){for(var r,i=this.view.state.facet(df),o=this.view.state.doc,a=e,s=o.iterRange(e,t);!s.next().done;){if(!s.lineBreak)for(;r=i.specialChars.exec(s.value);){var l=void 0,u=Ea(r[0],0);if(null!=u){if(9==u){var c=o.lineAt(a+r.index),h=this.view.state.tabSize,f=Qa(o.sliceString(c.from,a+r.index),0,h);l=Eu.replace({widget:new gf((h-f%h)*this.view.defaultCharacterWidth)})}else l=this.decorationCache[u]||(this.decorationCache[u]=Eu.replace({widget:new pf(i,u)}));n.push(l.range(a+r.index,a+r.index+r[0].length))}}a+=s.value.length}}}]),e}(),{decorations:function(e){return e.decorations}}),pf=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var i;return _classCallCheck(this,n),(i=t.call(this)).options=e,i.code=r,i}return _createClass(n,[{key:"eq",value:function(e){return e.code==this.code}},{key:"toDOM",value:function(){var e,t=((e=this.code)>=32?null:10==e?"\u2424":String.fromCharCode(9216+e))||"\u2022",n="Control character "+(uf[this.code]||this.code),r=this.options.render&&this.options.render(this.code,n,t);if(r)return r;var i=document.createElement("span");return i.textContent=t,i.title=n,i.setAttribute("aria-label",n),i.style.color="red",i}},{key:"ignoreEvent",value:function(){return!1}}]),n}(Iu),gf=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this)).width=e,r}return _createClass(n,[{key:"eq",value:function(e){return e.width==this.width}},{key:"toDOM",value:function(){var e=document.createElement("span");return e.textContent="\t",e.className=mf,e.style.width=this.width+"px",e}},{key:"ignoreEvent",value:function(){return!1}}]),n}(Iu),mf=cl.newName(),yf=Hh.styleModule.of(new cl(_defineProperty({},"."+mf,{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"}))),kf=Us.define(),bf=Us.define(),wf=Ps.define(),_f=Ps.define({combine:function(e){return al(e,{minDepth:100,newGroupDelay:500},{minDepth:Math.max,newGroupDelay:Math.min})}}),Cf=Ds.define({create:function(){return Lf.empty},update:function(e,t){var n=t.state.facet(_f),r=t.annotation(kf);if(r){var i=If.fromTransaction(t),o=r.side,a=0==o?e.undone:e.done;return a=i?Ef(a,a.length,n.minDepth,i):Qf(a,t.startState.selection),new Lf(0==o?r.rest:a,0==o?a:r.rest)}var s=t.annotation(bf);if("full"!=s&&"before"!=s||(e=e.isolate()),!1===t.annotation(Ys.addToHistory))return t.changes.length?e.addMapping(t.changes.desc):e;var l=If.fromTransaction(t),u=t.annotation(Ys.time),c=t.annotation(Ys.userEvent);return l?e=e.addChanges(l,u,c,n.newGroupDelay,n.minDepth):t.selection&&(e=e.addSelection(t.startState.selection,u,c,n.newGroupDelay)),"full"!=s&&"after"!=s||(e=e.isolate()),e}});function Of(e,t){return function(n){var r=n.state,i=n.dispatch,o=r.field(Cf,!1);if(!o)return!1;var a=o.pop(e,r,t);return!!a&&(i(a),!0)}}var xf=Of(0,!1),Sf=Of(1,!1),Af=Of(0,!0),Pf=Of(1,!0);function Tf(e){return function(t){var n=t.field(Cf,!1);if(!n)return 0;var r=0==e?n.done:n.undone;return r.length-(r.length&&!r[0].changes?1:0)}}Tf(0),Tf(1);var If=function(){function e(t,n,r,i,o){_classCallCheck(this,e),this.changes=t,this.effects=n,this.mapped=r,this.startSelection=i,this.selectionsAfter=o}return _createClass(e,[{key:"setSelAfter",value:function(t){return new e(this.changes,this.effects,this.mapped,this.startSelection,t)}}],[{key:"fromTransaction",value:function(t){var n,r=Mf,i=_createForOfIteratorHelper(t.startState.facet(wf));try{for(i.s();!(n=i.n()).done;){var o=(0,n.value)(t);o.length&&(r=r.concat(o))}}catch(a){i.e(a)}finally{i.f()}return!r.length&&t.changes.empty?null:new e(t.changes.invert(t.startState.doc),r,void 0,t.startState.selection,Mf)}},{key:"selection",value:function(t){return new e(void 0,Mf,void 0,void 0,t)}}]),e}();function Ef(e,t,n,r){var i=e.slice(t+1>n+20?t-n-1:0,t);return i.push(r),i}function Df(e,t){return e.length?t.length?e.concat(t):e:t}var Mf=[];function Qf(e,t){if(e.length){var n=e[e.length-1],r=n.selectionsAfter.slice(Math.max(0,n.selectionsAfter.length-200));return r.length&&r[r.length-1].eq(t)?e:(r.push(t),Ef(e,e.length-1,1e9,n.setSelAfter(r)))}return[If.selection([t])]}function Rf(e){var t=e[e.length-1],n=e.slice();return n[e.length-1]=t.setSelAfter(t.selectionsAfter.slice(0,t.selectionsAfter.length-1)),n}function Hf(e,t){if(!e.length)return e;for(var n=e.length,r=Mf;n;){var i=Nf(e[n-1],t,r);if(i.changes&&!i.changes.empty||i.effects.length){var o=e.slice(0,n);return o[n-1]=i,o}t=i.mapped,n--,r=i.selectionsAfter}return r.length?[If.selection(r)]:Mf}function Nf(e,t,n){var r=Df(e.selectionsAfter.length?e.selectionsAfter.map((function(e){return e.map(t)})):Mf,n);if(!e.changes)return If.selection(r);var i=e.changes.map(t),o=t.mapDesc(e.changes,!0),a=e.mapped?e.mapped.composeDesc(o):o;return new If(i,Gs.mapEffects(e.effects,t),a,e.startSelection.map(o),r)}var Lf=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;_classCallCheck(this,e),this.done=t,this.undone=n,this.prevTime=r,this.prevUserEvent=i}return _createClass(e,[{key:"isolate",value:function(){return this.prevTime?new e(this.done,this.undone):this}},{key:"addChanges",value:function(t,n,r,i,o){var a,s,l,u,c=this.done,h=c[c.length-1];return new e(c=h&&h.changes&&n-this.prevTime<i&&!h.selectionsAfter.length&&h.changes.length&&t.changes&&(a=h.changes,s=t.changes,l=[],u=!1,a.iterChangedRanges((function(e,t){return l.push(e,t)})),s.iterChangedRanges((function(e,t,n,r){for(var i=0;i<l.length;){var o=l[i++],a=l[i++];r>=o&&n<=a&&(u=!0)}})),u)?Ef(c,c.length-1,o,new If(t.changes.compose(h.changes),Df(t.effects,h.effects),h.mapped,h.startSelection,Mf)):Ef(c,c.length,o,t),Mf,n,r)}},{key:"addSelection",value:function(t,n,r,i){var o,a,s=this.done.length?this.done[this.done.length-1].selectionsAfter:Mf;return s.length>0&&n-this.prevTime<i&&"keyboardselection"==r&&this.prevUserEvent==r&&(o=s[s.length-1]).ranges.length==(a=t).ranges.length&&0===o.ranges.filter((function(e,t){return e.empty!=a.ranges[t].empty})).length?this:new e(Qf(this.done,t),this.undone,n,r)}},{key:"addMapping",value:function(t){return new e(Hf(this.done,t),Hf(this.undone,t),this.prevTime,this.prevUserEvent)}},{key:"pop",value:function(e,t,n){var r=0==e?this.done:this.undone;if(0==r.length)return null;var i=r[r.length-1];if(n&&i.selectionsAfter.length)return t.update({selection:i.selectionsAfter[i.selectionsAfter.length-1],annotations:kf.of({side:e,rest:Rf(r)})});if(i.changes){var o=1==r.length?Mf:r.slice(0,r.length-1);return i.mapped&&(o=Hf(o,i.mapped)),t.update({changes:i.changes,selection:i.startSelection,effects:i.effects,annotations:kf.of({side:e,rest:o}),filter:!1})}return null}}]),e}();Lf.empty=new Lf(Mf,Mf);var Ff=[{key:"Mod-z",run:xf,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:Sf,preventDefault:!0},{key:"Mod-u",run:Af,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:Pf,preventDefault:!0}],$f=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"compare",value:function(e){return this==e||this.constructor==e.constructor&&this.eq(e)}},{key:"toDOM",value:function(e){return null}},{key:"at",value:function(e){return new vl(e,e,this)}}]),n}(dl);$f.prototype.elementClass="",$f.prototype.mapMode=ds.TrackBefore;var Bf={style:"",renderEmptyElements:!1,elementStyle:"",markers:function(){return yl.empty},lineMarker:function(){return null},initialSpacer:null,updateSpacer:null,domEventHandlers:{}},Vf=Ps.define();function zf(e){return[Wf(),Vf.of(Object.assign(Object.assign({},Bf),e))]}var jf=Hh.baseTheme({$gutters:{display:"flex",height:"100%",boxSizing:"border-box",left:0},"$$light $gutters":{backgroundColor:"#f5f5f5",color:"#999",borderRight:"1px solid #ddd"},"$$dark $gutters":{backgroundColor:"#333338",color:"#ccc"},$gutter:{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",height:"100%",overflow:"hidden"},$gutterElement:{boxSizing:"border-box"},"$gutterElement.lineNumber":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"}}),qf=Ps.define({combine:function(e){return e.some((function(e){return e}))}});function Wf(e){var t=[Uf,jf];return e&&!1===e.fixed&&t.push(qf.of(!0)),t}var Uf=Qc.fromClass(function(){function e(t){_classCallCheck(this,e),this.view=t,this.dom=document.createElement("div"),this.dom.className=Vu("gutters"),this.dom.setAttribute("aria-hidden","true"),this.gutters=t.state.facet(Vf).map((function(e){return new Gf(t,e)}));var n,r=_createForOfIteratorHelper(this.gutters);try{for(r.s();!(n=r.n()).done;){var i=n.value;this.dom.appendChild(i.dom)}}catch(o){r.e(o)}finally{r.f()}this.fixed=!t.state.facet(qf),this.fixed&&(this.dom.style.position="sticky"),t.scrollDOM.insertBefore(this.dom,t.contentDOM)}return _createClass(e,[{key:"update",value:function(e){var t=this;if(this.updateGutters(e)){var n=this.gutters.map((function(e){return new Xf(e,t.view.viewport)}));this.view.viewportLines((function(e){var r;if(Array.isArray(e.type)){var i,o=_createForOfIteratorHelper(e.type);try{for(o.s();!(i=o.n()).done;){var a=i.value;if(a.type==Tu.Text){r=a;break}}}catch(u){o.e(u)}finally{o.f()}}else r=e.type==Tu.Text?e:void 0;if(r){var s,l=_createForOfIteratorHelper(n);try{for(l.s();!(s=l.n()).done;){s.value.line(t.view,r)}}catch(u){l.e(u)}finally{l.f()}}}),0);var r,i=_createForOfIteratorHelper(n);try{for(i.s();!(r=i.n()).done;){r.value.finish()}}catch(o){i.e(o)}finally{i.f()}this.dom.style.minHeight=this.view.contentHeight+"px",e.state.facet(qf)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":"")}}},{key:"updateGutters",value:function(e){var t=e.prevState.facet(Vf),n=e.state.facet(Vf),r=e.docChanged||e.heightChanged||e.viewportChanged;if(t==n){var i,o=_createForOfIteratorHelper(this.gutters);try{for(o.s();!(i=o.n()).done;){i.value.update(e)&&(r=!0)}}catch(g){o.e(g)}finally{o.f()}}else{r=!0;var a,s=[],l=_createForOfIteratorHelper(n);try{for(l.s();!(a=l.n()).done;){var u=a.value,c=t.indexOf(u);c<0?s.push(new Gf(this.view,u)):(this.gutters[c].update(e),s.push(this.gutters[c]))}}catch(g){l.e(g)}finally{l.f()}var h,f=_createForOfIteratorHelper(this.gutters);try{for(f.s();!(h=f.n()).done;){h.value.dom.remove()}}catch(g){f.e(g)}finally{f.f()}for(var d=0,v=s;d<v.length;d++){var p=v[d];this.dom.appendChild(p.dom)}this.gutters=s}return r}},{key:"destroy",value:function(){this.dom.remove()}}]),e}(),{provide:Ec.scrollMargins.from((function(e){return 0!=e.gutters.length&&e.fixed?e.view.textDirection==zu.LTR?{left:e.dom.offsetWidth}:{right:e.dom.offsetWidth}:null}))}),Xf=function(){function e(t,n){_classCallCheck(this,e),this.gutter=t,this.localMarkers=[],this.i=0,this.height=0,this.cursor=yl.iter(Array.isArray(t.markers)?t.markers:[t.markers],n.from)}return _createClass(e,[{key:"line",value:function(e,t){for(this.localMarkers.length&&(this.localMarkers=[]);this.cursor.value&&this.cursor.from<=t.from;)this.cursor.from==t.from&&this.localMarkers.push(this.cursor.value),this.cursor.next();var n=this.gutter.config.lineMarker(e,t,this.localMarkers);n&&this.localMarkers.unshift(n);var r=this.gutter;if(0!=this.localMarkers.length||r.config.renderEmptyElements){var i=t.top-this.height;if(this.i==r.elements.length){var o=new Zf(e,t.height,i,this.localMarkers,r.elementClass);r.elements.push(o),r.dom.appendChild(o.dom)}else{var a=this.localMarkers,s=r.elements[this.i];(function(e,t){if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(!e[n].compare(t[n]))return!1;return!0})(a,s.markers)&&(a=s.markers,this.localMarkers.length=0),s.update(e,t.height,i,a,r.elementClass)}this.height=t.bottom,this.i++}}},{key:"finish",value:function(){for(var e=this.gutter;e.elements.length>this.i;)e.dom.removeChild(e.elements.pop().dom)}}]),e}(),Gf=function(){function e(t,n){var r=this;_classCallCheck(this,e),this.view=t,this.config=n,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className=Vu("gutter"+(this.config.style?"."+this.config.style:"")),this.elementClass=Vu("gutterElement"+(this.config.style?"."+this.config.style:""));var i=function(e){r.dom.addEventListener(e,(function(r){var i=t.visualLineAtHeight(r.clientY,t.contentDOM.getBoundingClientRect().top);n.domEventHandlers[e](t,i,r)&&r.preventDefault()}))};for(var o in n.domEventHandlers)i(o);this.markers=n.markers(t.state),n.initialSpacer&&(this.spacer=new Zf(t,0,0,[n.initialSpacer(t)],this.elementClass),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}return _createClass(e,[{key:"update",value:function(e){var t=this.markers;if(this.markers=this.config.markers(e.state),this.spacer&&this.config.updateSpacer){var n=this.config.updateSpacer(this.spacer.markers[0],e);n!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[n],this.elementClass)}return this.markers!=t}}]),e}(),Zf=function(){function e(t,n,r,i,o){_classCallCheck(this,e),this.height=-1,this.above=0,this.dom=document.createElement("div"),this.update(t,n,r,i,o)}return _createClass(e,[{key:"update",value:function(e,t,n,r,i){if(this.height!=t&&(this.dom.style.height=(this.height=t)+"px"),this.above!=n&&(this.dom.style.marginTop=(this.above=n)?n+"px":""),this.markers!=r){this.markers=r;for(var o;o=this.dom.lastChild;)o.remove();var a,s=i,l=_createForOfIteratorHelper(r);try{for(l.s();!(a=l.n()).done;){var u=a.value,c=u.toDOM(e);c&&this.dom.appendChild(c);var h=u.elementClass;h&&(s+=" "+h)}}catch(f){l.e(f)}finally{l.f()}this.dom.className=s}}}]),e}(),Yf=Ps.define(),Kf=Ps.define({combine:function(e){return al(e,{formatNumber:String,domEventHandlers:{}},{domEventHandlers:function(e,t){var n=Object.assign({},e),r=function(e){var r=n[e],i=t[e];n[e]=r?function(e,t,n){return r(e,t,n)||i(e,t,n)}:i};for(var i in t)r(i);return n}})}}),Jf=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this)).number=e,r}return _createClass(n,[{key:"eq",value:function(e){return this.number==e.number}},{key:"toDOM",value:function(e){var t=e.state.facet(Kf);return document.createTextNode(t.formatNumber(this.number))}}]),n}($f),ed=zf({style:"lineNumber",markers:function(e){return e.facet(Yf)},lineMarker:function(e,t,n){return n.length?null:new Jf(e.state.doc.lineAt(t.from).number)},initialSpacer:function(e){return new Jf(td(e.state.doc.lines))},updateSpacer:function(e,t){var n=td(t.view.state.doc.lines);return n==e.number?e:new Jf(n)}});function td(e){for(var t=9;t<e;)t=10*t+9;return t}function nd(e,t){var n=t.mapPos(e.from,1),r=t.mapPos(e.to,-1);return n>=r?void 0:{from:n,to:r}}var rd=Gs.define({map:nd}),id=Gs.define({map:nd});function od(e){var t,n=[],r=_createForOfIteratorHelper(e.state.selection.ranges);try{var i=function(){var r=t.value.head;n.some((function(e){return e.from<=r&&e.to>=r}))||n.push(e.visualLineAt(r))};for(r.s();!(t=r.n()).done;)i()}catch(o){r.e(o)}finally{r.f()}return n}var ad=Ds.define({create:function(){return Eu.none},update:function(e,t){e=e.map(t.changes);var n,r=_createForOfIteratorHelper(t.effects);try{var i=function(){var t=n.value;t.is(rd)&&!function(e,t,n){var r=!1;return e.between(t,t,(function(e,i){e==t&&i==n&&(r=!0)})),r}(e,t.value.from,t.value.to)?e=e.update({add:[vd.range(t.value.from,t.value.to)]}):t.is(id)&&(e=e.update({filter:function(e,n){return t.value.from!=e||t.value.to!=n},filterFrom:t.value.from,filterTo:t.value.to}))};for(r.s();!(n=r.n()).done;)i()}catch(s){r.e(s)}finally{r.f()}if(t.selection){var o=!1,a=t.selection.primary.head;e.between(a,a,(function(e,t){e<a&&t>a&&(o=!0)})),o&&(e=e.update({filterFrom:a,filterTo:a,filter:function(e,t){return t<=a||e>=a}}))}return e},provide:[Hh.decorations]});function sd(e,t,n){var r,i=null;return null===(r=e.field(ad,!1))||void 0===r||r.between(t,n,(function(e,t){(!i||i.from>e)&&(i={from:e,to:t})})),i}function ld(e,t,n){return e.facet(ol.foldable).reduce((function(r,i){return r||i(e,t,n)}),null)}function ud(e){return e.field(ad,!1)?void 0:{append:dd()}}var cd=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:function(e){var t,n=_createForOfIteratorHelper(od(e));try{for(n.s();!(t=n.n()).done;){var r=t.value,i=ld(e.state,r.from,r.to);if(i)return e.dispatch({effects:rd.of(i),reconfigure:ud(e.state)}),!0}}catch(o){n.e(o)}finally{n.f()}return!1}},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:function(e){if(!e.state.field(ad,!1))return!1;var t,n=[],r=_createForOfIteratorHelper(od(e));try{for(r.s();!(t=r.n()).done;){var i=t.value,o=sd(e.state,i.from,i.to);o&&n.push(id.of(o))}}catch(a){r.e(a)}finally{r.f()}return n.length&&e.dispatch({effects:n}),n.length>0}},{key:"Ctrl-Alt-[",run:function(e){for(var t=e.state,n=[],r=0;r<t.doc.length;){var i=e.visualLineAt(r),o=ld(t,i.from,i.to);o&&n.push(rd.of(o)),r=(o?e.visualLineAt(o.to):i).to+1}return n.length&&e.dispatch({effects:n,reconfigure:ud(e.state)}),!!n.length}},{key:"Ctrl-Alt-]",run:function(e){var t=e.state.field(ad,!1);if(!t||!t.size)return!1;var n=[];return t.between(0,e.state.doc.length,(function(e,t){n.push(id.of({from:e,to:t}))})),e.dispatch({effects:n}),!0}}],hd={placeholderDOM:null,placeholderText:"\u2026"},fd=Ps.define({combine:function(e){return al(e,hd)}});function dd(e){var t=[ad,md];return e&&t.push(fd.of(e)),t}var vd=Eu.replace({widget:new(function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"ignoreEvents",value:function(){return!1}},{key:"toDOM",value:function(e){var t=e.state,n=t.facet(fd);if(n.placeholderDOM)return n.placeholderDOM();var r=document.createElement("span");return r.textContent=n.placeholderText,r.setAttribute("aria-label",t.phrase("folded code")),r.title=t.phrase("unfold"),r.className=Vu("foldPlaceholder"),r.onclick=function(t){var n=e.visualLineAt(e.posAtDOM(t.target)),r=sd(e.state,n.from,n.to);r&&e.dispatch({effects:id.of(r)}),t.preventDefault()},r}}]),n}(Iu))}),pd={openText:"\u2304",closedText:"\u203a"},gd=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var i;return _classCallCheck(this,n),(i=t.call(this)).config=e,i.open=r,i}return _createClass(n,[{key:"eq",value:function(e){return this.config==e.config&&this.open==e.open}},{key:"toDOM",value:function(e){var t=document.createElement("span");return t.textContent=this.open?this.config.openText:this.config.closedText,t.title=e.state.phrase(this.open?"Fold line":"Unfold line"),t}}]),n}($f),md=Hh.baseTheme({$foldPlaceholder:{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},"$gutterElement.foldGutter":{padding:"0 1px",cursor:"pointer"}}),yd=Hh.baseTheme({$matchingBracket:{color:"#0b0"},$nonmatchingBracket:{color:"#a22"}}),kd=Ps.define({combine:function(e){return al(e,{afterCursor:!0,brackets:"()[]{}",maxScanDistance:1e4})}}),bd=Eu.mark({class:Vu("matchingBracket")}),wd=Eu.mark({class:Vu("nonmatchingBracket")}),_d=[Ds.define({create:function(){return Eu.none},update:function(e,t){if(!t.docChanged&&!t.selection)return e;var n,r=[],i=t.state.facet(kd),o=_createForOfIteratorHelper(t.state.selection.ranges);try{for(o.s();!(n=o.n()).done;){var a=n.value;if(a.empty){var s=Od(t.state,a.head,-1,i)||a.head>0&&Od(t.state,a.head-1,1,i)||i.afterCursor&&(Od(t.state,a.head,1,i)||a.head<t.state.doc.length&&Od(t.state,a.head+1,-1,i));if(s){var l=s.matched?bd:wd;r.push(l.range(s.start.from,s.start.to)),s.end&&r.push(l.range(s.end.from,s.end.to))}}}}catch(u){o.e(u)}finally{o.f()}return Eu.set(r,!0)},provide:[Hh.decorations]}),yd];function Cd(e,t,n){var r=e.prop(t<0?Ka.openedBy:Ka.closedBy);if(r)return r;if(1==e.name.length){var i=n.indexOf(e.name);if(i>-1&&i%2==(t<0?1:0))return[n[i+t]]}return null}function Od(e,t,n){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=i.maxScanDistance||1e4,a=i.brackets||"()[]{}",s=e.tree,l=s.resolve(t,n);return(r=Cd(l.type,n,a))?function(e,t,n,r,i,o){var a=r.parent,s={from:r.start,to:r.end},l=0;return a&&a.iterate({from:n<0?r.start:r.end,to:n<0?a.start:a.end,enter:function(e,t,a){if(!(n<0?a>r.start:t<r.end)){if(0==l&&i.indexOf(e.name)>-1)return{start:s,end:{from:t,to:a},matched:!0};if(Cd(e,n,o))l++;else if(Cd(e,-n,o)&&0==--l)return{start:s,end:{from:t,to:a},matched:!1};return!1}}})||{start:s,matched:!1}}(0,0,n,l,r,a):function(e,t,n,r,i,o,a){var s=n<0?e.sliceDoc(t-1,t):e.sliceDoc(t,t+1),l=a.indexOf(s);if(l<0||l%2==0!=n>0)return null;for(var u={from:n<0?t-1:t,to:n>0?t+1:t},c=e.doc.iterRange(t,n>0?e.doc.length:0),h=0,f=0;!c.next().done&&f<=o;){var d=c.value;n<0&&(f+=d.length);for(var v=t+f*n,p=n>0?0:d.length-1,g=n>0?d.length:-1;p!=g;p+=n){var m=a.indexOf(d[p]);if(!(m<0||r.resolve(v+p,1).type!=i))if(m%2==0==n>0)h++;else{if(1==h)return{start:u,end:{from:v+p,to:v+p+1},matched:m>>1==l>>1};h--}}n>0&&(f+=d.length)}return c.done?{start:u,matched:!1}:null}(e,t,n,s,l.type,o,a)}function xd(e,t){return Os.create(e.ranges.map(t),e.primaryIndex)}function Sd(e,t){return e.update({selection:t,scrollIntoView:!0,annotations:Ys.userEvent.of("keyboardselection")})}function Ad(e,t){var n=e.state,r=e.dispatch,i=xd(n.selection,t);return!i.eq(n.selection)&&(r(Sd(n,i)),!0)}function Pd(e,t){return Os.cursor(t?e.to:e.from)}function Td(e,t){return Ad(e,(function(n){return n.empty?e.moveByChar(n,t):Pd(n,t)}))}var Id=function(e){return Td(e,e.textDirection!=zu.LTR)},Ed=function(e){return Td(e,e.textDirection==zu.LTR)};function Dd(e,t){return Ad(e,(function(n){return n.empty?e.moveByGroup(n,t):Pd(n,t)}))}function Md(e,t,n){if(t.type.prop(n))return!0;var r=t.end-t.start;return r&&(r>2||/[^\s,.;:]/.test(e.sliceDoc(t.start,t.end)))||t.firstChild}function Qd(e,t,n){for(var r,i,o=e.tree.resolve(t.head),a=n?Ka.closedBy:Ka.openedBy,s=t.head;;){var l=n?o.childAfter(s):o.childBefore(s);if(!l)break;Md(e,l,a)?o=l:s=n?l.end:l.start}return i=o.type.prop(a)&&(r=n?Od(e,o.start,1):Od(e,o.end,-1))&&r.matched?n?r.end.to:r.end.from:n?o.end:o.start,Os.cursor(i,n?-1:1)}function Rd(e,t){return Ad(e,(function(n){return n.empty?e.moveVertically(n,t):Pd(n,t)}))}var Hd=function(e){return Rd(e,!1)},Nd=function(e){return Rd(e,!0)};function Ld(e,t){return Ad(e,(function(n){return n.empty?e.moveVertically(n,t,e.dom.clientHeight):Pd(n,t)}))}var Fd=function(e){return Ld(e,!1)},$d=function(e){return Ld(e,!0)};function Bd(e,t,n){var r=e.visualLineAt(t.head),i=e.moveToLineBoundary(t,n);if(i.head==t.head&&i.head!=(n?r.to:r.from)&&(i=e.moveToLineBoundary(t,n,!1)),!n&&i.head==r.from&&r.length){var o=/^\s*/.exec(e.state.sliceDoc(r.from,Math.min(r.from+100,r.to)))[0].length;o&&t.head>r.from+o&&(i=Os.cursor(r.from+o))}return i}var Vd=function(e){return Ad(e,(function(t){return Os.cursor(e.visualLineAt(t.head).from,1)}))},zd=function(e){return Ad(e,(function(t){return Os.cursor(e.visualLineAt(t.head).to,-1)}))};function jd(e,t){var n=xd(e.state.selection,(function(e){var n=t(e);return Os.range(e.anchor,n.head,n.goalColumn)}));return!n.eq(e.state.selection)&&(e.dispatch(Sd(e.state,n)),!0)}function qd(e,t){return jd(e,(function(n){return e.moveByChar(n,t)}))}var Wd=function(e){return qd(e,e.textDirection!=zu.LTR)},Ud=function(e){return qd(e,e.textDirection==zu.LTR)};function Xd(e,t){return jd(e,(function(n){return e.moveByGroup(n,t)}))}function Gd(e,t){return jd(e,(function(n){return e.moveVertically(n,t)}))}var Zd=function(e){return Gd(e,!1)},Yd=function(e){return Gd(e,!0)};function Kd(e,t){return jd(e,(function(n){return e.moveVertically(n,t,e.dom.clientHeight)}))}var Jd=function(e){return Kd(e,!1)},ev=function(e){return Kd(e,!0)},tv=function(e){return jd(e,(function(t){return Os.cursor(e.visualLineAt(t.head).from)}))},nv=function(e){return jd(e,(function(t){return Os.cursor(e.visualLineAt(t.head).to)}))},rv=function(e){var t=e.state;return(0,e.dispatch)(Sd(t,{anchor:0})),!0},iv=function(e){var t=e.state;return(0,e.dispatch)(Sd(t,{anchor:t.doc.length})),!0},ov=function(e){var t=e.state;return(0,e.dispatch)(Sd(t,{anchor:t.selection.primary.anchor,head:0})),!0},av=function(e){var t=e.state;return(0,e.dispatch)(Sd(t,{anchor:t.selection.primary.anchor,head:t.doc.length})),!0};function sv(e,t){var n=e.state.changeByRange((function(e){var n=e.from,r=e.to;if(n==r){var i=t(n);n=Math.min(n,i),r=Math.max(r,i)}return n==r?{range:e}:{changes:{from:n,to:r},range:Os.cursor(n)}}));return!n.changes.empty&&(e.dispatch(n,{scrollIntoView:!0,annotations:Ys.userEvent.of("delete")}),!0)}var lv=function(e,t,n){return sv(e,(function(r){var i,o,a=e.state,s=a.doc.lineAt(r);if(!t&&r>s.from&&r<s.from+200&&!/[^ \t]/.test(i=s.slice(0,r-s.from))){if("\t"==i[i.length-1])return r-1;for(var l=Qa(i,0,a.tabSize)%a.indentUnit||a.indentUnit,u=0;u<l&&" "==i[i.length-1-u];u++)r--;return r}if(n){var c=s.slice(r-s.from+(t?0:-2),r-s.from+(t?2:0)),h=c?Ma(Ea(c,0)):1;o=t?Math.min(a.doc.length,r+h):Math.max(0,r-h)}else o=s.findClusterBreak(r-s.from,t)+s.from;return o==r&&s.number!=(t?a.doc.lines:1)&&(o+=t?1:-1),o}))},uv=function(e){return lv(e,!0,!1)},cv=function(e,t){return sv(e,(function(n){for(var r=e.state,i=r.doc.lineAt(n),o=r.charCategorizer(n),a=null;;){var s=void 0,l=void 0;if(n==(t?i.to:i.from)){if(i.number==(t?r.doc.lines:1))break;i=r.doc.line(i.number+(t?1:-1)),s=t?i.from:i.to,l="\n"}else s=i.findClusterBreak(n-i.from,t)+i.from,l=i.slice(Math.min(n,s)-i.from,Math.max(n,s)-i.from);var u=o(l);if(null!=a&&u!=a)break;u!=tl.Space&&(a=u),n=s}return n}))},hv=function(e){return cv(e,!1)},fv=function(e){return cv(e,!0)};function dv(e){var t,n=[],r=-1,i=_createForOfIteratorHelper(e.selection.ranges);try{for(i.s();!(t=i.n()).done;){var o=t.value,a=e.doc.lineAt(o.from),s=e.doc.lineAt(o.to);r==a.number?n[n.length-1].to=s.to:n.push({from:a.from,to:s.to}),r=s.number}}catch(l){i.e(l)}finally{i.f()}return n}function vv(e,t,n){var r,i=[],o=_createForOfIteratorHelper(dv(e));try{for(o.s();!(r=o.n()).done;){var a=r.value;if(n?a.to!=e.doc.length:0!=a.from){var s=e.doc.lineAt(n?a.to+1:a.from-1);n?i.push({from:a.to,to:s.to},{from:a.from,insert:s.slice()+e.lineBreak}):i.push({from:s.from,to:a.from},{from:a.to,insert:e.lineBreak+s.slice()})}}}catch(l){o.e(l)}finally{o.f()}return!!i.length&&(t(e.update({changes:i,scrollIntoView:!0})),!0)}function pv(e,t,n){var r,i=[],o=_createForOfIteratorHelper(dv(e));try{for(o.s();!(r=o.n()).done;){var a=r.value;i.push(n?{from:a.from,insert:e.doc.slice(a.from,a.to)+e.lineBreak}:{from:a.to,insert:e.lineBreak+e.doc.slice(a.from,a.to)})}}catch(s){o.e(s)}finally{o.f()}return t(e.update({changes:i,scrollIntoView:!0})),!0}function gv(e,t){var n,r=_createForOfIteratorHelper(e.state.facet(ol.indentation));try{for(r.s();!(n=r.n()).done;){var i=(0,n.value)(e,t);if(i>-1)return i}}catch(o){r.e(o)}finally{r.f()}return-1}function mv(e,t){var n=-1;return e.changeByRange((function(r){for(var i=[],o=e.doc.lineAt(r.from);o.number>n&&(t(o,i,r),n=o.number),!(r.to<=o.to);)o=e.doc.lineAt(o.to+1);var a=e.changes(i);return{changes:i,range:Os.range(a.mapPos(r.anchor,1),a.mapPos(r.head,1))}}))}var yv=[{key:"ArrowLeft",run:Id,shift:Wd},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:function(e){return Dd(e,e.textDirection!=zu.LTR)},shift:function(e){return Xd(e,e.textDirection!=zu.LTR)}},{mac:"Cmd-ArrowLeft",run:Vd,shift:tv},{key:"ArrowRight",run:Ed,shift:Ud},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:function(e){return Dd(e,e.textDirection==zu.LTR)},shift:function(e){return Xd(e,e.textDirection==zu.LTR)}},{mac:"Cmd-ArrowRight",run:zd,shift:nv},{key:"ArrowUp",run:Hd,shift:Zd},{mac:"Cmd-ArrowUp",run:rv,shift:ov},{mac:"Ctrl-ArrowUp",run:Fd,shift:Jd},{key:"ArrowDown",run:Nd,shift:Yd},{mac:"Cmd-ArrowDown",run:iv,shift:av},{mac:"Ctrl-ArrowDown",run:$d,shift:ev},{key:"PageUp",run:Fd,shift:Jd},{key:"PageDown",run:$d,shift:ev},{key:"Home",run:function(e){return Ad(e,(function(t){return Bd(e,t,!1)}))},shift:function(e){return jd(e,(function(t){return Bd(e,t,!1)}))}},{key:"Mod-Home",run:rv,shift:ov},{key:"End",run:function(e){return Ad(e,(function(t){return Bd(e,t,!0)}))},shift:function(e){return jd(e,(function(t){return Bd(e,t,!0)}))}},{key:"Mod-End",run:iv,shift:av},{key:"Enter",run:function(e){var t=e.state,n=e.dispatch,r=t.changeByRange((function(e){var n,r=e.from,i=e.to,o=r==i&&function(e,t){if(/\(\)|\[\]|\{\}/.test(e.sliceDoc(t-1,t+1)))return{from:t,to:t};var n,r=e.tree.resolve(t),i=r.childBefore(t),o=r.childAfter(t);return i&&o&&i.end<=t&&o.start>=t&&(n=i.type.prop(Ka.closedBy))&&n.indexOf(o.name)>-1?{from:i.end,to:o.start}:null}(t,r),a=new Ws(t,{simulateBreak:r,simulateDoubleBreak:!!o}),s=gv(a,r);s<0&&(s=/^\s*/.exec(t.doc.lineAt(r).slice(0,50))[0].length);for(var l=t.doc.lineAt(r);i<l.to&&/\s/.test(l.slice(i-l.from,i+1-l.from));)i++;o?(r=(n=o).from,i=n.to):r>l.from&&r<l.from+100&&!/\S/.test(l.slice(0,r))&&(r=l.from);var u=["",t.indentString(s)];return o&&u.push(t.indentString(a.lineIndent(l))),{changes:{from:r,to:i,insert:Ha.of(u)},range:Os.cursor(r+1+s)}}));return n(t.update(r,{scrollIntoView:!0})),!0}},{key:"Mod-a",run:function(e){var t=e.state;return(0,e.dispatch)(t.update({selection:{anchor:0,head:t.doc.length},annotations:Ys.userEvent.of("keyboardselection")})),!0}},{key:"Backspace",run:function(e){return lv(e,!1,!0)}},{key:"Delete",run:uv},{key:"Mod-Backspace",mac:"Alt-Backspace",run:hv},{key:"Mod-Delete",mac:"Alt-Delete",run:fv}].concat([{key:"Ctrl-b",run:Id,shift:Wd},{key:"Ctrl-f",run:Ed,shift:Ud},{key:"Ctrl-p",run:Hd,shift:Zd},{key:"Ctrl-n",run:Nd,shift:Yd},{key:"Ctrl-a",run:Vd,shift:tv},{key:"Ctrl-e",run:zd,shift:nv},{key:"Ctrl-d",run:uv},{key:"Ctrl-h",run:function(e){return lv(e,!1,!1)}},{key:"Ctrl-k",run:function(e){return sv(e,(function(t){var n=e.visualLineAt(t).to;return t<n?n:Math.max(e.state.doc.length,t+1)}))}},{key:"Alt-d",run:fv},{key:"Ctrl-Alt-h",run:hv},{key:"Ctrl-o",run:function(e){var t=e.state,n=e.dispatch,r=t.changeByRange((function(e){return{changes:{from:e.from,to:e.to,insert:Ha.of(["",""])},range:Os.cursor(e.from)}}));return n(t.update(r,{scrollIntoView:!0,annotations:Ys.userEvent.of("input")})),!0}},{key:"Ctrl-t",run:function(e){var t=e.state,n=e.dispatch,r=t.changeByRange((function(e){if(!e.empty||0==e.from||e.from==t.doc.length)return{range:e};var n=e.from,r=t.doc.lineAt(n),i=n==r.from?n-1:r.findClusterBreak(n-r.from,!1)+r.from,o=n==r.to?n+1:r.findClusterBreak(n-r.from,!0)+r.from;return{changes:{from:i,to:o,insert:t.doc.slice(n,o).append(t.doc.slice(i,n))},range:Os.cursor(o)}}));return!r.changes.empty&&(n(t.update(r,{scrollIntoView:!0})),!0)}},{key:"Alt-f",run:function(e){return Dd(e,!0)},shift:function(e){return Xd(e,!0)}},{key:"Alt-b",run:function(e){return Dd(e,!1)},shift:function(e){return Xd(e,!1)}},{key:"Alt-<",run:rv},{key:"Alt->",run:iv},{key:"Ctrl-v",run:$d},{key:"Alt-v",run:Fd}].map((function(e){return{mac:e.key,run:e.run,shift:e.shift}}))),kv=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:function(e){return Ad(e,(function(t){return Qd(e.state,t,e.textDirection!=zu.LTR)}))},shift:function(e){return jd(e,(function(t){return Qd(e.state,t,e.textDirection!=zu.LTR)}))}},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:function(e){return Ad(e,(function(t){return Qd(e.state,t,e.textDirection==zu.LTR)}))},shift:function(e){return jd(e,(function(t){return Qd(e.state,t,e.textDirection==zu.LTR)}))}},{key:"Alt-ArrowUp",run:function(e){return vv(e.state,e.dispatch,!1)}},{key:"Shift-Alt-ArrowUp",run:function(e){return pv(e.state,e.dispatch,!1)}},{key:"Alt-ArrowDown",run:function(e){return vv(e.state,e.dispatch,!0)}},{key:"Shift-Alt-ArrowDown",run:function(e){return pv(e.state,e.dispatch,!0)}},{key:"Escape",run:function(e){var t=e.state,n=e.dispatch,r=t.selection,i=null;return r.ranges.length>1?i=new Os([r.primary]):r.primary.empty||(i=new Os([Os.cursor(r.primary.head)])),!!i&&(n(Sd(t,i)),!0)}},{key:"Mod-l",run:function(e){var t=e.state,n=e.dispatch,r=dv(t).map((function(e){var n=e.from,r=e.to;return Os.range(n,Math.min(r+1,t.doc.length))}));return n(t.update({selection:new Os(r),annotations:Ys.userEvent.of("keyboardselection")})),!0}},{key:"Mod-i",run:function(e){var t=e.state,n=e.dispatch,r=xd(t.selection,(function(e){for(var n,r=t.tree.resolve(e.head,1);!(r.start<e.from&&r.end>=e.to||r.end>e.to&&r.start<=e.from)&&(null===(n=r.parent)||void 0===n?void 0:n.parent);)r=r.parent;return Os.range(r.end,r.start)}));return n(Sd(t,r)),!0}},{key:"Mod-[",run:function(e){var t=e.state;return(0,e.dispatch)(t.update(mv(t,(function(e,n){var r=e.slice(0,Math.min(e.length,200)),i=/^\s*/.exec(r)[0];if(i){for(var o=Qa(i,0,t.tabSize),a=t.indentString(Math.max(0,o-t.indentUnit)),s=0;s<i.length&&s<a.length&&i.charCodeAt(s)==a.charCodeAt(s);)s++;n.push({from:e.from+s,to:e.from+i.length,insert:a.slice(s)})}})))),!0}},{key:"Mod-]",run:function(e){var t=e.state;return(0,e.dispatch)(t.update(mv(t,(function(e,n){n.push({from:e.from,insert:t.facet(ol.indentUnit)})})))),!0}},{key:"Mod-Alt-\\",run:function(e){var t=e.state,n=e.dispatch,r=Object.create(null),i=new Ws(t,{overrideIndentation:function(e){var t=r[e];return null==t?-1:t}}),o=mv(t,(function(e,n,o){var a=gv(i,e.from);if(!(a<0)){var s=/^\s*/.exec(e.slice(0,Math.min(e.length,200)))[0],l=t.indentString(a);(s!=l||o.from<e.from+s.length)&&(r[e.from]=a,n.push({from:e.from,to:e.from+s.length,insert:l}))}}));return o.changes.empty||n(t.update(o)),!0}},{key:"Shift-Mod-k",run:function(e){var t=e.state,n=t.changes(dv(t).map((function(e){var n=e.from,r=e.to;return n>0?n--:r<t.doc.length&&r++,{from:n,to:r}}))),r=xd(t.selection,(function(t){return e.moveVertically(t,!0)})).map(n);return e.dispatch({changes:n,selection:r,scrollIntoView:!0}),!0}},{key:"Shift-Mod-\\",run:function(e){return function(e,t,n){var r=!1,i=xd(e.selection,(function(t){var n=Od(e,t.head,-1)||Od(e,t.head,1)||t.head>0&&Od(e,t.head-1,1)||t.head<e.doc.length&&Od(e,t.head+1,-1);if(!n||!n.end)return t;r=!0;var i=n.start.from==t.head?n.end.to:n.end.from;return Os.cursor(i)}));return!!r&&(t(Sd(e,i)),!0)}(e.state,e.dispatch)}}].concat(yv),bv={brackets:["(","[","{","'",'"'],before:")]}'\":;>"};function wv(e){for(var t=0;t<"()[]{}<>".length;t+=2)if("()[]{}<>".charCodeAt(t)==e)return"()[]{}<>".charAt(t+1);return Da(e<128?e:e+1)}function _v(e,t){return e.languageDataAt("closeBrackets",t)[0]||bv}var Cv=[{key:"Backspace",run:function(e){var t=e.state,n=e.dispatch,r=_v(t,t.selection.primary.head).brackets||bv.brackets,i=null,o=t.changeByRange((function(e){if(e.empty){var n,o=(l=t.doc,u=e.head,Ma(Ea(c=l.sliceString(u-2,u),0))==c.length?c:c.slice(1)),a=_createForOfIteratorHelper(r);try{for(a.s();!(n=a.n()).done;){var s=n.value;if(s==o&&Ov(t.doc,e.head)==wv(Ea(s,0)))return{changes:{from:e.head-s.length,to:e.head+s.length},range:Os.cursor(e.head-s.length),annotations:Ys.userEvent.of("delete")}}}catch(h){a.e(h)}finally{a.f()}}var l,u,c;return{range:i=e}}));return i||n(t.update(o,{scrollIntoView:!0})),!i}}];function Ov(e,t){var n=e.sliceString(t,t+2);return n.slice(0,Ma(Ea(n,0)))}function xv(e,t,n,r){var i=null,o=e.changeByRange((function(o){if(!o.empty)return{changes:[{insert:t,from:o.from},{insert:n,from:o.to}],range:Os.range(o.anchor+t.length,o.head+t.length)};var a=Ov(e.doc,o.head);return!a||/\s/.test(a)||r.indexOf(a)>-1?{changes:{insert:t+n,from:o.head},range:Os.cursor(o.head+t.length)}:{range:i=o}}));return i?null:e.update(o,{scrollIntoView:!0,annotations:Ys.userEvent.of("input")})}function Sv(e,t,n){var r=null,i=e.selection.ranges.map((function(t){return t.empty&&Ov(e.doc,t.head)==n?Os.cursor(t.head+n.length):r=t}));return r?null:e.update({selection:Os.create(i,e.selection.primaryIndex),scrollIntoView:!0})}function Av(e,t,n){var r=null,i=e.changeByRange((function(i){if(!i.empty)return{changes:[{insert:t,from:i.from},{insert:t,from:i.to}],range:Os.range(i.anchor+t.length,i.head+t.length)};var o=i.head,a=Ov(e.doc,o);if(a==t){if(Pv(e,o))return{changes:{insert:t+t,from:o},range:Os.cursor(o+t.length)};var s=n&&e.sliceDoc(o,o+3*t.length)==t+t+t;return{range:Os.cursor(o+t.length*(s?3:1))}}if(n&&e.sliceDoc(o-2*t.length,o)==t+t&&Pv(e,o-2*t.length))return{changes:{insert:t+t+t+t,from:o},range:Os.cursor(o+t.length)};if(e.charCategorizer(o)(a)!=tl.Word){var l=e.sliceDoc(o-1,o);if(l!=t&&e.charCategorizer(o)(l)!=tl.Word)return{changes:{insert:t+t,from:o},range:Os.cursor(o+t.length)}}return{range:r=i}}));return r?null:e.update(i,{scrollIntoView:!0,annotations:Ys.userEvent.of("input")})}function Pv(e,t){var n=e.tree.resolve(t+1);return n.parent&&n.start==t}var Tv=Ps.define({combine:function(e){var t,n,r,i=_createForOfIteratorHelper(e);try{for(i.s();!(r=i.n()).done;){var o=r.value;t=t||o.topContainer,n=n||o.bottomContainer}}catch(a){i.e(a)}finally{i.f()}return{topContainer:t,bottomContainer:n}}});function Iv(e){var t=[Mv,Nv];return e&&t.push(Tv.of(e)),t}var Ev=Ps.define();function Dv(e,t){var n=e.plugin(Mv),r=e.state.facet(Ev).indexOf(t);return n&&r>-1?n.panels[r]:null}var Mv=Qc.fromClass(function(){function e(t){_classCallCheck(this,e),this.specs=t.state.facet(Ev),this.panels=this.specs.map((function(e){return e(t)}));var n=t.state.facet(Tv);this.top=new Rv(t,!0,n.topContainer),this.bottom=new Rv(t,!1,n.bottomContainer),this.top.sync(this.panels.filter((function(e){return e.top}))),this.bottom.sync(this.panels.filter((function(e){return!e.top})));var r,i=_createForOfIteratorHelper(this.panels);try{for(i.s();!(r=i.n()).done;){var o=r.value;o.dom.className+=" "+Qv(o),o.mount&&o.mount()}}catch(a){i.e(a)}finally{i.f()}}return _createClass(e,[{key:"update",value:function(e){var t=e.state.facet(Tv);this.top.container!=t.topContainer&&(this.top.sync([]),this.top=new Rv(e.view,!0,t.topContainer)),this.bottom.container!=t.bottomContainer&&(this.bottom.sync([]),this.bottom=new Rv(e.view,!1,t.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();var n=e.state.facet(Ev);if(n!=this.specs){var r,i=[],o=[],a=[],s=[],l=_createForOfIteratorHelper(n);try{for(l.s();!(r=l.n()).done;){var u=r.value,c=void 0,h=this.specs.indexOf(u);h<0?(c=u(e.view),s.push(c)):(c=this.panels[h]).update&&c.update(e),i.push(c),(c.top?o:a).push(c)}}catch(y){l.e(y)}finally{l.f()}this.specs=n,this.panels=i,this.top.sync(o),this.bottom.sync(a);for(var f=0,d=s;f<d.length;f++){var v=d[f];v.dom.className+=" "+Qv(v),v.mount&&v.mount()}}else{var p,g=_createForOfIteratorHelper(this.panels);try{for(g.s();!(p=g.n()).done;){var m=p.value;m.update&&m.update(e)}}catch(y){g.e(y)}finally{g.f()}}}},{key:"destroy",value:function(){this.top.sync([]),this.bottom.sync([])}}]),e}(),{provide:Ec.scrollMargins.from((function(e){return{top:e.top.scrollMargin(),bottom:e.bottom.scrollMargin()}}))});function Qv(e){return Vu(e.style?"panel.".concat(e.style):"panel")}var Rv=function(){function e(t,n,r){_classCallCheck(this,e),this.view=t,this.top=n,this.container=r,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}return _createClass(e,[{key:"sync",value:function(e){this.panels=e,this.syncDOM()}},{key:"syncDOM",value:function(){if(0!=this.panels.length){if(!this.dom){this.dom=document.createElement("div"),this.dom.className=Vu(this.top?"panels.top":"panels.bottom"),this.dom.style[this.top?"top":"bottom"]="0";var e=this.container||this.view.dom;e.insertBefore(this.dom,this.top?e.firstChild:null)}var t,n=this.dom.firstChild,r=_createForOfIteratorHelper(this.panels);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(i.dom.parentNode==this.dom){for(;n!=i.dom;)n=Hv(n);n=n.nextSibling}else this.dom.insertBefore(i.dom,n)}}catch(o){r.e(o)}finally{r.f()}for(;n;)n=Hv(n)}else this.dom&&(this.dom.remove(),this.dom=void 0)}},{key:"scrollMargin",value:function(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-this.view.scrollDOM.getBoundingClientRect().top:this.view.scrollDOM.getBoundingClientRect().bottom-this.dom.getBoundingClientRect().top)}},{key:"syncClasses",value:function(){if(this.container&&this.classes!=this.view.themeClasses){var e,t=_createForOfIteratorHelper(this.classes.split(" "));try{for(t.s();!(e=t.n()).done;){var n=e.value;n&&this.container.classList.remove(n)}}catch(a){t.e(a)}finally{t.f()}var r,i=_createForOfIteratorHelper((this.classes=this.view.themeClasses).split(" "));try{for(i.s();!(r=i.n()).done;){var o=r.value;o&&this.container.classList.add(o)}}catch(a){i.e(a)}finally{i.f()}}}}]),e}();function Hv(e){var t=e.nextSibling;return e.remove(),t}var Nv=Hh.baseTheme({$panels:{boxSizing:"border-box",position:"sticky",left:0,right:0},"$$light $panels":{backgroundColor:"#f5f5f5",color:"black"},"$$light $panels.top":{borderBottom:"1px solid #ddd"},"$$light $panels.bottom":{borderTop:"1px solid #ddd"},"$$dark $panels":{backgroundColor:"#333338",color:"white"}}),Lv="function"==typeof String.prototype.normalize?function(e){return e.normalize("NFKD")}:function(e){return e},Fv=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length,o=arguments.length>4?arguments[4]:void 0;_classCallCheck(this,e),this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=t.iterRange(r,i),this.bufferStart=r,this.normalize=o?function(e){return o(Lv(e))}:Lv,this.query=this.normalize(n)}return _createClass(e,[{key:"peek",value:function(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return this.buffer.charCodeAt(this.bufferPos)}},{key:"next",value:function(){for(;;){var e=this.peek();if(e<0)return this.done=!0,this;var t=String.fromCharCode(e),n=this.bufferStart+this.bufferPos;for(this.bufferPos++;;){var r=this.peek();if(r<56320||r>=57344)break;this.bufferPos++,t+=String.fromCharCode(r)}for(var i=this.normalize(t),o=0,a=n;;o++){var s=i.charCodeAt(o),l=this.match(s,a);if(l)return this.value=l,this;if(o==i.length-1)break;a==n&&o<t.length&&t.charCodeAt(o)==s&&a++}}}},{key:"match",value:function(e,t){for(var n=null,r=0;r<this.matches.length;r+=2){var i=this.matches[r],o=!1;this.query.charCodeAt(i)==e&&(i==this.query.length-1?n={from:this.matches[r+1],to:t+1}:(this.matches[r]++,o=!0)),o||(this.matches.splice(r,2),r-=2)}return this.query.charCodeAt(0)==e&&(1==this.query.length?n={from:t,to:t+1}:this.matches.push(1,t)),n}}]),e}(),$v=function(){function e(t,n,r){_classCallCheck(this,e),this.search=t,this.replace=n,this.caseInsensitive=r}return _createClass(e,[{key:"eq",value:function(e){return this.search==e.search&&this.replace==e.replace&&this.caseInsensitive==e.caseInsensitive}},{key:"cursor",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length;return new Fv(e,this.search,t,n,this.caseInsensitive?function(e){return e.toLowerCase()}:void 0)}},{key:"valid",get:function(){return!!this.search}}]),e}(),Bv=Gs.define(),Vv=Gs.define(),zv=Ds.define({create:function(){return new jv(new $v("","",!1),[])},update:function(e,t){var n,r=_createForOfIteratorHelper(t.effects);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.is(Bv)?e=new jv(i.value,e.panel):i.is(Vv)&&(e=new jv(e.query,i.value?[np]:[]))}}catch(o){r.e(o)}finally{r.f()}return e},provide:[Ev.nFrom((function(e){return e.panel}))]}),jv=function e(t,n){_classCallCheck(this,e),this.query=t,this.panel=n},qv=Eu.mark({class:Vu("searchMatch")}),Wv=Eu.mark({class:Vu("searchMatch.selected")}),Uv=Qc.fromClass(function(){function e(t){_classCallCheck(this,e),this.view=t,this.decorations=this.highlight(t.state.field(zv))}return _createClass(e,[{key:"update",value:function(e){var t=e.state.field(zv);(t!=e.prevState.field(zv)||e.docChanged||e.selectionSet)&&(this.decorations=this.highlight(t))}},{key:"highlight",value:function(e){var t=e.query;if(!e.panel.length||!t.valid)return Eu.none;for(var n=this.view.state,r=this.view.viewport,i=t.cursor(n.doc,Math.max(0,r.from-t.search.length),Math.min(r.to+t.search.length,n.doc.length)),o=new kl,a=function(){var e=i.value,t=e.from,r=e.to,a=n.selection.ranges.some((function(e){return e.from==t&&e.to==r}));o.add(t,r,a?Wv:qv)};!i.next().done;)a();return o.finish()}}]),e}(),{decorations:function(e){return e.decorations}});function Xv(e){return function(t){var n=t.state.field(zv,!1);return n&&n.query.valid?e(t,n):rp(t)}}function Gv(e,t,n){var r=n.cursor(e,t).next();return r.done&&(r=n.cursor(e,0,t+n.search.length-1).next()).done?null:r.value}var Zv=Xv((function(e,t){var n=e.state.selection.primary,r=n.from,i=n.to,o=Gv(e.state.doc,e.state.selection.primary.from+1,t.query);return!(!o||o.from==r&&o.to==i||(e.dispatch({selection:{anchor:o.from,head:o.to},scrollIntoView:!0}),up(e),0))}));function Yv(e,t,n,r){for(var i=r;;){for(var o=Math.max(n,i-1e4-e.search.length),a=e.cursor(t,o,i),s=null;!a.next().done;)s=a.value;if(s)return s;if(o==n)return null;i-=1e4}}var Kv=Xv((function(e,t){var n=t.query,r=e.state,i=Yv(n,r.doc,0,r.selection.primary.to-1)||Yv(n,r.doc,r.selection.primary.from+1,r.doc.length);return!!i&&(e.dispatch({selection:{anchor:i.from,head:i.to},scrollIntoView:!0}),up(e),!0)})),Jv=Xv((function(e,t){for(var n=t.query.cursor(e.state.doc),r=[];!n.next().done;)r.push(Os.range(n.value.from,n.value.to));return!!r.length&&(e.dispatch({selection:Os.create(r)}),!0)})),ep=Xv((function(e,t){var n=t.query,r=e.state,i=Gv(r.doc,r.selection.primary.from,n);if(!i)return!1;var o,a=r.selection.primary,s=a.from,l=a.to,u=[];if(i.from==s&&i.to==l&&(u.push({from:i.from,to:i.to,insert:n.replace}),i=Gv(r.doc,i.to,n)),i){var c=0==u.length||u[0].from>=i.to?0:i.to-i.from-n.replace.length;o={anchor:i.from-c,head:i.to-c}}return e.dispatch({changes:u,selection:o,scrollIntoView:!!o}),i&&up(e),!0})),tp=Xv((function(e,t){for(var n=t.query,r=n.cursor(e.state.doc),i=[];!r.next().done;){var o=r.value,a=o.from,s=o.to;i.push({from:a,to:s,insert:n.replace})}return!!i.length&&(e.dispatch({changes:i}),!0)}));function np(e){var t=e.state.field(zv).query;return{dom:sp({view:e,query:t,updateQuery:function(n){t.eq(n)||(t=n,e.dispatch({effects:Bv.of(t)}))}}),mount:function(){this.dom.querySelector("[name=search]").select()},pos:80,style:"search"}}var rp=function(e){var t=e.state.field(zv,!1);if(t&&t.panel.length){var n=Dv(e,np);if(!n)return!1;n.dom.querySelector("[name=search]").focus()}else e.dispatch({effects:Vv.of(!0),reconfigure:t?void 0:{append:hp}});return!0},ip=function(e){var t=e.state.field(zv,!1);if(!t||!t.panel.length)return!1;var n=Dv(e,np);return n&&n.dom.contains(e.root.activeElement)&&e.focus(),e.dispatch({effects:Vv.of(!1)}),!0},op=[{key:"Mod-f",run:rp,scope:"editor search-panel"},{key:"F3",run:Zv,shift:Kv,scope:"editor search-panel"},{key:"Mod-g",run:Zv,shift:Kv,scope:"editor search-panel"},{key:"Escape",run:ip,scope:"editor search-panel"},{key:"Mod-Shift-l",run:function(e){var t=e.state,n=e.dispatch,r=t.selection;if(r.ranges.length>1||r.primary.empty)return!1;for(var i=r.primary,o=i.from,a=i.to,s=[],l=0,u=new Fv(t.doc,t.sliceDoc(o,a));!u.next().done;){if(s.length>1e3)return!1;u.value.from==o&&(l=s.length),s.push(Os.range(u.value.from,u.value.to))}return n(t.update({selection:new Os(s,l)})),!0}}];function ap(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=document.createElement(e);if(t)for(var i in t){var o=t[i];"string"==typeof o?r.setAttribute(i,o):r[i]=o}var a,s=_createForOfIteratorHelper(n);try{for(s.s();!(a=s.n()).done;){var l=a.value;r.appendChild("string"==typeof l?document.createTextNode(l):l)}}catch(u){s.e(u)}finally{s.f()}return r}function sp(e){function t(t){return e.view.state.phrase(t)}var n=ap("input",{value:e.query.search,placeholder:t("Find"),"aria-label":t("Find"),class:Vu("textfield"),name:"search",onchange:o,onkeyup:o}),r=ap("input",{value:e.query.replace,placeholder:t("Replace"),"aria-label":t("Replace"),class:Vu("textfield"),name:"replace",onchange:o,onkeyup:o}),i=ap("input",{type:"checkbox",name:"case",checked:!e.query.caseInsensitive,onchange:o});function o(){e.updateQuery(new $v(n.value,r.value,!i.checked))}function a(e,t,n){return ap("button",{class:Vu("button"),name:e,onclick:t},n)}return ap("div",{onkeydown:function(t){var i,o;o=t,Zh((i=e.view).state.facet(qh),o,i,"search-panel")?t.preventDefault():13==t.keyCode&&t.target==n?(t.preventDefault(),(t.shiftKey?Kv:Zv)(e.view)):13==t.keyCode&&t.target==r&&(t.preventDefault(),ep(e.view))}},[n,a("next",(function(){return Zv(e.view)}),[t("next")]),a("prev",(function(){return Kv(e.view)}),[t("previous")]),a("select",(function(){return Jv(e.view)}),[t("all")]),ap("label",null,[i,"match case"]),ap("br"),r,a("replace",(function(){return ep(e.view)}),[t("replace")]),a("replaceAll",(function(){return tp(e.view)}),[t("replace all")]),ap("button",{name:"close",onclick:function(){return ip(e.view)},"aria-label":t("close")},["\xd7"]),ap("div",{style:"position: absolute; top: -10000px","aria-live":"polite"})])}var lp=/[\s\.,:;?!]/;function up(e){var t=e.state.selection.primary,n=t.from,r=t.to,i=e.state.doc.lineAt(n).from,o=e.state.doc.lineAt(r).to,a=Math.max(i,n-30),s=Math.min(o,r+30),l=e.state.sliceDoc(a,s);if(a!=i)for(var u=0;u<30;u++)if(!lp.test(l[u+1])&&lp.test(l[u])){l=l.slice(u);break}if(s!=o)for(var c=l.length-1;c>l.length-30;c--)if(!lp.test(l[c-1])&&lp.test(l[c])){l=l.slice(0,c);break}var h=Dv(e,np);h&&h.dom.contains(e.root.activeElement)&&(h.dom.querySelector("div[aria-live]").textContent=e.state.phrase("current match")+". "+l)}var cp=Hh.baseTheme({"$panel.search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button":{margin:".2em .5em .2em 0"},"& label":{fontSize:"80%"}},"$$light $searchMatch":{backgroundColor:"#ffff0054"},"$$dark $searchMatch":{backgroundColor:"#00ffff8a"},"$$light $searchMatch.selected":{backgroundColor:"#ff6a0054"},"$$dark $searchMatch.selected":{backgroundColor:"#ff00ff8a"}}),hp=[zv,Qs(Uv,"override"),Iv(),cp],fp=Qc.fromClass(function(){function e(t){var n=this;_classCallCheck(this,e),this.view=t,this.inView=!0,this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.tooltips=t.state.facet(pp),this.tooltipViews=this.tooltips.map((function(e){return n.createTooltip(e)}))}return _createClass(e,[{key:"update",value:function(e){var t=e.state.facet(pp);if(t==this.tooltips){var n,r=_createForOfIteratorHelper(this.tooltipViews);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.update&&i.update(e)}}catch(v){r.e(v)}finally{r.f()}}else{for(var o=[],a=0;a<t.length;a++){for(var s=t[a],l=-1,u=0;u<this.tooltips.length;u++)this.tooltips[u].create==s.create&&(l=u);if(l<0)o[a]=this.createTooltip(s);else{var c=o[a]=this.tooltipViews[l];c.update&&c.update(e)}}var h,f=_createForOfIteratorHelper(this.tooltipViews);try{for(f.s();!(h=f.n()).done;){var d=h.value;o.indexOf(d)<0&&d.dom.remove()}}catch(v){f.e(v)}finally{f.f()}this.tooltips=t,this.tooltipViews=o,this.maybeMeasure()}}},{key:"createTooltip",value:function(e){var t=e.create(this.view);return t.dom.className=Vu("tooltip"+(e.style?"."+e.style:"")),this.view.dom.appendChild(t.dom),t.mount&&t.mount(this.view),t}},{key:"destroy",value:function(){var e,t=_createForOfIteratorHelper(this.tooltipViews);try{for(t.s();!(e=t.n()).done;){e.value.dom.remove()}}catch(n){t.e(n)}finally{t.f()}}},{key:"readMeasure",value:function(){var e=this;return{editor:this.view.dom.getBoundingClientRect(),pos:this.tooltips.map((function(t){return e.view.coordsAtPos(t.pos)})),size:this.tooltipViews.map((function(e){return e.dom.getBoundingClientRect()})),innerWidth:window.innerWidth,innerHeight:window.innerHeight}}},{key:"writeMeasure",value:function(e){for(var t=e.editor,n=0;n<this.tooltipViews.length;n++){var r=this.tooltips[n],i=this.tooltipViews[n],o=i.dom,a=e.pos[n],s=e.size[n];if(!a||a.bottom<=t.top||a.top>=t.bottom||a.right<=t.left||a.left>=t.right)o.style.top="-10000px";else{var l=s.right-s.left,u=s.bottom-s.top,c=this.view.textDirection==zu.LTR?Math.min(a.left,e.innerWidth-l):Math.max(0,a.left-l),h=!!r.above;!r.strictSide&&(h?a.top-(s.bottom-s.top)<0:a.bottom+(s.bottom-s.top)>e.innerHeight)&&(h=!h),o.style.top=(h?a.top-u:a.bottom)+"px",o.style.left=c+"px",i.positioned&&i.positioned()}}}},{key:"maybeMeasure",value:function(){this.tooltips.length&&((this.view.inView||this.inView)&&this.view.requestMeasure(this.measureReq),this.inView=this.view.inView)}}]),e}(),{eventHandlers:{scroll:function(){this.maybeMeasure()}}}),dp=Hh.baseTheme({$tooltip:{position:"fixed",border:"1px solid #ddd",backgroundColor:"#f5f5f5",zIndex:100}});function vp(){return[fp,dp]}var pp=Ps.define(),gp=function(){function e(t,n,r,i){_classCallCheck(this,e),this.view=t,this.source=n,this.field=r,this.setHover=i,this.lastMouseMove=null,this.hoverTimeout=-1,this.mouseInside=!1,this.checkHover=this.checkHover.bind(this),t.dom.addEventListener("mouseenter",this.mouseenter=this.mouseenter.bind(this)),t.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),t.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}return _createClass(e,[{key:"checkHover",value:function(){var e=this;if(this.hoverTimeout=-1,this.mouseInside&&!this.active){var t=Date.now(),n=this.lastMouseMove;if(t-n.timeStamp<750)this.hoverTimeout=setTimeout(this.checkHover,750-(t-n.timeStamp));else{var r=this.view.contentDOM.contains(n.target)?this.view.posAtCoords({x:n.clientX,y:n.clientY}):-1,i=r<0?null:this.source(this.view,(function(t,i){return t<=r&&i>=r&&(t==i||mp(e.view,t,i,n.clientX,n.clientY))}));i&&this.view.dispatch({effects:this.setHover.of(i)})}}}},{key:"mousemove",value:function(e){var t;this.lastMouseMove=e,this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,750));var n=this.active;if(n&&!function(e){for(var t=e;t;t=t.parentNode)if(1==t.nodeType&&t.classList.contains("cm-tooltip"))return!0;return!1}(e.target)){var r=n.pos,i=null!==(t=n.end)&&void 0!==t?t:r;(r==i?this.view.posAtCoords({x:e.clientX,y:e.clientY})==r:mp(this.view,r,i,e.clientX,e.clientY,10))||this.view.dispatch({effects:this.setHover.of(null)})}}},{key:"mouseenter",value:function(){this.mouseInside=!0}},{key:"mouseleave",value:function(){this.mouseInside=!1,this.active&&this.view.dispatch({effects:this.setHover.of(null)})}},{key:"destroy",value:function(){this.view.dom.removeEventListener("mouseenter",this.mouseenter),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}},{key:"active",get:function(){return this.view.state.field(this.field)}}]),e}();function mp(e,t,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=document.createRange(),s=e.domAtPos(t),l=e.domAtPos(n);a.setEnd(l.node,l.offset),a.setStart(s.node,s.offset);for(var u=a.getClientRects(),c=0;c<u.length;c++){var h=u[c];if(Math.max(h.top-i,i-h.bottom,h.left-r,r-h.right)<=o)return!0}return!1}function yp(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Gs.define(),r=Ds.define({create:function(){return null},update:function(e,r){if(e&&t.hideOnChange&&(r.docChanged||r.selection))return null;var i,o=_createForOfIteratorHelper(r.effects);try{for(o.s();!(i=o.n()).done;){var a=i.value;if(a.is(n))return a.value}}catch(u){o.e(u)}finally{o.f()}if(e&&r.docChanged){var s=r.changes.mapPos(e.pos,-1,ds.TrackDel);if(s<0)return null;var l=Object.assign(Object.create(null),e);return l.pos=s,null!=e.end&&(l.end=r.changes.mapPos(e.end)),l}return e},provide:[pp.nFrom((function(e){return e?[e]:[]}))]});return[r,Qc.define((function(t){return new gp(t,e,r,n)})),vp()]}var kp=function(){function e(t,n,r){_classCallCheck(this,e),this.state=t,this.pos=n,this.explicit=r,this.abortListeners=[]}return _createClass(e,[{key:"tokenBefore",value:function(e){for(var t=this.state.tree.resolve(this.pos,-1);t&&e.indexOf(t.name)<0;)t=t.parent;return t?{from:t.start,to:this.pos,text:this.state.sliceDoc(t.start,this.pos),type:t.type}:null}},{key:"matchBefore",value:function(e){var t=this.state.doc.lineAt(this.pos),n=Math.max(t.from,this.pos-250),r=t.slice(n-t.from,this.pos-t.from),i=r.search(_p(e,!1));return i<0?null:{from:n+i,to:this.pos,text:r.slice(i)}}},{key:"addEventListener",value:function(e,t){this.abortListeners&&this.abortListeners.push(t)}},{key:"aborted",get:function(){return null==this.abortListeners}}]),e}(),bp=function e(t,n,r){_classCallCheck(this,e),this.completion=t,this.source=n,this.match=r};function wp(e){return e.selection.primary.head}function _p(e,t){var n,r=e.source,i=t&&"^"!=r[0],o="$"!=r[r.length-1];return i||o?new RegExp("".concat(i?"^":"","(?:").concat(r,")").concat(o?"$":""),null!==(n=e.flags)&&void 0!==n?n:e.ignoreCase?"i":""):e}function Cp(e,t){var n=t.completion.apply||t.completion.label,r=t.source;"string"==typeof n?e.dispatch({changes:{from:r.from,to:r.to,insert:n},selection:{anchor:r.from+n.length}}):n(e,t.completion,r.from,r.to)}var Op=function(){function e(t){_classCallCheck(this,e),this.pattern=t,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[];for(var n=0;n<t.length;){var r=Ea(t,n),i=Ma(r);this.chars.push(r);var o=t.slice(n,n+i),a=o.toUpperCase();this.folded.push(Ea(a==o?o.toLowerCase():a,0)),n+=i}this.astral=t.length!=this.chars.length}return _createClass(e,[{key:"match",value:function(e){if(0==this.pattern.length)return[0];if(e.length<this.pattern.length)return null;var t=this.chars,n=this.folded,r=this.any,i=this.precise,o=this.byWord;if(1==t.length){var a=Ea(e,0);return a==t[0]?[0,0,Ma(a)]:a==n[0]?[-200,0,Ma(a)]:null}var s=e.indexOf(this.pattern);if(0==s)return[0,0,this.pattern.length];var l=t.length,u=0;if(s<0){for(var c=0,h=Math.min(e.length,200);c<h&&u<l;){var f=Ea(e,c);f!=t[u]&&f!=n[u]||(r[u++]=c),c+=Ma(f)}if(u<l)return null}for(var d=0,v=0,p=!1,g=0,m=-1,y=-1,k=0,b=Math.min(e.length,200),w=0;k<b&&v<l;){var _=Ea(e,k);s<0&&(d<l&&_==t[d]&&(i[d++]=k),g<l&&(_==t[g]||_==n[g]?(0==g&&(m=k),y=k,g++):g=0));var C=void 0,O=_<255?_>=48&&_<=57||_>=97&&_<=122?2:_>=65&&_<=90?1:0:(C=Da(_))!=C.toLowerCase()?1:C!=C.toUpperCase()?2:0;(1==O||0==w&&0!=O&&(this.chars[v]==_||this.folded[v]==_&&(p=!0)))&&(o[v++]=k),w=O,k+=Ma(_)}return v==l&&0==o[0]?this.result((p?-200:0)-100,o,e):g==l&&0==m?[-200,0,y]:s>-1?[-700,s,s+this.pattern.length]:g==l?[-900,m,y]:v==l?this.result((p?-200:0)-100-700,o,e):2==t.length?null:this.result((r[0]?-700:0)-200-1100,r,e)}},{key:"result",value:function(e,t,n){var r,i=[e],o=1,a=_createForOfIteratorHelper(t);try{for(a.s();!(r=a.n()).done;){var s=r.value,l=s+(this.astral?Ma(Ea(n,s)):1);o>1&&i[o-1]==s?i[o-1]=l:(i[o++]=s,i[o++]=l)}}catch(u){a.e(u)}finally{a.f()}return i}}]),e}(),xp=Ps.define({combine:function(e){return al(e,{activateOnTyping:!0,override:null,maxRenderedOptions:100})}}),Sp=Hh.baseTheme({"$tooltip.autocomplete":{"& > ul":{fontFamily:"monospace",overflowY:"auto",whiteSpace:"nowrap",maxHeight:"10em",listStyle:"none",margin:0,padding:0,"& > li":{cursor:"pointer",padding:"1px 1em 1px 3px",lineHeight:1.2},"& > li[aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"}}},"$completionListIncompleteTop:before, $completionListIncompleteBottom:after":{content:'"\xb7\xb7\xb7"',opacity:.5,display:"block",textAlign:"center"},"$tooltip.completionInfo":{position:"absolute",padding:"3px 9px",minWidth:"max-content",maxWidth:"300px"},"$$light $snippetField":{backgroundColor:"#ddd"},"$$dark $snippetField":{backgroundColor:"#333"},$snippetFieldPosition:{verticalAlign:"text-top",width:0,height:"1.15em",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},$completionMatchedText:{textDecoration:"underline"},$completionDetail:{marginLeft:"0.5em",fontStyle:"italic"},$completionIcon:{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6"},"$completionIcon.function, $completionIcon.method":{"&:after":{content:"'\u0192'"}},"$completionIcon.class":{"&:after":{content:"'\u25cb'"}},"$completionIcon.interface":{"&:after":{content:"'\u25cc'"}},"$completionIcon.variable":{"&:after":{content:"'\ud835\udc65'"}},"$completionIcon.constant":{"&:after":{content:"'\ud835\udc36'"}},"$completionIcon.type":{"&:after":{content:"'\ud835\udc61'"}},"$completionIcon.enum":{"&:after":{content:"'\u222a'"}},"$completionIcon.property":{"&:after":{content:"'\u25a1'"}},"$completionIcon.keyword":{"&:after":{content:"'\ud83d\udd11\ufe0e'"}},"$completionIcon.namespace":{"&:after":{content:"'\u25a2'"}},"$completionIcon.text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});function Ap(e,t,n){var r=document.createElement("ul");r.id=t,r.setAttribute("role","listbox"),r.setAttribute("aria-expanded","true");for(var i=n.from;i<n.to;i++){var o=e[i],a=o.completion,s=o.match,l=r.appendChild(document.createElement("li"));l.id=t+"-"+i;var u=l.appendChild(document.createElement("div"));u.className=Vu("completionIcon"+(a.type?"."+a.type:"")),u.setAttribute("aria-hidden","true");var c=l.appendChild(document.createElement("span"));c.className=Vu("completionLabel");for(var h=a.label,f=a.detail,d=0,v=1;v<s.length;){var p=s[v++],g=s[v++];p>d&&c.appendChild(document.createTextNode(h.slice(d,p)));var m=c.appendChild(document.createElement("span"));m.appendChild(document.createTextNode(h.slice(p,g))),m.className=Vu("completionMatchedText"),d=g}if(d<h.length&&c.appendChild(document.createTextNode(h.slice(d))),f){var y=l.appendChild(document.createElement("span"));y.className=Vu("completionDetail"),y.textContent=f}l.setAttribute("role","option")}return n.from&&r.classList.add(Vu("completionListIncompleteTop")),n.to<e.length&&r.classList.add(Vu("completionListIncompleteBottom")),r}function Pp(e,t,n){if(e<=n)return{from:0,to:e};if(t<=e>>1){var r=Math.floor(t/n);return{from:r*n,to:(r+1)*n}}var i=Math.floor((e-t)/n);return{from:e-(i+1)*n,to:e-i*n}}var Tp=function(){function e(t,n){var r=this;_classCallCheck(this,e),this.view=t,this.stateField=n,this.info=null,this.placeInfo={read:function(){return r.measureInfo()},write:function(e){return r.positionInfo(e)},key:this};var i=t.state.field(n),o=i.open,a=o.options,s=o.selected,l=t.state.facet(xp);this.range=Pp(a.length,s,l.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.addEventListener("mousedown",(function(e){for(var n=r.range.from,i=e.target;i=i.previousSibling;)n++;n<a.length&&Cp(t,a[n]),e.preventDefault()})),this.list=this.dom.appendChild(Ap(a,i.id,this.range)),this.list.addEventListener("scroll",(function(){r.info&&r.view.requestMeasure(r.placeInfo)}))}return _createClass(e,[{key:"mount",value:function(){this.updateSel()}},{key:"update",value:function(e){e.state.field(this.stateField)!=e.prevState.field(this.stateField)&&this.updateSel()}},{key:"positioned",value:function(){this.info&&this.view.requestMeasure(this.placeInfo)}},{key:"updateSel",value:function(){var e=this,t=this.view.state.field(this.stateField),n=t.open;if((n.selected<this.range.from||n.selected>=this.range.to)&&(this.range=Pp(n.options.length,n.selected,this.view.state.facet(xp).maxRenderedOptions),this.list.remove(),this.list=this.dom.appendChild(Ap(n.options,t.id,this.range)),this.list.addEventListener("scroll",(function(){e.info&&e.view.requestMeasure(e.placeInfo)}))),this.updateSelectedOption(n.selected)){this.info&&(this.info.remove(),this.info=null);var r=n.options[n.selected];r.completion.info&&(this.info=this.dom.appendChild(function(e){var t=document.createElement("div");t.className=Vu("tooltip.completionInfo");var n=e.completion.info;return"string"==typeof n?t.textContent=n:t.appendChild(n(e.completion)),t}(r)),this.view.requestMeasure(this.placeInfo))}}},{key:"updateSelectedOption",value:function(e){for(var t=null,n=this.list.firstChild,r=this.range.from;n;n=n.nextSibling,r++)r==e?n.hasAttribute("aria-selected")||(n.setAttribute("aria-selected","true"),t=n):n.hasAttribute("aria-selected")&&n.removeAttribute("aria-selected");return t&&function(e,t){var n=e.getBoundingClientRect(),r=t.getBoundingClientRect();r.top<n.top?e.scrollTop-=n.top-r.top:r.bottom>n.bottom&&(e.scrollTop+=r.bottom-n.bottom)}(this.list,t),t}},{key:"measureInfo",value:function(){var e=this.dom.querySelector("[aria-selected]");if(!e)return null;var t=this.dom.getBoundingClientRect(),n=e.getBoundingClientRect().top-t.top;if(n<0||n>this.list.clientHeight-10)return null;var r=this.view.textDirection==zu.RTL,i=t.left,o=innerWidth-t.right;return r&&i<Math.min(300,o)?r=!1:!r&&o<Math.min(300,i)&&(r=!0),{top:n,left:r}}},{key:"positionInfo",value:function(e){this.info&&e&&(this.info.style.top=e.top+"px",this.info.style.right=e.left?"100%":"",this.info.style.left=e.left?"":"100%")}}]),e}(),Ip=function(){function e(t,n,r,i,o){_classCallCheck(this,e),this.options=t,this.attrs=n,this.tooltip=r,this.timestamp=i,this.selected=o}return _createClass(e,[{key:"setSelected",value:function(t,n){return t==this.selected||t>=this.options.length?this:new e(this.options,Dp(n,t),this.tooltip,this.timestamp,t)}},{key:"map",value:function(t){return new e(this.options,this.attrs,[Object.assign(Object.assign({},this.tooltip[0]),{pos:t.mapPos(this.tooltip[0].pos)})],this.timestamp,this.selected)}}],[{key:"build",value:function(t,n,r,i){var o=function(e,t){var n,r=[],i=_createForOfIteratorHelper(e);try{for(i.s();!(n=i.n()).done;){var o=n.value;if(o.hasResult()){var a,s=void 0,l=new Op(t.sliceDoc(o.from,o.to)),u=_createForOfIteratorHelper(o.result.options);try{for(u.s();!(a=u.n()).done;){var c=a.value;(s=l.match(c.label))&&(null!=c.boost&&(s[0]+=c.boost),r.push(new bp(c,o,s)))}}catch(h){u.e(h)}finally{u.f()}}}}catch(h){i.e(h)}finally{i.f()}return r.sort(Rp),r.length>300?r.slice(0,300):r}(t,n);if(!o.length)return null;var a,s=0;if(i)for(var l=i.options[i.selected].completion,u=0;u<o.length&&!s;u++)o[u].completion==l&&(s=u);return new e(o,Dp(r,s),[{pos:t.reduce((function(e,t){return t.hasResult()?Math.min(e,t.from):e}),1e8),style:"autocomplete",create:(a=Bp,function(e){return new Tp(e,a)})}],i?i.timestamp:Date.now(),s)}}]),e}(),Ep=function(){function e(t,n,r){_classCallCheck(this,e),this.active=t,this.id=n,this.open=r}return _createClass(e,[{key:"update",value:function(t){var n=this,r=t.state,i=r.facet(xp),o=(i.override||r.languageDataAt("autocomplete",wp(r))).map((function(e){return(n.active.find((function(t){return t.source==e}))||new Hp(e,0,!1)).update(t,i)}));o.length==this.active.length&&o.every((function(e,t){return e==n.active[t]}))&&(o=this.active);var a,s=t.selection||o.some((function(e){return e.hasResult()&&t.changes.touchesRange(e.from,e.to)}))||!function(e,t){if(e==t)return!0;for(var n=0,r=0;;){for(;n<e.length&&!e[n].hasResult;)n++;for(;r<t.length&&!t[r].hasResult;)r++;var i=n==e.length,o=r==t.length;if(i||o)return i==o;if(e[n++].result!=t[r++].result)return!1}}(o,this.active)?Ip.build(o,r,this.id,this.open):this.open&&t.docChanged?this.open.map(t.changes):this.open,l=_createForOfIteratorHelper(t.effects);try{for(l.s();!(a=l.n()).done;){var u=a.value;u.is($p)&&(s=s&&s.setSelected(u.value,this.id))}}catch(c){l.e(c)}finally{l.f()}return o==this.active&&s==this.open?this:new e(o,this.id,s)}},{key:"tooltip",get:function(){return this.open?this.open.tooltip:Qp}},{key:"attrs",get:function(){return this.open?this.open.attrs:Mp}}],[{key:"start",value:function(){return new e(Qp,"cm-ac-"+Math.floor(2e6*Math.random()).toString(36),null)}}]),e}();function Dp(e,t){return{"aria-autocomplete":"list","aria-activedescendant":e+"-"+t,"aria-owns":e}}var Mp={"aria-autocomplete":"list"},Qp=[];function Rp(e,t){var n=t.match[0]-e.match[0];if(n)return n;var r=e.completion.label,i=t.completion.label;return r<i?-1:r==i?0:1}var Hp=function(){function e(t,n,r){_classCallCheck(this,e),this.source=t,this.state=n,this.explicit=r}return _createClass(e,[{key:"hasResult",value:function(){return!1}},{key:"update",value:function(t,n){var r=t.annotation(Ys.userEvent),i=this;"input"==r||"delete"==r?i=i.handleUserEvent(t,r,n):t.docChanged?i=i.handleChange(t):t.selection&&0!=i.state&&(i=new e(i.source,0,!1));var o,a=_createForOfIteratorHelper(t.effects);try{for(a.s();!(o=a.n()).done;){var s=o.value;if(s.is(Lp))i=s.value?new e(i.source,1,!0):new e(i.source,0,!1);else if(s.is(Fp)){var l,u=_createForOfIteratorHelper(s.value);try{for(u.s();!(l=u.n()).done;){var c=l.value;c.source==i.source&&(i=c)}}catch(h){u.e(h)}finally{u.f()}}}}catch(h){a.e(h)}finally{a.f()}return i}},{key:"handleUserEvent",value:function(t,n,r){return"delete"!=n&&r.activateOnTyping?new e(this.source,1,!1):this}},{key:"handleChange",value:function(t){return t.changes.touchesRange(wp(t.startState))?new e(this.source,0,!1):this}}]),e}(),Np=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,i,o,a,s){var l;return _classCallCheck(this,n),(l=t.call(this,e,2,r)).result=i,l.from=o,l.to=a,l.span=s,l}return _createClass(n,[{key:"hasResult",value:function(){return!0}},{key:"handleUserEvent",value:function(e,t,r){var i=e.changes.mapPos(this.from),o=e.changes.mapPos(this.to,1),a=wp(e.state);return(this.explicit?a<i:a<=i)||a>o?new Hp(this.source,"input"==t&&r.activateOnTyping?1:0,!1):this.span&&(i==o||this.span.test(e.state.sliceDoc(i,o)))?new n(this.source,this.explicit,this.result,i,o,this.span):new Hp(this.source,1,this.explicit)}},{key:"handleChange",value:function(e){return e.changes.touchesRange(this.from,this.to)?new Hp(this.source,0,!1):new n(this.source,this.explicit,this.result,e.changes.mapPos(this.from),e.changes.mapPos(this.to,1),this.span)}},{key:"map",value:function(e){return new n(this.source,this.explicit,this.result,e.mapPos(this.from),e.mapPos(this.to,1),this.span)}}]),n}(Hp),Lp=Gs.define(),Fp=Gs.define({map:function(e,t){return e.map((function(e){return e.hasResult()&&!t.empty?e.map(t):e}))}}),$p=Gs.define(),Bp=Ds.define({create:function(){return Ep.start()},update:function(e,t){return e.update(t)},provide:[pp.nFrom((function(e){return e.tooltip})),Hh.contentAttributes.from((function(e){return e.attrs}))]});function Vp(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"option";return function(n){var r=n.state.field(Bp,!1);if(!r||!r.open||Date.now()-r.open.timestamp<75)return!1;var i,o=1;"page"==t&&(i=n.dom.querySelector(".cm-tooltip-autocomplete"))&&(o=Math.max(2,Math.floor(i.offsetHeight/i.firstChild.offsetHeight)));var a=r.open.selected+o*(e?1:-1),s=r.open.options.length;return a<0?a="page"==t?0:s-1:a>=s&&(a="page"==t?s-1:0),n.dispatch({effects:$p.of(a)}),!0}}var zp=function(e){var t=e.state.field(Bp,!1);return!(!t||!t.open||Date.now()-t.open.timestamp<75||(Cp(e,t.open.options[t.open.selected]),0))},jp=function e(t,n){_classCallCheck(this,e),this.source=t,this.context=n,this.time=Date.now(),this.updates=[],this.done=void 0},qp=Qc.fromClass(function(){function e(t){_classCallCheck(this,e),this.view=t,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1;var n,r=_createForOfIteratorHelper(t.state.field(Bp).active);try{for(r.s();!(n=r.n()).done;){var i=n.value;1==i.state&&this.startQuery(i)}}catch(o){r.e(o)}finally{r.f()}}return _createClass(e,[{key:"update",value:function(e){var t=this,n=e.state.field(Bp);if(e.selectionSet||e.docChanged||e.prevState.field(Bp)!=n){for(var r=e.transactions.some((function(e){var t=e.annotation(Ys.userEvent);return(e.selection||e.docChanged)&&"input"!=t&&"delete"!=t})),i=0;i<this.running.length;i++){var o,a=this.running[i];if(r||a.updates.length+e.transactions.length>50&&a.time-Date.now()>1e3){var s,l=_createForOfIteratorHelper(a.context.abortListeners);try{for(l.s();!(s=l.n()).done;){var u=s.value;try{u()}catch(c){Pc(this.view.state,c)}}}catch(h){l.e(h)}finally{l.f()}a.context.abortListeners=null,this.running.splice(i--,1)}else(o=a.updates).push.apply(o,_toConsumableArray(e.transactions))}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),this.debounceUpdate=n.active.some((function(e){return 1==e.state&&!t.running.some((function(t){return t.source==e.source}))}))?setTimeout((function(){return t.startUpdate()}),50):-1}}},{key:"startUpdate",value:function(){var e=this;this.debounceUpdate=-1;var t,n=_createForOfIteratorHelper(this.view.state.field(Bp).active);try{var r=function(){var n=t.value;1!=n.state||e.running.some((function(e){return e.source==n.source}))||e.startQuery(n)};for(n.s();!(t=n.n()).done;)r()}catch(i){n.e(i)}finally{n.f()}}},{key:"startQuery",value:function(e){var t=this,n=this.view.state,r=wp(n),i=new kp(n,r,e.explicit),o=new jp(e.source,i);this.running.push(o),Promise.resolve(e.source(i)).then((function(e){o.context.aborted||(o.done=e||null,t.scheduleAccept())}),(function(e){t.view.dispatch({effects:Lp.of(!1)}),Pc(t.view.state,e)}))}},{key:"scheduleAccept",value:function(){var e=this;this.running.every((function(e){return void 0!==e.done}))?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout((function(){return e.accept()}),50))}},{key:"accept",value:function(){var e,t=this;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;for(var n=[],r=this.view.state.facet(xp),i=function(i){var a=t.running[i];if(void 0===a.done)return o=i,"continue";if(t.running.splice(i--,1),a.done){var s,l=new Np(a.source,a.context.explicit,a.done,a.done.from,null!==(e=a.done.to)&&void 0!==e?e:wp(a.updates.length?a.updates[0].startState:t.view.state),a.done.span?_p(a.done.span,!0):null),u=_createForOfIteratorHelper(a.updates);try{for(u.s();!(s=u.n()).done;){var c=s.value;l=l.update(c,r)}}catch(g){u.e(g)}finally{u.f()}if(l.hasResult())return n.push(l),o=i,"continue"}var h=t.view.state.field(Bp).active.find((function(e){return e.source==a.source}));if(h&&1==h.state)if(null==a.done){var f,d=new Hp(a.source,0,!1),v=_createForOfIteratorHelper(a.updates);try{for(v.s();!(f=v.n()).done;){var p=f.value;d=d.update(p,r)}}catch(g){v.e(g)}finally{v.f()}1!=d.state&&n.push(d)}else t.startQuery(h);o=i},o=0;o<this.running.length;o++)i(o);n.length&&this.view.dispatch({effects:Fp.of(n)})}}]),e}()),Wp=function e(t,n,r,i){_classCallCheck(this,e),this.field=t,this.line=n,this.from=r,this.to=i},Up=function(){function e(t,n,r){_classCallCheck(this,e),this.field=t,this.from=n,this.to=r}return _createClass(e,[{key:"map",value:function(t){return new e(this.field,t.mapPos(this.from,-1),t.mapPos(this.to,1))}}]),e}(),Xp=function(){function e(t,n){_classCallCheck(this,e),this.lines=t,this.fieldPositions=n}return _createClass(e,[{key:"instantiate",value:function(e,t){var n,r=[],i=[t],o=e.doc.lineAt(t),a=/^\s*/.exec(o.slice(0,Math.min(100,o.length)))[0],s=_createForOfIteratorHelper(this.lines);try{for(s.s();!(n=s.n()).done;){var l=n.value;if(r.length){for(var u=a,c=/^\t*/.exec(l)[0].length,h=0;h<c;h++)u+=e.facet(ol.indentUnit);i.push(t+u.length-c),l=u+l.slice(c)}r.push(l),t+=l.length+1}}catch(f){s.e(f)}finally{s.f()}return{text:r,ranges:this.fieldPositions.map((function(e){return new Up(e.field,i[e.line]+e.from,i[e.line]+e.to)}))}}}],[{key:"parse",value:function(t){var n,r,i=[],o=[],a=[],s=_createForOfIteratorHelper(t.split(/\r\n?|\n/));try{for(s.s();!(r=s.n()).done;){for(var l=r.value;n=/[#$]\{(?:(\d+)(?::([^}]*))?|([^}]*))\}/.exec(l);){for(var u=n[1]?+n[1]:null,c=n[2]||n[3],h=-1,f=0;f<i.length;f++)(c?i[f].name==c:null!=u&&i[f].seq==u)&&(h=f);if(h<0){for(var d=0;d<i.length&&(null==u||null!=i[d].seq&&i[d].seq<u);)d++;i.splice(d,0,{seq:u,name:c||null}),h=d}a.push(new Wp(h,o.length,n.index,n.index+c.length)),l=l.slice(0,n.index)+c+l.slice(n.index+n[0].length)}o.push(l)}}catch(v){s.e(v)}finally{s.f()}return new e(o,a)}}]),e}(),Gp=Eu.widget({widget:new(function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"toDOM",value:function(){var e=document.createElement("span");return e.className=Vu("snippetFieldPosition"),e}},{key:"ignoreEvent",value:function(){return!1}}]),n}(Iu))}),Zp=Eu.mark({class:Vu("snippetField")}),Yp=function(){function e(t,n){_classCallCheck(this,e),this.ranges=t,this.active=n,this.deco=Eu.set(t.map((function(e){return(e.from==e.to?Gp:Zp).range(e.from,e.to)})))}return _createClass(e,[{key:"map",value:function(t){return new e(this.ranges.map((function(e){return e.map(t)})),this.active)}},{key:"selectionInsideField",value:function(e){var t=this;return e.ranges.every((function(e){return t.ranges.some((function(n){return n.field==t.active&&n.from<=e.from&&n.to>=e.to}))}))}}]),e}(),Kp=Gs.define({map:function(e,t){return e&&e.map(t)}}),Jp=Gs.define(),eg=Ds.define({create:function(){return null},update:function(e,t){var n,r=_createForOfIteratorHelper(t.effects);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.is(Kp))return i.value;if(i.is(Jp)&&e)return new Yp(e.ranges,i.value)}}catch(o){r.e(o)}finally{r.f()}return e&&t.docChanged&&(e=e.map(t.changes)),e&&t.selection&&!e.selectionInsideField(t.selection)&&(e=null),e},provide:[Hh.decorations.from((function(e){return e?e.deco:Eu.none}))]});function tg(e,t){return Os.create(e.filter((function(e){return e.field==t})).map((function(e){return Os.range(e.from,e.to)})))}function ng(e){var t=Xp.parse(e);return function(e,n,r,i){var o=t.instantiate(e.state,r),a=o.text,s=o.ranges,l={changes:{from:r,to:i,insert:Ha.of(a)}};s.length&&(l.selection=tg(s,0)),s.length>1&&(l.effects=Kp.of(new Yp(s,0)),void 0===e.state.field(eg,!1)&&(l.reconfigure={append:[eg,og,Sp]})),e.dispatch(e.state.update(l))}}function rg(e){return function(t){var n=t.state,r=t.dispatch,i=n.field(eg,!1);if(!i||e<0&&0==i.active)return!1;var o=i.active+e,a=e>0&&!i.ranges.some((function(t){return t.field==o+e}));return r(n.update({selection:tg(i.ranges,o),effects:Kp.of(a?null:new Yp(i.ranges,o))})),!0}}var ig,og=Qs(Uh([{key:"Tab",run:rg(1),shift:rg(-1)},{key:"Escape",run:function(e){var t=e.state,n=e.dispatch;return!!t.field(eg,!1)&&(n(t.update({effects:Kp.of(null)})),!0)}}]),"override"),ag=[{key:"Mod-Space",run:function(e){return!!e.state.field(Bp,!1)&&(e.dispatch({effects:Lp.of(!0)}),!0)}},{key:"Escape",run:function(e){var t=e.state.field(Bp,!1);return!(!t||!t.active.some((function(e){return 0!=e.state}))||(e.dispatch({effects:Lp.of(!1)}),0))}}],sg=[{key:"Mod-/",run:function(e){return lg(hg(ig.Toggle),e)}},{key:"Alt-A",run:function(e){return lg(cg(ig.Toggle),e)}}];function lg(e,t){var n=e(t.state);return!!n&&(t.dispatch(n),!0)}function ug(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.selection.primary.head;return e.languageDataAt("commentTokens",t)[0]||{}}!function(e){e[e.Toggle=0]="Toggle",e[e.OnlyComment=1]="OnlyComment",e[e.OnlyUncomment=2]="OnlyUncomment"}(ig||(ig={}));var cg=function(e){return function(t){var n=ug(t);return n.block?new fg(n.block.open,n.block.close).toggle(e,t):null}},hg=function(e){return function(t){var n=ug(t);return n.line?new vg(n.line).toggle(e,t):null}},fg=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:" ";_classCallCheck(this,e),this.open=t,this.close=n,this.margin=r}return _createClass(e,[{key:"toggle",value:function(e,t){var n=this,r=this.isSelectionCommented(t);if(null!==r){if(e!==ig.OnlyComment)return t.update({changes:r.map((function(e){var t=e.open,r=e.close;return[{from:t.pos-n.open.length,to:t.pos+t.margin},{from:r.pos-r.margin,to:r.pos+n.close.length}]}))})}else if(e!==ig.OnlyUncomment)return t.update(t.changeByRange((function(e){var t=(n.open+n.margin).length;return{changes:[{from:e.from,insert:n.open+n.margin},{from:e.to,insert:n.margin+n.close}],range:Os.range(e.anchor+t,e.head+t)}})));return null}},{key:"isSelectionCommented",value:function(e){var t,n=[],r=_createForOfIteratorHelper(e.selection.ranges);try{for(r.s();!(t=r.n()).done;){var i=t.value,o=this.isRangeCommented(e,i);if(null===o)return null;n.push(o)}}catch(a){r.e(a)}finally{r.f()}return n}},{key:"isRangeCommented",value:function(e,t){var n,r,i=e.sliceDoc(t.from-dg,t.from),o=e.sliceDoc(t.to,t.to+dg),a=/\s*$/.exec(i)[0].length,s=/^\s*/.exec(o)[0].length,l=i.length-a;if(i.slice(l-this.open.length,l)==this.open&&o.slice(s,s+this.close.length)==this.close)return{open:{pos:t.from-a,margin:a&&1},close:{pos:t.to+s,margin:s&&1}};t.to-t.from<=2*dg?n=r=e.sliceDoc(t.from,t.to):(n=e.sliceDoc(t.from,t.from+dg),r=e.sliceDoc(t.to-dg,t.to));var u=/^\s*/.exec(n)[0].length,c=/\s*$/.exec(r)[0].length,h=r.length-c-this.close.length;return n.slice(u,u+this.open.length)==this.open&&r.slice(h,h+this.close.length)==this.close?{open:{pos:t.from+u+this.open.length,margin:/\s/.test(n.charAt(u+this.open.length))?1:0},close:{pos:t.to-c-this.close.length,margin:/\s/.test(r.charAt(h-1))?1:0}}:null}}]),e}(),dg=50,vg=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";_classCallCheck(this,e),this.lineCommentToken=t,this.margin=n}return _createClass(e,[{key:"toggle",value:function(e,t){for(var n=[],r={},i=0;i<t.selection.ranges.length;i++){var o=pg(t.doc,t.selection.ranges[i]);n.push.apply(n,_toConsumableArray(o)),r[i]=o}var a=this.isRangeCommented(t,n);if(a.isRangeLineSkipped){if(e!=ig.OnlyComment){for(var s=[],l=0;l<t.selection.ranges.length;l++){var u,c=r[l],h=_createForOfIteratorHelper(c);try{for(h.s();!(u=h.n()).done;){var f=u.value;if(!(c.length>1&&a.isLineSkipped[f.number])){var d=f.from+a.minCol,v=a.minCol+this.lineCommentToken.length,p=" "==f.slice(v,v+1)?1:0;s.push({from:d,to:d+this.lineCommentToken.length+p})}}}catch(_){h.e(_)}finally{h.f()}}return t.update({changes:s})}}else if(e!=ig.OnlyUncomment){for(var g=[],m=0;m<t.selection.ranges.length;m++){var y,k=r[m],b=_createForOfIteratorHelper(k);try{for(b.s();!(y=b.n()).done;){var w=y.value;(k.length<=1||!a.isLineSkipped[w.number])&&g.push({from:w.from+a.minCol,insert:this.lineCommentToken+this.margin})}}catch(_){b.e(_)}finally{b.f()}}return t.update({changes:g})}return null}},{key:"isRangeCommented",value:function(e,t){var n,r=1/0,i=!0,o=[],a=_createForOfIteratorHelper(t);try{for(a.s();!(n=a.n()).done;){var s=n.value,l=s.slice(0,Math.min(s.length,dg)),u=/^\s*/.exec(l)[0].length;(1==t.length||u<l.length)&&u<r&&(r=u),i&&(1==t.length||u<l.length)&&l.slice(u,u+this.lineCommentToken.length)!=this.lineCommentToken&&(i=!1),o[s.number]=u==l.length}}catch(c){a.e(c)}finally{a.f()}return{minCol:r,isRangeLineSkipped:i,isLineSkipped:o}}}]),e}();function pg(e,t){for(var n=e.lineAt(t.from),r=[];(n.from+n.length<t.to||n.from<=t.to&&t.to<=n.to)&&(r.push(n),n.number+1<=e.lines);)n=e.line(n.number+1);return r}function gg(e,t){var n=e.posAtCoords({x:t.clientX,y:t.clientY}),r=e.state.doc.lineAt(n),i=n-r.from,o=i>2e3?-1:i==r.length?function(e,t){var n=e.coordsAtPos(e.viewport.from);return n?Math.round(Math.abs((n.left-t)/e.defaultCharacterWidth)):-1}(e,t.clientX):Qa(r.slice(0,n-r.from),0,e.state.tabSize);return{line:r.number,col:o,off:i}}var mg="undefined"==typeof Symbol?"__goto-line":Symbol("goto-line");function yg(e){var t=document.createElement("form");t.innerHTML="<label>".concat(e.state.phrase("Go to line:")," <input class=").concat(Vu("textfield")," name=line></label>\n<button class=").concat(Vu("button")," type=submit>").concat(e.state.phrase("go"),"</button>");var n=t.querySelector("input");function r(){var t=parseInt(n.value,10);e.dispatch({reconfigure:_defineProperty({},mg,[kg]),selection:!isNaN(t)&&t>0&&t<=e.state.doc.lines?Os.cursor(e.state.doc.line(t).from):void 0,scrollIntoView:!0}),e.focus()}return t.addEventListener("keydown",(function(t){27==t.keyCode?(t.preventDefault(),e.dispatch({reconfigure:{append:[kg]}}),e.focus()):13==t.keyCode&&(t.preventDefault(),r())})),t.addEventListener("submit",r),{dom:t,style:"gotoLine",pos:-10}}var kg=Hh.baseTheme({"$panel.gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),bg=[{key:"Alt-g",run:function(e){var t=Dv(e,yg);return t||(e.dispatch({reconfigure:{append:[Iv(),Ev.of(yg),kg]}}),t=Dv(e,yg)),t&&t.dom.querySelector("input").focus(),!0}}],wg=Eu.line({attributes:{class:Vu("activeLine")}}),_g=Qc.fromClass(function(){function e(t){_classCallCheck(this,e),this.decorations=this.getDeco(t)}return _createClass(e,[{key:"update",value:function(e){(e.docChanged||e.selectionSet)&&(this.decorations=this.getDeco(e.view))}},{key:"getDeco",value:function(e){var t,n=-1,r=[],i=_createForOfIteratorHelper(e.state.selection.ranges);try{for(i.s();!(t=i.n()).done;){var o=t.value;if(o.empty){var a=e.visualLineAt(o.head);a.from>n&&(r.push(wg.range(a.from)),n=a.from)}}}catch(s){i.e(s)}finally{i.f()}return Eu.set(r)}}]),e}(),{decorations:function(e){return e.decorations}}),Cg={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100},Og=Ps.define({combine:function(e){return al(e,Cg,{highlightWordAroundCursor:function(e,t){return e||t},minSelectionLength:Math.min,maxMatches:Math.min})}}),xg=Eu.mark({class:Vu("selectionMatch")}),Sg=Eu.mark({class:Vu("selectionMatch.main")}),Ag=Qc.fromClass(function(){function e(t){_classCallCheck(this,e),this.decorations=this.getDeco(t)}return _createClass(e,[{key:"update",value:function(e){(e.selectionSet||e.docChanged||e.viewportChanged)&&(this.decorations=this.getDeco(e.view))}},{key:"getDeco",value:function(e){var t=e.state.facet(Og),n=e.state,r=n.selection;if(r.ranges.length>1)return Eu.none;var i,o=r.primary,a=null;if(o.empty){if(!t.highlightWordAroundCursor)return Eu.none;if(a=n.charCategorizer(o.head),!(i=function(e,t,n){for(var r=e.lineAt(t),i=t-r.from,o=t-r.from;i>0;){var a=r.findClusterBreak(i,!1);if(n(r.slice(a,i))!=tl.Word)break;i=a}for(;o<r.length;){var s=r.findClusterBreak(o,!0);if(n(r.slice(o,s))!=tl.Word)break;o=s}return i==o?null:r.slice(i,o)}(n.doc,o.head,a)))return Eu.none}else{var s=o.to-o.from;if(s<t.minSelectionLength||s>200)return Eu.none;if(!(i=n.sliceDoc(o.from,o.to).trim()))return Eu.none}var l,u=[],c=_createForOfIteratorHelper(e.visibleRanges);try{for(c.s();!(l=c.n()).done;)for(var h=l.value,f=new Fv(n.doc,i,h.from,h.to);!f.next().done;){var d=f.value,v=d.from,p=d.to;if((!a||(0==v||a(n.sliceDoc(v-1,v))!=tl.Word)&&(p==n.doc.length||a(n.sliceDoc(p,p+1))!=tl.Word))&&(a&&v<=o.from&&p>=o.to?u.push(Sg.range(v,p)):(v>=o.to||p<=o.from)&&u.push(xg.range(v,p)),u.length>t.maxMatches))return Eu.none}}catch(g){c.e(g)}finally{c.f()}return Eu.set(u)}}]),e}(),{decorations:function(e){return e.decorations}}),Pg=Hh.baseTheme({"$$light $activeLine":{backgroundColor:"#eff5ff"},"$$dark $activeLine":{backgroundColor:"#223039"},$selectionMatch:{backgroundColor:"#99ff7780"},"$searchMatch $selectionMatch":{backgroundColor:"transparent"}}),Tg=new(function(){function e(t){var n=this;_classCallCheck(this,e),this.typeNames=[""],this.typeIDs=Object.create(null),this.prop=new Ka,this.flags=t.flags,this.types=t.types,this.flagMask=Math.pow(2,this.flags.length)-1,this.typeShift=this.flags.length;var r=t.subtypes||0,i=[void 0];this.typeIDs[""]=0;var o,a=1,s=_createForOfIteratorHelper(t.types);try{for(s.s();!(o=s.n()).done;){var l=o.value,u=/^([\w\-]+)(?:=([\w-]+))?$/.exec(l);if(!u)throw new RangeError("Invalid type name "+l);var c=a++;this.typeNames[c]=u[1],this.typeIDs[u[1]]=c,i[c]=u[2];for(var h=0;h<r;h++){var f=a++,d=u[1]+"#"+(h+1);this.typeNames[f]=d,this.typeIDs[d]=f,i[f]=u[1]}}}catch(v){s.e(v)}finally{s.f()}if(this.parents=i.map((function(e){if(null==e)return 0;var t=n.typeIDs[e];if(null==t)throw new RangeError("Unknown parent type '".concat(e,"' specified"));return t})),this.flags.length>30||this.typeNames.length>Math.pow(2,30-this.flags.length))throw new RangeError("Too many style tag flags to fit in a 30-bit integer")}return _createClass(e,[{key:"get",value:function(e){var t,n=0,r=_createForOfIteratorHelper(e.split(" "));try{for(r.s();!(t=r.n()).done;){var i=t.value;if(i){var o=this.flags.indexOf(i);if(o>-1)n+=1<<o;else{var a=this.typeIDs[i];if(null==a)throw new RangeError("Unknown tag type '".concat(i,"'"));if(n>>this.typeShift)throw new RangeError("Multiple tag types specified in '".concat(e,"'"));n+=a<<this.typeShift}}}}catch(s){r.e(s)}finally{r.f()}return n}},{key:"getWithMode",value:function(e){var t="+"==e[0]?1:"!"==e[0]?0:2;return{mode:t,tag:this.get(2==t?e:e.slice(1))}}},{key:"addTagProp",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getWithMode(e),r=n.mode,i=n.tag;return this.prop.set(t,new Eg(i,r,Ig))}},{key:"add",value:function(e){var t=Object.create(null);for(var n in e){var r,i=e[n],o=this.getWithMode(i),a=o.mode,s=o.tag,l=_createForOfIteratorHelper(n.split(" "));try{for(l.s();!(r=l.n()).done;){var u=r.value.split("/"),c=u[u.length-1],h=u.length>1?u.slice(0,u.length-1).map((function(e){return"*"==e?null:e})):Ig,f=new Eg(s,a,h);t[c]=f.sort(t[c])}}catch(d){l.e(d)}finally{l.f()}}return this.prop.add(t)}},{key:"highlighter",value:function(e){var t=this,n=new Qg(this,e);return[Qs(Qc.define((function(e){return new Rg(e,t.prop,n)}),{decorations:function(e){return e.decorations}}),"fallback"),Hh.styleModule.of(n.module)]}},{key:"specificity",value:function(e){for(var t=e&this.flagMask,n=0,r=1;r<=this.flags.length;r++)t&1<<r&&n++;for(var i=e>>this.typeShift;i;i=this.parents[i])n+=/#/.test(this.typeNames[i])?500:1e3;return n}}]),e}())({flags:["invalid","meta","standard","definition","constant","local","control","link","strong","emphasis","monospace","changed","inserted","deleted"],subtypes:7,types:["comment","lineComment=comment","blockComment=comment","docComment=comment","name","variableName=name","typeName=name","propertyName=name","className=name","labelName=name","functionName=name","namespace=name","literal","string=literal","docString=string","character=string","number=literal","integer=number","float=number","bool=literal","regexp=literal","escape=literal","color=literal","content","heading=content","list=content","quote=content","keyword","self=keyword","null=keyword","atom=keyword","unit=keyword","modifier=keyword","operatorKeyword=keyword","operator","derefOperator=operator","arithmeticOperator=operator","logicOperator=operator","bitwiseOperator=operator","compareOperator=operator","updateOperator=operator","typeOperator=operator","punctuation","separator=punctuation","bracket=punctuation","angleBracket=bracket","squareBracket=bracket","paren=bracket","brace=bracket"]}),Ig=[],Eg=function(){function e(t,n,r,i){_classCallCheck(this,e),this.tag=t,this.mode=n,this.context=r,this.next=i}return _createClass(e,[{key:"sort",value:function(e){return!e||e.context.length<this.context.length?(this.next=e,this):(e.next=this.sort(e.next),e)}}]),e}(),Dg=function(e){return Tg.highlighter(e)},Mg=function e(t,n,r,i){_classCallCheck(this,e),this.type=t,this.flags=n,this.specificity=r,this.cls=i},Qg=function(){function e(t,n){_classCallCheck(this,e),this.tags=t,this.cache=Object.create(null);var r=Object.create(null),i=[];for(var o in n){var a=cl.newName();r["."+a]=n[o];var s,l=_createForOfIteratorHelper(o.split(/\s*,\s*/));try{for(l.s();!(s=l.n()).done;){var u=s.value,c=t.get(u);i.push(new Mg(c>>t.typeShift,c&t.flagMask,t.specificity(c),a))}}catch(h){l.e(h)}finally{l.f()}}this.rules=i.sort((function(e,t){return t.specificity-e.specificity})),this.module=new cl(r)}return _createClass(e,[{key:"match",value:function(e){var t=this.cache[e];if(null!=t)return t;for(var n="",r=e>>this.tags.typeShift,i=e&this.tags.flagMask;;){var o,a=_createForOfIteratorHelper(this.rules);try{for(a.s();!(o=a.n()).done;){var s=o.value;if(s.type==r&&(s.flags&i)==s.flags&&(n&&(n+=" "),n+=s.cls,i&=~s.flags,r))break}}catch(l){a.e(l)}finally{a.f()}if(!r)break;r=this.tags.parents[r]}return this.cache[e]=n}}]),e}(),Rg=function(){function e(t,n,r){_classCallCheck(this,e),this.prop=n,this.styling=r,this.nodeStack=[""],this.classStack=[""],this.inheritStack=[""],this.tree=t.state.tree,this.decorations=this.buildDeco(t.visibleRanges,this.tree)}return _createClass(e,[{key:"update",value:function(e){var t=e.state.facet(ol.syntax);t.length?t[0].parsePos(e.state)<e.view.viewport.to?this.decorations=this.decorations.map(e.changes):(this.tree!=t[0].getTree(e.state)||e.viewportChanged)&&(this.tree=t[0].getTree(e.state),this.decorations=this.buildDeco(e.view.visibleRanges,this.tree)):this.decorations=Eu.none}},{key:"buildDeco",value:function(e,t){var n,r,i,o=this,a=new kl;function s(e,t){e>n&&t&&a.add(n,e,Eu.mark({class:t})),n=e}var l,u=this.nodeStack,c=this.classStack,h=this.inheritStack,f=_createForOfIteratorHelper(e);try{var d=function(){var e=l.value,a=e.from,f=e.to;r="",i=0,n=a,t.iterate({from:a,to:f,enter:function(e,t){i++;for(var n=h[i-1],a=n,l=e.prop(o.prop),f=!1;l;){if(!l.context.length||Hg(l.context,u,i)){var d=o.styling.match(l.tag);d&&(a&&(a+=" "),a+=d,1==l.mode?n=a:0==l.mode&&(f=!0));break}l=l.next}if(a!=r&&(s(t,r),r=a),f)return i--,!1;c[i]=a,h[i]=n,u[i]=e.name},leave:function(e,t,n){i--;var o=c[i];o!=r&&(s(Math.min(f,n),r),r=o)}})};for(f.s();!(l=f.n()).done;)d()}catch(v){f.e(v)}finally{f.f()}return a.finish()}}]),e}();function Hg(e,t,n){if(e.length>n-1)return!1;for(var r=n-1,i=e.length-1;i>=0;i--,r--){var o=e[i];if(o&&o!=t[r])return!1}return!0}var Ng=Dg({deleted:{textDecoration:"line-through"},inserted:{textDecoration:"underline"},link:{textDecoration:"underline"},strong:{fontWeight:"bold"},emphasis:{fontStyle:"italic"},keyword:{color:"#708"},"atom, bool":{color:"#219"},number:{color:"#164"},string:{color:"#a11"},"regexp, escape, string#2":{color:"#e40"},"variableName definition":{color:"#00f"},typeName:{color:"#085"},className:{color:"#167"},"name#2":{color:"#256"},"propertyName definition":{color:"#00c"},comment:{color:"#940"},meta:{color:"#555"},invalid:{color:"#f00"}}),Lg=function e(t,n,r){_classCallCheck(this,e),this.from=t,this.to=n,this.diagnostic=r},Fg=function e(t,n,r){_classCallCheck(this,e),this.diagnostics=t,this.panel=n,this.selected=r};function $g(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=null;return e.between(n,e.length,(function(e,n,i){var o=i.spec;if(!t||o.diagnostic==t)return r=new Lg(e,n,o.diagnostic),!1})),r}function Bg(e){return e.field(qg,!1)?void 0:{append:[qg,Hh.decorations.compute([qg],(function(e){var t=e.field(qg),n=t.selected,r=t.panel;return n&&r&&n.from!=n.to?Eu.set([Wg.range(n.from,n.to)]):Eu.none})),Iv(),yp(Ug),tm]}}var Vg=Gs.define(),zg=Gs.define(),jg=Gs.define(),qg=Ds.define({create:function(){return new Fg(Eu.none,null,null)},update:function(e,t){if(t.docChanged){var n=e.diagnostics.map(t.changes),r=null;if(e.selected){var i=t.changes.mapPos(e.selected.from,1);r=$g(n,e.selected.diagnostic,i)||$g(n,null,i)}e=new Fg(n,e.panel,r)}var o,a=_createForOfIteratorHelper(t.effects);try{for(a.s();!(o=a.n()).done;){var s=o.value;if(s.is(Vg)){var l=Eu.set(s.value.map((function(e){return e.from<e.to?Eu.mark({attributes:{class:Vu("lintRange."+e.severity)},diagnostic:e}).range(e.from,e.to):Eu.widget({widget:new Yg(e),diagnostic:e}).range(e.from)})));e=new Fg(l,e.panel,$g(l))}else s.is(zg)?e=new Fg(e.diagnostics,s.value?Jg.open:null,e.selected):s.is(jg)&&(e=new Fg(e.diagnostics,e.panel,s.value))}}catch(u){a.e(u)}finally{a.f()}return e},provide:[Ev.nFrom((function(e){return e.panel?[e.panel]:[]})),Hh.decorations.from((function(e){return e.diagnostics}))]}),Wg=Eu.mark({class:Vu("lintRange.active")});function Ug(e,t){var n=e.state.field(qg).diagnostics,r=[],i=2e8,o=0;return n.between(0,e.state.doc.length,(function(e,n,a){var s=a.spec;t(e,n)&&(r.push(s.diagnostic),i=Math.min(e,i),o=Math.max(n,o))})),r.length?{pos:i,end:o,above:e.state.doc.lineAt(i).to<o,style:"lint",create:function(){var t,n=document.createElement("ul"),i=_createForOfIteratorHelper(r);try{for(i.s();!(t=i.n()).done;){var o=t.value;n.appendChild(Zg(e,o))}}catch(a){i.e(a)}finally{i.f()}return{dom:n}}}:null}var Xg=function(e){var t=e.state.field(qg,!1);return!(!t||!t.panel||(e.dispatch({effects:zg.of(!1)}),0))},Gg=[{key:"Mod-Shift-m",run:function(e){var t=e.state.field(qg,!1);t&&t.panel||e.dispatch({effects:zg.of(!0),reconfigure:Bg(e.state)});var n=Dv(e,Jg.open);return n&&n.dom.querySelector(".cm-panel-lint ul").focus(),!0}},{key:"F8",run:function(e){var t=e.state.field(qg,!1);if(!t)return!1;var n=e.state.selection.primary,r=t.diagnostics.iter(n.to+1);return!(!r.value&&(r=t.diagnostics.iter(0),!r.value||r.from==n.from&&r.to==n.to)||(e.dispatch({selection:{anchor:r.from,head:r.to},scrollIntoView:!0}),0))}}];function Zg(e,t){var n=document.createElement("li");if(n.textContent=t.message,n.className=Vu("diagnostic."+t.severity),t.actions){var r,i=_createForOfIteratorHelper(t.actions);try{var o=function(){var i=r.value,o=n.appendChild(document.createElement("button"));o.className=Vu("diagnosticAction"),o.textContent=i.name,o.onclick=o.onmousedown=function(n){n.preventDefault();var r=$g(e.state.field(qg).diagnostics,t);r&&i.apply(e,r.from,r.to)}};for(i.s();!(r=i.n()).done;)o()}catch(a){i.e(a)}finally{i.f()}}return n}var Yg=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this)).diagnostic=e,r}return _createClass(n,[{key:"eq",value:function(e){return e.diagnostic==this.diagnostic}},{key:"toDOM",value:function(){var e=document.createElement("span");return e.className=Vu("lintPoint."+this.diagnostic.severity),e}}]),n}(Iu),Kg=function e(t,n){_classCallCheck(this,e),this.diagnostic=n,this.id="item_"+Math.floor(4294967295*Math.random()).toString(16),this.dom=Zg(t,n),this.dom.setAttribute("role","option")},Jg=function(){function e(t){var n=this;_classCallCheck(this,e),this.view=t,this.items=[],this.dom=document.createElement("div"),this.list=this.dom.appendChild(document.createElement("ul")),this.list.tabIndex=0,this.list.setAttribute("role","listbox"),this.list.setAttribute("aria-label",this.view.state.phrase("Diagnostics")),this.list.addEventListener("keydown",(function(e){27==e.keyCode?(e.preventDefault(),Xg(n.view),n.view.focus()):38==e.keyCode?(e.preventDefault(),n.moveSelection((n.selectedIndex-1+n.items.length)%n.items.length)):40==e.keyCode?(e.preventDefault(),n.moveSelection((n.selectedIndex+1)%n.items.length)):36==e.keyCode?(e.preventDefault(),n.moveSelection(0)):35==e.keyCode?(e.preventDefault(),n.moveSelection(n.items.length-1)):13==e.keyCode&&(e.preventDefault(),n.view.focus())})),this.list.addEventListener("click",(function(e){for(var t=0;t<n.items.length;t++)n.items[t].dom.contains(e.target)&&n.moveSelection(t)}));var r=this.dom.appendChild(document.createElement("button"));r.setAttribute("name","close"),r.setAttribute("aria-label",this.view.state.phrase("close")),r.textContent="\xd7",r.addEventListener("click",(function(){return Xg(n.view)})),this.update()}return _createClass(e,[{key:"update",value:function(){var e=this,t=this.view.state.field(qg),n=t.diagnostics,r=t.selected,i=0,o=!1,a=null;for(n.between(0,this.view.state.doc.length,(function(t,n,s){for(var l,u=s.spec,c=-1,h=i;h<e.items.length;h++)if(e.items[h].diagnostic==u.diagnostic){c=h;break}c<0?(l=new Kg(e.view,u.diagnostic),e.items.splice(i,0,l),o=!0):(l=e.items[c],c>i&&(e.items.splice(i,c-i),o=!0)),r&&l.diagnostic==r.diagnostic?l.dom.hasAttribute("aria-selected")||(l.dom.setAttribute("aria-selected","true"),a=l):l.dom.hasAttribute("aria-selected")&&l.dom.removeAttribute("aria-selected"),i++}));i<this.items.length&&!(1==this.items.length&&this.items[0].diagnostic.from<0);)o=!0,this.items.pop();0==this.items.length&&(this.items.push(new Kg(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),o=!0),a?(this.list.setAttribute("aria-activedescendant",a.id),this.view.requestMeasure({key:this,read:function(){return{sel:a.dom.getBoundingClientRect(),panel:e.list.getBoundingClientRect()}},write:function(t){var n=t.sel,r=t.panel;n.top<r.top?e.list.scrollTop-=r.top-n.top:n.bottom>r.bottom&&(e.list.scrollTop+=n.bottom-r.bottom)}})):this.items.length||this.list.removeAttribute("aria-activedescendant"),o&&this.sync()}},{key:"sync",value:function(){var e=this.list.firstChild;function t(){var t=e;e=t.nextSibling,t.remove()}var n,r=_createForOfIteratorHelper(this.items);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.dom.parentNode==this.list){for(;e!=i.dom;)t();e=i.dom.nextSibling}else this.list.insertBefore(i.dom,e)}}catch(o){r.e(o)}finally{r.f()}for(;e;)t();this.list.firstChild||this.list.appendChild(Zg(this.view,{severity:"info",message:this.view.state.phrase("No diagnostics")}))}},{key:"moveSelection",value:function(e){if(0!=this.items.length){var t=$g(this.view.state.field(qg).diagnostics,this.items[e].diagnostic);t&&this.view.dispatch({selection:{anchor:t.from,head:t.to},scrollIntoView:!0,effects:jg.of(t)})}}},{key:"selectedIndex",get:function(){var e=this.view.state.field(qg).selected;if(!e)return-1;for(var t=0;t<this.items.length;t++)if(this.items[t].diagnostic==e.diagnostic)return t;return-1}},{key:"style",get:function(){return"lint"}}],[{key:"open",value:function(t){return new e(t)}}]),e}();function em(e){return"url('data:image/svg+xml;base64,".concat(btoa('<svg xmlns="http://www.w3.org/2000/svg" width="6" height="3">\n    <path d="m0 3 l2 -2 l1 0 l2 2 l1 0" stroke="'.concat(e,'" fill="none" stroke-width=".7"/>\n  </svg>')),"')")}var tm=Hh.baseTheme({$diagnostic:{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block"},"$diagnostic.error":{borderLeft:"5px solid #d11"},"$diagnostic.warning":{borderLeft:"5px solid orange"},"$diagnostic.info":{borderLeft:"5px solid #999"},$diagnosticAction:{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px"},$lintRange:{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x"},"$lintRange.error":{backgroundImage:em("#d11")},"$lintRange.warning":{backgroundImage:em("orange")},"$lintRange.info":{backgroundImage:em("#999")},"$lintRange.active":{backgroundColor:"#ffdd9980"},$lintPoint:{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},"$lintPoint.warning":{"&:after":{borderBottomColor:"orange"}},"$lintPoint.info":{"&:after":{borderBottomColor:"#999"}},"$panel.lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd"},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}},"$tooltip.lint":{padding:0,margin:0}}),nm=[function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[Kf.of(e),ed]}(),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=[df.of(e),vf];return hf()||t.push(yf),t}(),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[Cf,_f.of(e)]}(),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.assign(Object.assign({},pd),e),n=new gd(t,!0),r=new gd(t,!1);return[zf({style:"foldGutter",lineMarker:function(e,t){return sd(e.state,t.from,t.to)?r:ld(e.state,t.from,t.to)?n:null},initialSpacer:function(){return new gd(t,!1)},domEventHandlers:{click:function(e,t){var n=sd(e.state,t.from,t.to);if(n)return e.dispatch({effects:id.of(n)}),!0;var r=ld(e.state,t.from,t.to);return!!r&&(e.dispatch({effects:rd.of(r)}),!0)}}}),dd()]}(),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[Kh.of(e),ef,nf]}(),ol.allowMultipleSelections.of(!0),ol.transactionFilter.of((function(e){if(!e.docChanged||"input"!=e.annotation(Ys.userEvent))return e;var t=e.startState.languageDataAt("indentOnInput",e.startState.selection.primary.head);if(!t.length)return e;var n=e.newDoc,r=e.newSelection.primary.head,i=n.lineAt(r);if(r>i.from+200)return e;var o=n.sliceString(i.from,r);if(!t.some((function(e){return e.test(o)})))return e;var a,s=e.state,l=-1,u=[],c=_createForOfIteratorHelper(s.selection.ranges);try{var h=function(){var e=a.value.head,t=s.doc.lineAt(e);if(t.from==l)return"continue";l=t.from;var n=Math.max.apply(Math,_toConsumableArray(s.facet(ol.indentation).map((function(e){return e(new Ws(s),t.from)}))));if(n<0)return"continue";var r=/^\s*/.exec(t.slice(0,Math.min(t.length,200)))[0],i=s.indentString(n);r!=i&&u.push({from:t.from,to:t.from+r.length,insert:i})};for(c.s();!(a=c.n()).done;)h()}catch(f){c.e(f)}finally{c.f()}return u.length?[e,{changes:u}]:e})),Ng,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[kd.of(e),_d]}(),Hh.inputHandler.of((function(e,t,n,r){if(e.composing)return!1;var i=e.state.selection.primary;if(r.length>2||2==r.length&&1==Ma(Ea(r,0))||t!=i.from||n!=i.to)return!1;var o=function(e,t){var n,r=_v(e,e.selection.primary.head),i=r.brackets||bv.brackets,o=_createForOfIteratorHelper(i);try{for(o.s();!(n=o.n()).done;){var a=n.value,s=wv(Ea(a,0));if(t==a)return s==a?Av(e,a,i.indexOf(a+a+a)>-1):xv(e,a,s,r.before||bv.before);if(t==s)return Sv(e,0,s)}}catch(l){o.e(l)}finally{o.f()}return null}(e.state,r);return!!o&&(e.dispatch(o),!0)})),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[Bp,xp.of(e),qp,Sp,vp(),Qs(Uh([{key:"ArrowDown",run:Vp(!0)},{key:"ArrowUp",run:Vp(!1)},{key:"PageDown",run:Vp(!0,"page")},{key:"PageUp",run:Vp(!1,"page")},{key:"Enter",run:zp}]),"override")]}(),Hh.mouseSelectionStyle.of((function(e,t){return(n=t).altKey&&0==n.button?function(e,t){var n=gg(e,t),r=e.state.selection;return{update:function(e){if(e.docChanged){var t=e.changes.mapPos(e.prevState.doc.line(n.line).from),i=e.state.doc.lineAt(t);n={line:i.number,col:n.col,off:Math.min(n.off,i.length)},r=r.map(e.changes)}},get:function(t,i,o){var a=gg(e,t),s=function(e,t,n){var r=Math.min(t.line,n.line),i=Math.max(t.line,n.line),o=[];if(t.off>2e3||n.off>2e3||t.col<0||n.col<0)for(var a=Math.min(t.off,n.off),s=Math.max(t.off,n.off),l=r;l<=i;l++){var u=e.doc.line(l);u.length<=s&&o.push(Os.range(u.from+a,u.to+s))}else for(var c=Math.min(t.col,n.col),h=Math.max(t.col,n.col),f=r;f<=i;f++){var d=e.doc.line(f),v=d.length>2e3?d.slice(0,2*h):d.slice(),p=Ra(v,0,c,e.tabSize),g=Ra(v,0,h,e.tabSize);p.leftOver||o.push(Os.range(d.from+p.offset,d.from+g.offset))}return o}(e.state,n,a);return s.length?Os.create(o?s.concat(r.ranges):s):r}}}(e,t):null;var n})),[Pg,_g],[Pg,Ag],Uh([].concat(Cv,_toConsumableArray(kv),op,Ff,cd,sg,bg,ag,Gg))],rm=new Ka;function im(e){return ol.indentation.of((function(t,n){return function(e,t,n){for(var r=t.resolve(n),i=r,o=n;;){var a=i.childBefore(o);if(!a)break;a.type.prop(Ka.error)&&a.start==a.end?(r=i,o=a.start):o=(i=a).end+1}for(;r;r=r.parent){var s=om(r);if(s)return s(new sm(e,n,r))}return-1}(t,e.getTree(t.state),n)}))}function om(e){var t=e.type.prop(rm);if(t)return t;var n,r=e.firstChild;if(r&&(n=r.type.prop(Ka.closedBy))){var i=e.lastChild,o=i&&n.indexOf(i.name)>-1;return function(e){return function(e,t,n,r,i){var o=e.textAfter.match(/^\s*/)[0].length,a=i==e.pos+o,s=function(e){var t,n=e.node,r=n.childAfter(n.start),i=n.lastChild;if(!r)return null;for(var o=null===(t=e.options)||void 0===t?void 0:t.simulateBreak,a=e.state.doc.lineAt(r.start),s=null==o||o<=a.from?a.to:Math.min(a.to,o),l=r.end;;){var u=n.childAfter(l);if(!u||u==i)return null;if(!u.type.prop(Ka.skipped))return u.start<s?r:null;l=u.end}}(e);return s?e.column(a?s.start:s.end):e.baseIndent+(a?0:1*e.unit)}(e,0,0,0,o&&!function(e){var t,n;return e.pos==(null===(t=e.options)||void 0===t?void 0:t.simulateBreak)&&(null===(n=e.options)||void 0===n?void 0:n.simulateDoubleBreak)}(e)?i.start:void 0)}}return null==e.parent?am:null}function am(){return 0}var sm=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,i){var o;return _classCallCheck(this,n),(o=t.call(this,e.state,e.options)).pos=r,o.node=i,o}return _createClass(n,[{key:"textAfter",get:function(){return this.textAfterPos(this.pos)}},{key:"baseIndent",get:function(){for(var e=this.state.doc.lineAt(this.node.start);;){for(var t=this.node.resolve(e.from);t.parent&&t.parent.start==t.start;)t=t.parent;if(lm(t,this.node))break;e=this.state.doc.lineAt(t.start)}return this.lineIndent(e)}}]),n}(Ws);function lm(e,t){for(var n=t;n;n=n.parent)if(e==n)return!0;return!1}var um=new Ka,cm=function(){function e(t,n,r){var i=this;_classCallCheck(this,e),this.parser=t,this.dialect=n,this.languageData=r;var o,a=Gs.define();this.field=Ds.define({create:function(e){return pm.advance(rs.empty,i,e.doc)},update:function(e,t){return e.apply(t,i,a)}}),this.extension=[ol.syntax.of(this),this.field,Qc.define((function(e){return new ym(e,i,a)})),im(this),(o=this,ol.foldable.of((function(e,t,n){for(var r=null,i=o.getTree(e).resolve(n);i;i=i.parent)if(!(i.end<=n||i.start>n)){if(r&&i.start<t)break;var a=i.type.prop(um);if(a){var s=a(i,e);s&&s.from<=n&&s.from>=t&&s.to>n&&(r=s)}}return r})))]}return _createClass(e,[{key:"withDialect",value:function(t){return new e(this.parser,t,this.languageData)}},{key:"getTree",value:function(e){return e.field(this.field).tree}},{key:"parsePos",value:function(e){return e.field(this.field).upto}},{key:"ensureTree",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,r=e.field(this.field);if(r.upto>=t)return r.updatedTree;if(r.parse||r.startParse(this,e.doc),r.parse.pos<t){var i=fm(r.parse,n,t);if(i)return r.stopParse(i,e.doc.length)}return r.parse.pos<t?null:r.stopParse()}},{key:"languageDataFacetAt",value:function(e,t){if(this.parser.hasNested)for(var n=this.getTree(e).resolve(t,-1);n;){var r=n.type.prop(js);if(r)return r;n=n.parent}return this.languageData}}],[{key:"define",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=Ps.define({combine:n.languageData?function(e){return e.concat(n.languageData)}:void 0});return new e(t.withProps(js.add(_defineProperty({},t.topType.name,r))),n.dialect||"",r)}}]),e}(),hm=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.length;_classCallCheck(this,e),this.doc=t,this.length=n,this.cursorPos=0,this.string="",this.cursor=t.iter()}return _createClass(e,[{key:"get",value:function(e){if(e>=this.length)return-1;var t=this.cursorPos-this.string.length;return(e<t||e>=this.cursorPos)&&(e<this.cursorPos&&(this.cursor=this.doc.iter(),this.cursorPos=0),this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,t=this.cursorPos-this.string.length),this.string.charCodeAt(e-t)}},{key:"read",value:function(e,t){var n=this.cursorPos-this.string.length;return e<n||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-n,t-n)}},{key:"clip",value:function(t){return new e(this.doc,t)}}]),e}();function fm(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5e6,r=Date.now()+t;;){var i=e.advance();if(i)return i;if(e.pos>n||Date.now()>r)return null}}function dm(e,t){var n=e.forceFinish(),r=n.applyChanges([{fromA:e.pos,toA:n.length,fromB:e.pos,toB:n.length}]).append(t.applyChanges([{fromA:0,toA:e.pos,fromB:0,toB:e.pos}]));return{parsed:n,cache:r}}var vm,pm=function(){function e(t,n,r){_classCallCheck(this,e),this.tree=t,this.upto=n,this.cache=r,this.parse=null,this.updatedTree=t}return _createClass(e,[{key:"apply",value:function(t,n,r){var i,o=_createForOfIteratorHelper(t.effects);try{for(o.s();!(i=o.n()).done;){var a=i.value;if(a.is(r))return a.value}}catch(l){o.e(l)}finally{o.f()}if(!t.docChanged)return this;var s=[];return t.changes.iterChangedRanges((function(e,t,n,r){return s.push({fromA:e,toA:t,fromB:n,toB:r})})),e.advance((this.parse?dm(this.parse,this.updatedTree).cache:this.cache).applyChanges(s),n,t.state.doc)}},{key:"startParse",value:function(e,t){this.parse=e.parser.startParse(new hm(t),{cache:this.cache,dialect:e.dialect})}},{key:"stopParse",value:function(e,t){var n;return e?this.cache=e:(e=(n=dm(this.parse,this.updatedTree)).parsed,this.cache=n.cache),this.updatedTree=e,this.upto=null!=t?t:this.parse.pos,this.parse=null,e}}],[{key:"advance",value:function(t,n,r){var i=n.parser.startParse(new hm(r),{cache:t,dialect:n.dialect}),o=fm(i,25);if(o)return new e(o,r.length,o);var a=dm(i,t);return new e(a.parsed,i.pos,a.cache)}}]),e}(),gm="undefined"!=typeof window&&window.requestIdleCallback||function(e,t){var n=t.timeout;return setTimeout(e,n)},mm="undefined"!=typeof window&&window.cancelIdleCallback||clearTimeout,ym=function(){function e(t,n,r){_classCallCheck(this,e),this.view=t,this.syntax=n,this.setSyntax=r,this.working=-1,this.work=this.work.bind(this),this.scheduleWork()}return _createClass(e,[{key:"update",value:function(e){e.docChanged&&this.scheduleWork()}},{key:"scheduleWork",value:function(){if(!(this.working>-1)){var e=this.view.state;e.field(this.syntax.field).upto>=e.doc.length||(this.working=gm(this.work,{timeout:200}))}}},{key:"work",value:function(e){this.working=-1;var t=this.view.state,n=t.field(this.syntax.field);if(!(n.upto>=t.doc.length)){n.parse||n.startParse(this.syntax,t.doc);var r=fm(n.parse,e?Math.max(25,e.timeRemaining()):100);if(r||n.parse.badness>.8){var i=n.stopParse(r,t.doc.length);this.view.dispatch({effects:this.setSyntax.of(new pm(i,t.doc.length,n.cache))})}else this.scheduleWork()}}},{key:"destroy",value:function(){this.working>=0&&mm(this.working)}}]),e}(),km=function(e,t){return(km=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},bm=function(){function e(e,t,n,r,i,o,a,s,l){this.cx=e,this.stack=t,this.state=n,this.reducePos=r,this.pos=i,this.score=o,this.buffer=a,this.bufferBase=s,this.parent=l}return e.prototype.toString=function(){return"["+this.stack.filter((function(e,t){return t%3==0})).concat(this.state)+"]@"+this.pos+(this.score?"!"+this.score:"")},e.start=function(t,n,r){return void 0===r&&(r=0),new e(t,[],n,r,r,0,[],0,null)},e.prototype.pushState=function(e,t){this.stack.push(this.state,t,this.bufferBase+this.buffer.length),this.state=e},e.prototype.reduce=function(e){var t=e>>19,n=65535&e,r=this.cx.parser,i=r.dynamicPrecedence(n);if(i&&(this.score+=i),0==t)return n<r.minRepeatTerm&&this.storeNode(n,this.reducePos,this.reducePos,4,!0),void this.pushState(r.getGoto(this.state,n,!0),this.reducePos);var o=this.stack.length-3*(t-1)-(262144&e?6:0),a=this.stack[o-2],s=this.bufferBase+this.buffer.length-this.stack[o-1];if(n<r.minRepeatTerm||131072&e){var l=r.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(n,a,l,s+4,!0)}for(this.state=262144&e?this.stack[o]:r.getGoto(this.stack[o-3],n,!0);this.stack.length>o;)this.stack.pop()},e.prototype.storeNode=function(e,t,n,r,i){if(void 0===r&&(r=4),void 0===i&&(i=!1),0==e){var o=this,a=this.buffer.length;if(0==a&&o.parent&&(a=o.bufferBase-o.parent.bufferBase,o=o.parent),a>0&&0==o.buffer[a-4]&&o.buffer[a-1]>-1){if(t==n)return;if(o.buffer[a-2]>=t)return void(o.buffer[a-2]=n)}}if(i&&this.pos!=n){var s=this.buffer.length;if(s>0&&0!=this.buffer[s-4])for(;s>0&&this.buffer[s-2]>n;)this.buffer[s]=this.buffer[s-4],this.buffer[s+1]=this.buffer[s-3],this.buffer[s+2]=this.buffer[s-2],this.buffer[s+3]=this.buffer[s-1],s-=4,r>4&&(r-=4);this.buffer[s]=e,this.buffer[s+1]=t,this.buffer[s+2]=n,this.buffer[s+3]=r}else this.buffer.push(e,t,n,r)},e.prototype.shift=function(e,t,n){if(131072&e)this.pushState(65535&e,this.pos);else if(0==(262144&e)){var r=this.pos,i=e,o=this.cx.parser;(n>this.pos||t<=o.maxNode)&&(this.pos=n,o.stateFlag(i,1)||(this.reducePos=n)),this.pushState(i,r),t<=o.maxNode&&this.buffer.push(t,r,n,4)}else t<=this.cx.parser.maxNode&&this.buffer.push(t,this.pos,n,4),this.pos=n},e.prototype.apply=function(e,t,n){65536&e?this.reduce(e):this.shift(e,t,n)},e.prototype.useNode=function(e,t){var n=this.cx.reused.length-1;(n<0||this.cx.reused[n]!=e)&&(this.cx.reused.push(e),n++);var r=this.pos;this.reducePos=this.pos=r+e.length,this.pushState(t,r),this.buffer.push(n,r,this.reducePos,-1)},e.prototype.split=function(){for(var t=this,n=t.buffer.length;n>0&&t.buffer[n-2]>t.reducePos;)n-=4;for(var r=t.buffer.slice(n),i=t.bufferBase+n;t&&i==t.bufferBase;)t=t.parent;return new e(this.cx,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,r,i,t)},e.prototype.recoverByDelete=function(e,t){var n=e<=this.cx.parser.maxNode;n&&this.storeNode(e,this.pos,t),this.storeNode(0,this.pos,t,n?8:4),this.pos=this.reducePos=t,this.score-=200},e.prototype.canShift=function(e){for(var t=new wm(this);;){var n=this.cx.parser.stateSlot(t.top,4)||this.cx.parser.hasAction(t.top,e);if(0==(65536&n))return!0;if(0==n)return!1;t.reduce(n)}},Object.defineProperty(e.prototype,"ruleStart",{get:function(){for(var e=this.state,t=this.stack.length;;){var n=this.cx.parser.stateSlot(e,5);if(!(65536&n))return 0;if(t-=3*(n>>19),(65535&n)<this.cx.parser.minRepeatTerm)return this.stack[t+1];e=this.stack[t]}},enumerable:!0,configurable:!0}),e.prototype.startOf=function(e){for(var t=this.state,n=this.stack.length,r=this.cx.parser;;){var i=r.stateSlot(t,5),o=i>>19,a=65535&i;if(e.indexOf(a)>-1)return this.stack[n-3*(i>>19)+1];if(0==n)return-1;t=0==o?this.stack[n-=3]:r.getGoto(this.stack[(n-=3*(o-1))-3],a,!0)}},e.prototype.recoverByInsert=function(e){var t=this;if(this.stack.length>=300)return[];var n=this.cx.parser.nextStates(this.state);if(n.length>4||this.stack.length>=120){var r=n.filter((function(n){return n!=t.state&&t.cx.parser.hasAction(n,e)}));if(this.stack.length<120)for(var i=0;r.length<4&&i<n.length;i++)r.indexOf(n[i])<0&&r.push(n[i]);n=r}var o=[];for(i=0;i<n.length&&o.length<4;i++)if(n[i]!=this.state){var a=this.split();a.storeNode(0,a.pos,a.pos,4,!0),a.pushState(n[i],this.pos),a.score-=200,o.push(a)}return o},e.prototype.forceReduce=function(){var e=this.cx.parser.stateSlot(this.state,5);return 0!=(65536&e)&&(this.cx.parser.validAction(this.state,e)||(this.storeNode(0,this.reducePos,this.reducePos,4,!0),this.score-=100),this.reduce(e),!0)},e.prototype.forceAll=function(){for(;!this.cx.parser.stateFlag(this.state,2)&&this.forceReduce(););return this},Object.defineProperty(e.prototype,"deadEnd",{get:function(){if(3!=this.stack.length)return!1;var e=this.cx.parser;return 65535==e.data[e.stateSlot(this.state,1)]&&!e.stateSlot(this.state,4)},enumerable:!0,configurable:!0}),e.prototype.restart=function(){this.state=this.stack[0],this.stack.length=0},e.prototype.sameState=function(e){if(this.state!=e.state||this.stack.length!=e.stack.length)return!1;for(var t=0;t<this.stack.length;t+=3)if(this.stack[t]!=e.stack[t])return!1;return!0},e.prototype.toTree=function(){return rs.build({buffer:_m.create(this),group:this.cx.parser.group,topID:this.cx.topTerm,maxBufferLength:this.cx.maxBufferLength,reused:this.cx.reused,minRepeatType:this.cx.parser.minRepeatTerm})},Object.defineProperty(e.prototype,"parser",{get:function(){return this.cx.parser},enumerable:!0,configurable:!0}),e.prototype.dialectEnabled=function(e){return this.cx.dialect.flags[e]},e}();!function(e){e[e.Token=200]="Token",e[e.Reduce=100]="Reduce",e[e.MaxNext=4]="MaxNext",e[e.MaxInsertStackDepth=300]="MaxInsertStackDepth",e[e.DampenInsertStackDepth=120]="DampenInsertStackDepth"}(vm||(vm={}));var wm=function(){function e(e){this.stack=e,this.top=e.state,this.rest=e.stack,this.offset=this.rest.length}return e.prototype.reduce=function(e){var t=65535&e,n=e>>19;0==n?(this.rest==this.stack.stack&&(this.rest=this.rest.slice()),this.rest.push(this.top,0,0),this.offset+=3):this.offset-=3*(n-1);var r=this.stack.cx.parser.getGoto(this.rest[this.offset-3],t,!0);this.top=r},e}(),_m=function(){function e(e,t,n){this.stack=e,this.pos=t,this.index=n,this.buffer=e.buffer,0==this.index&&this.maybeNext()}return e.create=function(t){return new e(t,t.bufferBase+t.buffer.length,t.buffer.length)},e.prototype.maybeNext=function(){var e=this.stack.parent;null!=e&&(this.index=this.stack.bufferBase-e.bufferBase,this.stack=e,this.buffer=e.buffer)},Object.defineProperty(e.prototype,"id",{get:function(){return this.buffer[this.index-4]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"start",{get:function(){return this.buffer[this.index-3]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return this.buffer[this.index-2]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this.buffer[this.index-1]},enumerable:!0,configurable:!0}),e.prototype.next=function(){this.index-=4,this.pos-=4,0==this.index&&this.maybeNext()},e.prototype.fork=function(){return new e(this.stack,this.pos,this.index)},e}(),Cm=function(){function e(){this.start=-1,this.value=-1,this.end=-1}return e.prototype.accept=function(e,t){this.value=e,this.end=t},e}(),Om=function(){function e(e,t){void 0===t&&(t=e.length),this.string=e,this.length=t}return e.prototype.get=function(e){return e<0||e>=this.length?-1:this.string.charCodeAt(e)},e.prototype.read=function(e,t){return this.string.slice(e,Math.min(this.length,t))},e.prototype.clip=function(t){return new e(this.string,t)},e}(),xm=function(){function e(e,t){this.data=e,this.id=t}return e.prototype.token=function(e,t,n){!function(e,t,n,r,i){var o=0,a=1<<i,s=r.cx.dialect;e:for(var l=n.start;0!=(a&e[o]);){for(var u=e[o+1],c=o+3;c<u;c+=2)if((e[c+1]&a)>0){var h=e[c];if(s.allows(h)&&(-1==n.value||n.value==h||r.cx.parser.overrides(h,n.value))){n.accept(h,l);break}}for(var f=t.get(l++),d=0,v=e[o+2];d<v;){var p=d+v>>1,g=u+p+(p<<1);if(f<e[g])v=p;else{if(!(f>=e[g+1])){o=e[g+2];continue e}d=p+1}}break}}(this.data,e,t,n,this.id)},e}();function Sm(e,t){if(void 0===t&&(t=Uint16Array),"string"!=typeof e)return e;for(var n=null,r=0,i=0;r<e.length;){for(var o=0;;){var a=e.charCodeAt(r++),s=!1;if(126==a){o=65535;break}a>=92&&a--,a>=34&&a--;var l=a-32;if(l>=46&&(l-=46,s=!0),o+=l,s)break;o*=46}n?n[i++]=o:n=new t(o)}return n}xm.prototype.contextual=xm.prototype.fallback=xm.prototype.extend=!1;var Am="undefined"!=typeof process&&/\bparse\b/.test(process.env.LOG),Pm=null,Tm=function(){function e(e){this.start=[0],this.index=[0],this.nextStart=0,this.trees=[e]}return e.prototype.nodeAt=function(e){if(e<this.nextStart)return null;for(;;){var t=this.trees.length-1;if(t<0)return this.nextStart=1e9,null;var n=this.trees[t],r=this.index[t];if(r!=n.children.length){var i=n.children[r],o=this.start[t]+n.positions[r];if(o>=e)return o==e?i:null;i instanceof as?(this.index[t]++,this.nextStart=o+i.length):(this.index[t]++,o+i.length>=e&&(this.trees.push(i),this.start.push(o),this.index.push(0)))}else this.trees.pop(),this.start.pop(),this.index.pop()}},e}(),Im=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.extended=-1,t.mask=0,t}return function(e,t){function n(){this.constructor=e}km(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),t.prototype.clear=function(e){this.start=e,this.value=this.extended=-1},t}(Cm),Em=new Cm,Dm=function(){function e(e){this.tokens=[],this.mainToken=Em,this.actions=[],this.tokens=e.tokenizers.map((function(e){return new Im}))}return e.prototype.getActions=function(e,t){for(var n=0,r=null,i=e.cx.parser,o=i.tokenizers,a=i.stateSlot(e.state,3),s=0;s<o.length;s++)if(0!=(1<<s&a)){var l=o[s],u=this.tokens[s];if((!r||l.fallback)&&((l.contextual||u.start!=e.pos||u.mask!=a)&&(this.updateCachedToken(u,l,e,t),u.mask=a),0!=u.value)){var c=n;if(u.extended>-1&&(n=this.addActions(e,u.extended,u.end,n)),n=this.addActions(e,u.value,u.end,n),!l.extend&&(r=u,n>c))break}}for(;this.actions.length>n;)this.actions.pop();return r||((r=Em).start=e.pos,e.pos==t.length?r.accept(e.cx.parser.eofTerm,e.pos):r.accept(0,e.pos+1)),this.mainToken=r,this.actions},e.prototype.updateCachedToken=function(e,t,n,r){if(e.clear(n.pos),t.token(r,e,n),e.value>-1){for(var i=n.cx.parser,o=0;o<i.specialized.length;o++)if(i.specialized[o]==e.value){var a=i.specializers[o](r.read(e.start,e.end),n);if(a>=0&&n.cx.dialect.allows(a>>1)){0==(1&a)?e.value=a>>1:e.extended=a>>1;break}}}else n.pos==r.length?e.accept(n.cx.parser.eofTerm,n.pos):e.accept(0,n.pos+1)},e.prototype.putAction=function(e,t,n,r){for(var i=0;i<r;i+=3)if(this.actions[i]==e)return r;return this.actions[r++]=e,this.actions[r++]=t,this.actions[r++]=n,r},e.prototype.addActions=function(e,t,n,r){for(var i=e.state,o=e.cx.parser,a=o.data,s=0;s<2;s++)for(var l=o.stateSlot(i,s?2:1);;l+=3){if(65535==a[l]){if(1!=a[l+1]){0==r&&2==a[l+1]&&(r=this.putAction(Nm(a,l+1),t,n,r));break}l=Nm(a,l+2)}a[l]==t&&(r=this.putAction(Nm(a,l+1),t,n,r))}return r},e}(),Mm=function(e,t,n,r,i,o,a){void 0===o&&(o=null),void 0===a&&(a=-1),this.parser=e,this.maxBufferLength=t,this.input=n,this.topTerm=r,this.dialect=i,this.parent=o,this.wrapType=a,this.reused=[],this.tokens=new Dm(e)},Qm=function(){function e(e,t,n){void 0===n&&(n={}),this.pos=0,this.recovering=0,this.tokenCount=0,this.nextStackID=9812;var r=n.cache,i=void 0===r?void 0:r,o=n.strict,a=void 0!==o&&o,s=n.bufferLength,l=void 0===s?1024:s,u=n.top,c=void 0===u?void 0:u,h=n.dialect,f=c?e.topRules[c]:e.defaultTop;if(!f)throw new RangeError("Invalid top rule name "+c);this.stacks=[bm.start(new Mm(e,l,t,f[1],e.parseDialect(h)),f[0])],this.strict=a,this.cache=i?new Tm(i):null}return e.prototype.putStack=function(e){this.stacks.push(e),(this.pos<0||e.pos<this.pos)&&(this.pos=e.pos)},e.prototype.putStackDedup=function(e){for(var t=0;t<this.stacks.length;t++){var n=this.stacks[t];if(n.pos==e.pos&&n.sameState(e))return void(this.stacks[t].score<e.score&&(this.stacks[t]=e))}this.putStack(e)},e.prototype.advance=function(){var e=this.stacks,t=this.pos;this.stacks=[],this.pos=-1;for(var n=null,r=null,i=0;i<e.length;i++)for(var o=e[i];;){if(o.pos>t)this.putStack(o);else{var a=this.advanceStack(o,e);if(a){o=a;continue}n||(n=[],r=[]),n.push(o);var s=o.cx.tokens.mainToken;r.push(s.value,s.end)}break}if(!this.stacks.length){var l;if(l=n&&function(e){for(var t=null,n=0,r=e;n<r.length;n++){var i=r[n];i.pos==i.cx.input.length&&i.cx.parser.stateFlag(i.state,2)&&(!t||t.score<i.score)&&(t=i)}return t}(n))return l.toTree();if(this.strict)throw Am&&n&&console.log("Stuck with token "+n[0].cx.parser.getName(n[0].cx.tokens.mainToken.value)),new SyntaxError("No parse at "+t);this.recovering||(this.recovering=5)}if(this.recovering&&n&&(l=this.runRecovery(n,r)))return l.forceAll().toTree();if(this.recovering){var u=1==this.recovering?1:3*this.recovering;this.stacks.length>u&&(this.stacks.sort((function(e,t){return t.score-e.score})),this.stacks.length=u),this.stacks.some((function(e){return e.reducePos>t}))&&this.recovering--}else if(this.stacks.length>1)e:for(i=0;i<this.stacks.length-1;i++){o=this.stacks[i];for(var c=i+1;c<this.stacks.length;c++){var h=this.stacks[c];if(o.sameState(h)||o.buffer.length>200&&h.buffer.length>200){if(!((o.score-h.score||o.buffer.length-h.buffer.length)>0)){this.stacks.splice(i--,1);continue e}this.stacks.splice(c--,1)}}}return this.tokenCount++,null},e.prototype.advanceStack=function(e,t){var n=e.pos,r=e.cx,i=r.input,o=r.parser,a=Am?this.stackID(e)+" -> ":"";if(this.cache)for(var s=this.cache.nodeAt(n);s;){var l=o.group.types[s.type.id]==s.type?o.getGoto(e.state,s.type.id):-1;if(l>-1)return e.useNode(s,l),Am&&console.log(a+this.stackID(e)+" (via reuse of "+o.getName(s.type.id)+")"),e;if(!(s instanceof rs)||0==s.children.length||s.positions[0]>0)break;var u=s.children[0];if(!(u instanceof rs))break;s=u}var c=o.startNested(e.state);e:if(c>-1){var h=o.nested[c],f=h.grammar,d=h.end,v=h.placeholder,p=void 0,g=null,m=void 0,y=void 0,k=void 0,b=void 0;if("function"==typeof f){var w=f(i,e);if(w.stay)break e;g=w.parseNode,m=w.parser,y=w.top,k=w.dialect,p=w.filterEnd,b=w.wrapType}else m=f;var _=this.scanForNestEnd(e,d,p),C=e.cx.input.clip(_);if(g||!m){var O=g?g(C,e.pos):rs.empty;return O.length!=_-e.pos&&(O=new rs(O.type,O.children,O.positions,_-e.pos)),null!=b&&(O=new rs(o.group.types[b],[O],[0],O.length)),e.useNode(O,o.getGoto(e.state,v,!0)),e}var x=y?m.topRules[y]:m.defaultTop,S=bm.start(new Mm(m,e.cx.maxBufferLength,C,x[1],m.parseDialect(k),e,b),x[0],e.pos);return Am&&console.log(a+this.stackID(S)+" (nested)"),S}var A=o.stateSlot(e.state,4);if(A>0)return e.reduce(A),Am&&console.log(a+this.stackID(e)+" (via always-reduce "+o.getName(65535&A)+")"),e;for(var P=e.cx.tokens.getActions(e,i),T=0;T<P.length;){var I=P[T++],E=P[T++],D=(_=P[T++],T==P.length||!t),M=D?e:e.split();if(M.apply(I,E,_),Am&&console.log(a+this.stackID(M)+" (via "+(0==(65536&I)?"shift":"reduce of "+o.getName(65535&I))+" for "+o.getName(E)+" @ "+n+(M==e?"":", split")+")"),D)return M;M.pos>n?this.putStack(M):t.push(M)}return e.cx.parent&&e.pos==i.length?this.finishNested(e):null},e.prototype.advanceFully=function(e){for(var t=e.pos;;){var n=this.advanceStack(e,null);if(!n)return e;if(n.pos>t)return this.putStackDedup(n),null;e=n}},e.prototype.runRecovery=function(e,t){for(var n=null,r=!1,i=0;i<e.length;i++){var o=e[i],a=t[i<<1],s=t[1+(i<<1)],l=Am?this.stackID(o)+" -> ":"";if(o.deadEnd){if(r)continue;if(r=!0,o.restart(),Am&&console.log(l+this.stackID(o)+" (restarted)"),!(f=this.advanceFully(o)))continue;o=f}for(var u=o.split(),c=l,h=0;u.forceReduce()&&h<10;h++){var f;if(Am&&console.log(c+this.stackID(u)+" (via force-reduce)"),!(f=this.advanceFully(u)))break;u=f,Am&&(c=this.stackID(f)+" -> ")}for(var d=0,v=o.recoverByInsert(a);d<v.length;d++){var p=v[d];Am&&console.log(l+this.stackID(p)+" (via recover-insert)"),this.advanceFully(p)}o.cx.input.length>o.pos?(s==o.pos&&(s++,a=0),o.recoverByDelete(a,s),Am&&console.log(l+this.stackID(o)+" (via recover-delete "+o.cx.parser.getName(a)+")"),this.putStackDedup(o)):o.cx.parent||n&&!(n.score<o.score)||(n=o)}return n},e.prototype.forceFinish=function(){return this.stacks[0].split().forceAll().toTree()},Object.defineProperty(e.prototype,"badness",{get:function(){return this.stacks.length?-this.stacks[0].score/(200*this.tokenCount):0},enumerable:!0,configurable:!0}),e.prototype.scanForNestEnd=function(e,t,n){for(var r=e.cx.input,i=e.pos;i<r.length;i++)if(Em.start=i,Em.value=-1,t.token(r,Em,e),Em.value>-1&&(!n||n(r.read(i,Em.end))))return i;return r.length},e.prototype.finishNested=function(e){if(-2==e.cx.wrapType)return null;var t=e.cx.parent,n=e.forceAll().toTree(),r=t.cx.parser,i=r.nested[r.startNested(t.state)];return n=new rs(n.type,n.children,n.positions.map((function(e){return e-t.pos})),e.pos-t.pos),e.cx.wrapType>-1&&(n=new rs(r.group.types[e.cx.wrapType],[n],[0],n.length)),e.cx.wrapType=-2,t.useNode(n,r.getGoto(t.state,i.placeholder,!0)),Am&&console.log(this.stackID(t)+" (via unnest "+(e.cx.wrapType>-1?r.getName(e.cx.wrapType):n.type.name)+")"),t},e.prototype.stackID=function(e){var t=(Pm||(Pm=new WeakMap)).get(e);return t||Pm.set(e,t=String.fromCodePoint(this.nextStackID++)),t+e},e}(),Rm=function(){function e(e,t,n){this.source=e,this.flags=t,this.disabled=n}return e.prototype.allows=function(e){return!this.disabled||0==this.disabled[e]},e}(),Hm=function(){function e(e){this.nextStateCache=[],this.cachedDialect=null;var t=Sm(e.tokenData),n=e.nodeNames.split(" ");this.minRepeatTerm=n.length;for(var r=0;r<e.repeatNodeCount;r++)n.push("");var i=[];for(r=0;r<n.length;r++)i.push(Lm);function o(e,t,n){i[e]==Lm&&(i[e]=Object.create(null)),t.set(i[e],t.deserialize(String(n)))}if(o(0,Ka.error,""),e.nodeProps)for(var a=0,s=e.nodeProps;a<s.length;a++){var l=s[a],u=l[0];for(r=1;r<l.length;r+=2)o(l[r],u,l[r+1])}if(this.specialized=new Uint16Array(e.specialized?e.specialized.length:0),this.specializers=[],e.specialized)for(r=0;r<e.specialized.length;r++)this.specialized[r]=e.specialized[r].term,this.specializers[r]=e.specialized[r].get;this.states=Sm(e.states,Uint32Array),this.data=Sm(e.stateData),this.goto=Sm(e.goto),this.group=new ts(n.map((function(e,t){return new es(e,i[t],t)}))),this.maxTerm=e.maxTerm,this.tokenizers=e.tokenizers.map((function(e){return"number"==typeof e?new xm(t,e):e})),this.topRules=e.topRules,this.nested=(e.nested||[]).map((function(e){var t=e[3];return{name:e[0],grammar:e[1],end:new xm(Sm(e[2]),0),placeholder:t}})),this.dialects=e.dialects||{},this.dynamicPrecedences=e.dynamicPrecedences||null,this.tokenPrecTable=e.tokenPrec,this.termNames=e.termNames||null,this.maxNode=this.group.types.length-1,r=0;for(var c=this.states.length/6;r<c;r++)this.nextStateCache[r]=null}return e.prototype.parse=function(e,t){"string"==typeof e&&(e=new Om(e));for(var n=new Qm(this,e,t);;){var r=n.advance();if(r)return r}},e.prototype.startParse=function(e,t){return"string"==typeof e&&(e=new Om(e)),new Qm(this,e,t)},e.prototype.getGoto=function(e,t,n){void 0===n&&(n=!1);var r=this.goto;if(t>=r[0])return-1;for(var i=r[t+1];;){var o=r[i++],a=1&o,s=r[i++];if(a&&n)return s;for(var l=i+(o>>1);i<l;i++)if(r[i]==e)return s;if(a)return-1}},e.prototype.hasAction=function(e,t){for(var n=this.data,r=0;r<2;r++)for(var i=this.stateSlot(e,r?2:1),o=void 0;;i+=3){if(65535==(o=n[i])){if(1!=n[i+1]){if(2==n[i+1])return Nm(n,i+2);break}o=n[i=Nm(n,i+2)]}if(o==t||0==o)return Nm(n,i+1)}return 0},e.prototype.stateSlot=function(e,t){return this.states[6*e+t]},e.prototype.stateFlag=function(e,t){return(this.stateSlot(e,0)&t)>0},e.prototype.startNested=function(e){var t=this.stateSlot(e,0);return 4&t?t>>10:-1},e.prototype.validAction=function(e,t){if(t==this.stateSlot(e,4))return!0;for(var n=this.stateSlot(e,1);;n+=3){if(65535==this.data[n]){if(1!=this.data[n+1])return!1;n=Nm(this.data,n+2)}if(t==Nm(this.data,n+1))return!0}},e.prototype.nextStates=function(e){var t=this.nextStateCache[e];if(t)return t;for(var n=[],r=this.stateSlot(e,1);;r+=3){if(65535==this.data[r]){if(1!=this.data[r+1])break;r=Nm(this.data,r+2)}0==(1&this.data[r+2])&&n.indexOf(this.data[r+1])<0&&n.push(this.data[r+1])}for(var i=this.goto,o=i[0],a=0;a<o;a++)for(var s=i[a+1];;){for(var l=i[s++],u=i[s++],c=s+(l>>1);s<c;s++)i[s]==e&&n.indexOf(u)<0&&n.push(u);if(1&l)break}return this.nextStateCache[e]=n},e.prototype.overrides=function(e,t){var n=Fm(this.data,this.tokenPrecTable,t);return n<0||Fm(this.data,this.tokenPrecTable,e)<n},e.prototype.withNested=function(e){return this.copy({nested:this.nested.map((function(t){return Object.prototype.hasOwnProperty.call(e,t.name)?{name:t.name,grammar:e[t.name],end:t.end,placeholder:t.placeholder}:t}))})},e.prototype.withProps=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return this.copy({group:(e=this.group).extend.apply(e,t)})},e.prototype.withTokenizer=function(e,t){return this.copy({tokenizers:this.tokenizers.map((function(n){return n==e?t:n}))})},e.prototype.copy=function(t){for(var n=Object.create(e.prototype),r=0,i=Object.keys(this);r<i.length;r++){var o=i[r];n[o]=o in t?t[o]:this[o]}return n},e.prototype.getName=function(e){return this.termNames?this.termNames[e]:String(e<=this.maxNode&&this.group.types[e].name||e)},Object.defineProperty(e.prototype,"eofTerm",{get:function(){return this.maxNode+1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasNested",{get:function(){return this.nested.length>0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"defaultTop",{get:function(){return this.topRules[Object.keys(this.topRules)[0]]},enumerable:!0,configurable:!0}),e.prototype.dynamicPrecedence=function(e){var t=this.dynamicPrecedences;return null==t?0:t[e]||0},Object.defineProperty(e.prototype,"topType",{get:function(){return this.group.types[this.defaultTop[1]]},enumerable:!0,configurable:!0}),e.prototype.parseDialect=function(e){if(this.cachedDialect&&this.cachedDialect.source==e)return this.cachedDialect;var t=Object.keys(this.dialects),n=t.map((function(){return!1}));if(e)for(var r=0,i=e.split(" ");r<i.length;r++)(l=t.indexOf(i[r]))>=0&&(n[l]=!0);for(var o=null,a=0;a<t.length;a++)if(!n[a])for(var s=this.dialects[t[a]],l=void 0;65535!=(l=this.data[s++]);)(o||(o=new Uint8Array(this.maxTerm+1)))[l]=1;return this.cachedDialect=new Rm(e,n,o)},e.deserialize=function(t){return new e(t)},e}();function Nm(e,t){return e[t]|e[t+1]<<16}Hm.TokenGroup=xm;var Lm=Object.create(null);function Fm(e,t,n){for(var r=t,i=void 0;65535!=(i=e[r]);r++)if(i==n)return r-t;return-1}var $m={bool:1,ignoring:2,on:3,group_left:4,group_right:5,offset:6},Bm={avg:7,bottomk:8,count:9,count_values:10,group:11,max:12,min:13,quantile:14,stddev:15,stdvar:16,sum:17,topk:18,by:19,without:20,and:21,or:22,unless:23},Vm={__proto__:null,absent_over_time:257,absent:259,abs:261,avg_over_time:263,ceil:265,changes:267,clamp_max:269,clamp_min:271,count_over_time:273,days_in_month:275,day_of_month:277,day_of_week:279,delta:281,deriv:283,exp:285,floor:287,histogram_quantile:289,holt_winters:291,hour:293,idelta:295,increase:297,irate:299,label_replace:301,label_join:303,ln:305,log10:307,log2:309,max_over_time:311,min_over_time:313,minute:315,month:317,predict_linear:319,quantile_over_time:321,rate:323,resets:325,round:327,scalar:329,sort:331,sort_desc:333,sqrt:335,stddev_over_time:337,stdvar_over_time:339,sum_over_time:341,timestamp:343,time:345,vector:347,year:349},zm=Hm.deserialize({states:"2SO%jQPOOOOQO'#Cx'#CxO%nQPO'#CwQ'QQQOOOOQO'#De'#DeO%tQPO'#DdO%jQPO'#ElOOQO'#Ep'#EpO%jQPO'#EoOOQO'#Er'#ErO'UQSO'#EsO'^QQO'#EqOOQO'#Eq'#EqOOQO'#Cv'#CvOOQO'#Df'#DfOOQO'#Dh'#DhOOQO'#Di'#DiOOQO'#Dj'#DjOOQO'#Dk'#DkOOQO'#Dl'#DlOOQO'#Dm'#DmOOQO'#Dn'#DnOOQO'#Do'#DoOOQO'#Dp'#DpOOQO'#Dq'#DqOOQO'#Dr'#DrOOQO'#Ds'#DsOOQO'#Dt'#DtOOQO'#Du'#DuOOQO'#Dv'#DvOOQO'#Dw'#DwOOQO'#Dx'#DxOOQO'#Dy'#DyOOQO'#Dz'#DzOOQO'#D{'#D{OOQO'#D|'#D|OOQO'#D}'#D}OOQO'#EO'#EOOOQO'#EP'#EPOOQO'#EQ'#EQOOQO'#ER'#EROOQO'#ES'#ESOOQO'#ET'#ETOOQO'#EU'#EUOOQO'#EV'#EVOOQO'#EW'#EWOOQO'#EX'#EXOOQO'#EY'#EYOOQO'#EZ'#EZOOQO'#E['#E[OOQO'#E]'#E]OOQO'#E^'#E^OOQO'#E_'#E_OOQO'#E`'#E`OOQO'#Ea'#EaOOQO'#Eb'#EbOOQO'#Ec'#EcOOQO'#Ed'#EdOOQO'#Ee'#EeOOQO'#Ef'#EfOOQO'#Eg'#EgO(qQPO'#CyO(vQPO'#DOO%tQPO,59cO(}QQO,59cO/OQPO,59lO/OQPO,59lO/OQPO,59lO/OQPO,59lO/OQPO,59lO/SQQO,5;SO/XQQO,5;VOOQO,5:O,5:OO/^QQO,5;WO/eQQO,5;ZO0uQPO'#EuO1TQPO,5;_OOQO'#Et'#EtOOQO,5;_,5;_OOQO,5;],5;]O1]QSO'#CzOOQO,59e,59eO1eQPO,59jO1mQQO'#DPOOQO,59j,59jOOQO1G.}1G.}OOQO'#DU'#DUO6XQPO'#DTO6cQPO'#DTOOQO'#DS'#DSO%jQPO1G/WO%jQPO1G/WO%jQPO1G/WO%jQPO1G/WO%jQPO1G/WO6mQSO1G0nOOQO1G0q1G0qOOQO1G0r1G0rOOQO'#Ev'#EvO6uQPO,5;aO6zQSO1G0yOOQO1G0y1G0yOOQO'#C|'#C|O7SQPO,59fOOQO'#C{'#C{OOQO,59f,59fO%jQPO,59kOOQO1G/U1G/UO(qQPO,59qO7[QPO,59oO<sQQO7+$rO=QQQO7+$rO>]QQO7+$rO>sQQO7+$rO@XQQO7+$rOOQO7+&Y7+&YO@oQQO7+&`OOQO1G0{1G0{OOQO1G0z1G0zOOQO7+&e7+&eO@wQSO1G/QOOQO1G/Q1G/QOAPQQO1G/VOOQO1G/]1G/]OOQO'#DW'#DWOOQO1G/Z1G/ZOOQO<<Iz<<IzOAZQPO<<IzOOQO1G/R1G/ROOQO7+$l7+$lOOQOAN?fAN?f",stateData:"A`~O#pOShOS~OVPOWPOXPOYPOZPO[PO]PO^PO_PO`POaPObPO!ZXO#^]O#a]O#qUO#t^O#u_O#v`O#waO#xbO#ycO#zdO#{eO#|fO#}gO$OhO$PiO$QjO$RkO$SlO$TmO$UnO$VoO$WpO$XqO$YrO$ZsO$[tO$]uO$^vO$_wO$`xO$ayO$bzO$c{O$d|O$e}O$f!OO$g!PO$h!QO$i!RO$j!SO$k!TO$l!UO$m!VO$n!WO$o!XO$p!YO$q!ZO$r![O$s!]O$t!^O$xVO$yVO$zYO~O~PYOc!_Od!_O#q!`O~OU!iOe!fOf!gOg!fOu!cO{!cO|!cO}!cO!O!dO!P!dO!Q!eO!R!eO!S!eO!T!eO!U!eO!V!eO$u!hO~O~P%yOq!mO${!pO~O$zYOU#eXe#eXf#eXg#eXu#eX{#eX|#eX}#eX!O#eX!P#eX!Q#eX!R#eX!S#eX!T#eX!U#eX!V#eX#n#eX$u#eX#s#eX#r#eX~O#q!rO~O#s!vO~PYOc!_Od!_OUkaekafkagkauka{ka|ka}ka!Oka!Pka!Qka!Rka!Ska!Tka!Uka!Vka#nka$uka#ska#rka~OP!xOQxPRxPVxPWxPXxPYxPZxP[xP]xP^xP_xP`xPaxPbxP!ZxP#^xP#axP#qxP#txP#uxP#vxP#wxP#xxP#yxP#zxP#{xP#|xP#}xP$OxP$PxP$QxP$RxP$SxP$TxP$UxP$VxP$WxP$XxP$YxP$ZxP$[xP$]xP$^xP$_xP$`xP$axP$bxP$cxP$dxP$exP$fxP$gxP$hxP$ixP$jxP$kxP$lxP$mxP$nxP$oxP$pxP$qxP$rxP$sxP$txP$xxP$yxP$zxP~O~P*eO#]#RO~O#]#SO~O#s#TO~P%yOu!cOU#cae#caf#cag#ca{#ca|#ca}#ca!O#ca!P#ca!Q#ca!R#ca!S#ca!T#ca!U#ca!V#ca#n#ca$u#ca#s#ca#r#ca~O!V#UO#k#UO#l#UO#m#UO~O#r#WO${#XO~Oq#YO#s#]O~O#r#^O#s#_O~O#rsX#ssX~P%yOVwXWwXXwXYwXZwX[wX]wX^wX_wX`wXawXbwX!ZwX#^wX#awX#qwX#twX#uwX#vwX#wwX#xwX#ywX#zwX#{wX#|wX#}wX$OwX$PwX$QwX$RwX$SwX$TwX$UwX$VwX$WwX$XwX$YwX$ZwX$[wX$]wX$^wX$_wX$`wX$awX$bwX$cwX$dwX$ewX$fwX$gwX$hwX$iwX$jwX$kwX$lwX$mwX$nwX$owX$pwX$qwX$rwX$swX$twX$xwX$ywX$zwX~OQ#`OR#`O~P1wOS#aOT#aO~P1wO$v#gO$w#hO~O#a#iO~Oq!mO${#kO~O#r#lO#s#mO~O#q!rOVzPWzPXzPYzPZzP[zP]zP^zP_zP`zPazPbzP!ZzP#^zP#azP#tzP#uzP#vzP#wzP#xzP#yzP#zzP#{zP#|zP#}zP$OzP$PzP$QzP$RzP$SzP$TzP$UzP$VzP$WzP$XzP$YzP$ZzP$[zP$]zP$^zP$_zP$`zP$azP$bzP$czP$dzP$ezP$fzP$gzP$hzP$izP$jzP$kzP$lzP$mzP$nzP$ozP$pzP$qzP$rzP$szP$tzP$xzP$yzP$zzP~Ou!cOUtqetqftqgtq!Otq!Ptq!Qtq!Rtq!Stq!Ttq!Utq!Vtq#ntq$utq#stq#rtq~O{tq|tq}tq~P;lO{!cO|!cO}!cO~P;lOu!cO{!cO|!cO}!cO!O!dO!P!dOUtqetqftqgtq#ntq$utq#stq#rtq~O!Qtq!Rtq!Stq!Ttq!Utq!Vtq~P=_O!Q!eO!R!eO!S!eO!T!eO!U!eO!V!eO~P=_Oe!fOg!fOu!cO{!cO|!cO}!cO!O!dO!P!dO!Q!eO!R!eO!S!eO!T!eO!U!eO!V!eO~OUtqftq#ntq$utq#stq#rtq~P?ZO#]#sO$v#rO~Oq#YO#s#uO~O#rsi#ssi~P%yO$v#vO~O",goto:"(Q#kPPPPPPPPPPPPPPPPPPPPPPPPPP#l$[$h$t$z%T%WP%^%g$[P%j%y&Q&X&`PPPPPPPPPPP$[&c&oP&o&o&o&o&o&o&o&o&o&o&o&o&o&o&o&o&o&o&o&o&o&o&o&o&o&o&o&o&o&o&o&o&o&o&o&o&o&o&o&o&o&o&o&o&o&o$[PP$[$[P$[$[&{$['X'e't'w'}QROQ!kUQ!lWQ!u!`Q#b!|Q#c!}Q#d#OQ#e#PQ#f#QR#n#^e]OUW!`!|!}#O#P#Q#^eQOUW!`!|!}#O#P#Q#^Q!aQR!w!bQ!s!_Q#o#`R#p#aR#Z!rQ#[!rR#t#lQ!bQQ!jTR!w!aR!t!`Q!|!cQ!}!dQ#O!eQ#P!fR#Q!gZ!{!c!d!e!f!gZ!y!c!d!e!f!gZ!z!c!d!e!f!gR#q#aeTOUW!`!|!}#O#P#Q#^eSOUW!`!|!}#O#P#Q#^eWOUW!`!|!}#O#P#Q#^eZOUW!`!|!}#O#P#Q#^d[OUW!`!|!}#O#P#Q#^R!qZR!nYQ!oYR#j#WR#V!m",nodeNames:"\u26a0 Bool Ignoring On GroupLeft GroupRight Offset Avg Bottomk Count CountValues Group Max Min Quantile Stddev Stdvar Sum Topk By Without And Or Unless LineComment  Expr AggregateExpr AggregateOp AggregateModifier GroupingLabels GroupingLabelList GroupingLabel LabelName FunctionCallBody FunctionCallArgs BinaryExpr Pow BinModifier GroupModifiers BoolModifier OnOrIgnoring MaybeGroupingLabels Mul Div Mod Add Sub Eql Gte Gtr Lte Lss Neq FunctionCall FunctionIdentifier AbsentOverTime Identifier Absent Abs AvgOverTime Ceil Changes ClampMax ClampMin CountOverTime DaysInMonth DayOfMonth DayOfWeek Delta Deriv Exp Floor HistogramQuantile HoltWinters Hour Idelta Increase Irate LabelReplace LabelJoin Ln Log10 Log2 MaxOverTime MinOverTime Minute Month PredictLinear QuantileOverTime Rate Resets Round Scalar Sort SortDesc Sqrt StddevOverTime StdvarOverTime SumOverTime Timestamp Time Vector Year MatrixSelector Duration NumberLiteral OffsetExpr ParenExpr StringLiteral SubqueryExpr UnaryExpr UnaryOp VectorSelector MetricIdentifier LabelMatchers LabelMatchList LabelMatcher MatchOp EqlSingle EqlRegex NeqRegex",maxTerm:181,nodeProps:[[Ka.skipped,24,!0],[Ka.top,25,!0]],repeatNodeCount:0,tokenData:"! b~RvX^#ipq#iqr$^rs$qst%euv%pwx%uxy&dyz&iz{&n{|&s|}&z}!O'P!O!P'W!P!Q(W!Q!R(]!R![)c![!]LW!^!_MS!_!`Ma!`!aMv!c!}NT!}#ONk#P#QNp#Q#RNu#R#SNT#S#TNz#T#oNT#o#p! W#q#r! ]#y#z#i$f$g#i#BY#BZ#i$IS$I_#i$I|$JO#i$JT$JU#i$KV$KW#i&FU&FV#i~#nY#p~X^#ipq#i#y#z#i$f$g#i#BY#BZ#i$IS$I_#i$I|$JO#i$JT$JU#i$KV$KW#i&FU&FV#i~$aQ!_!`$g#r#s$l~$lO!V~~$qO#m~~$vU#a~OY$qZr$qrs%Ys#O$q#O#P%_#P~$q~%_O#a~~%bPO~$q~%jQh~OY%eZ~%e~%uO}~~%zU#a~OY%uZw%uwx%Yx#O%u#O#P&^#P~%u~&aPO~%u~&iO#q~~&nO#s~~&sO{~R&zO$yP!OQ~'PO#r~R'WO$xP!PQP'ZP!Q!['^P'cR#^P!Q!['^!g!h'l#X#Y'lP'oR{|'x}!O'x!Q![(OP'{P!Q![(OP(TP#^P!Q![(O~(]O|~R(bZ#^P!O!P)T!Q![)c!g!h'l#W#X*W#X#Y'l#[#].f#a#b0i#g#h1o#k#l2W#l#mKl#m#n:mP)YR#^P!Q![)T!g!h'l#X#Y'lR)hY#^P!O!P)T!Q![)c!g!h'l#W#X*W#X#Y'l#[#].f#a#b0i#g#h1o#k#l2W#m#n:mQ*]P#]Q!Q![*`Q*cS!Q![*`#[#]*o#a#b,w#g#h-}Q*tP#]Q!Q![*wQ*zR!Q![*w#a#b+T#g#h,`Q+YQ#]Q!Q![+`#g#h+rQ+cR!Q![+`#a#b+l#g#h+wQ+oP#g#h+rQ+wO#]QQ+|P#]Q!Q![,PQ,SQ!Q![,P#a#b,YQ,]P#g#h+rQ,eP#]Q!Q![,hQ,kQ!Q![,h#a#b,qQ,tP#g#h+rQ,|Q#]Q!Q![-S#g#h+rQ-VR!Q![-S#a#b-`#g#h-fQ-cP#g#h+rQ-kP#]Q!Q![-nQ-qQ!Q![-n#a#b-wQ-zP#g#h+rQ.SP#]Q!Q![.VQ.YQ!Q![.V#a#b.`Q.cP#g#h+rQ.kP#]Q!Q![.nQ.qR!Q![.n#a#b.z#g#h0QQ/PQ#]Q!Q![/V#g#h+rQ/YR!Q![/V#a#b/c#g#h/iQ/fP#g#h+rQ/nP#]Q!Q![/qQ/tQ!Q![/q#a#b/zQ/}P#g#h+rQ0VP#]Q!Q![0YQ0]Q!Q![0Y#a#b0cQ0fP#g#h+rQ0nQ#]Q!Q![0t#g#h+rQ0wR!Q![0t#a#b1Q#g#h1WQ1TP#g#h+rQ1]P#]Q!Q![1`Q1cQ!Q![1`#a#b1iQ1lP#g#h+rQ1tP#]Q!Q![1wQ1zQ!Q![1w#a#b2QQ2TP#g#h+rQ2]P#]Q!Q![2`Q2cT!Q![2`#W#X2r#[#]6{#a#b9O#g#h:UQ2wP#]Q!Q![2zQ2}S!Q![2z#[#]3Z#a#b5^#g#h6dQ3`P#]Q!Q![3cQ3fR!Q![3c#a#b3o#g#h4uQ3tQ#]Q!Q![3z#g#h+rQ3}R!Q![3z#a#b4W#g#h4^Q4ZP#g#h+rQ4cP#]Q!Q![4fQ4iQ!Q![4f#a#b4oQ4rP#g#h+rQ4zP#]Q!Q![4}Q5QQ!Q![4}#a#b5WQ5ZP#g#h+rQ5cQ#]Q!Q![5i#g#h+rQ5lR!Q![5i#a#b5u#g#h5{Q5xP#g#h+rQ6QP#]Q!Q![6TQ6WQ!Q![6T#a#b6^Q6aP#g#h+rQ6iP#]Q!Q![6lQ6oQ!Q![6l#a#b6uQ6xP#g#h+rQ7QP#]Q!Q![7TQ7WR!Q![7T#a#b7a#g#h8gQ7fQ#]Q!Q![7l#g#h+rQ7oR!Q![7l#a#b7x#g#h8OQ7{P#g#h+rQ8TP#]Q!Q![8WQ8ZQ!Q![8W#a#b8aQ8dP#g#h+rQ8lP#]Q!Q![8oQ8rQ!Q![8o#a#b8xQ8{P#g#h+rQ9TQ#]Q!Q![9Z#g#h+rQ9^R!Q![9Z#a#b9g#g#h9mQ9jP#g#h+rQ9rP#]Q!Q![9uQ9xQ!Q![9u#a#b:OQ:RP#g#h+rQ:ZP#]Q!Q![:^Q:aQ!Q![:^#a#b:gQ:jP#g#h+rQ:rP#]Q!Q![:uQ:xU!Q![:u#W#X;[#[#]?e#a#bAh#g#hBn#k#lCVQ;aP#]Q!Q![;dQ;gS!Q![;d#[#];s#a#b=v#g#h>|Q;xP#]Q!Q![;{Q<OR!Q![;{#a#b<X#g#h=_Q<^Q#]Q!Q![<d#g#h+rQ<gR!Q![<d#a#b<p#g#h<vQ<sP#g#h+rQ<{P#]Q!Q![=OQ=RQ!Q![=O#a#b=XQ=[P#g#h+rQ=dP#]Q!Q![=gQ=jQ!Q![=g#a#b=pQ=sP#g#h+rQ={Q#]Q!Q![>R#g#h+rQ>UR!Q![>R#a#b>_#g#h>eQ>bP#g#h+rQ>jP#]Q!Q![>mQ>pQ!Q![>m#a#b>vQ>yP#g#h+rQ?RP#]Q!Q![?UQ?XQ!Q![?U#a#b?_Q?bP#g#h+rQ?jP#]Q!Q![?mQ?pR!Q![?m#a#b?y#g#hAPQ@OQ#]Q!Q![@U#g#h+rQ@XR!Q![@U#a#b@b#g#h@hQ@eP#g#h+rQ@mP#]Q!Q![@pQ@sQ!Q![@p#a#b@yQ@|P#g#h+rQAUP#]Q!Q![AXQA[Q!Q![AX#a#bAbQAeP#g#h+rQAmQ#]Q!Q![As#g#h+rQAvR!Q![As#a#bBP#g#hBVQBSP#g#h+rQB[P#]Q!Q![B_QBbQ!Q![B_#a#bBhQBkP#g#h+rQBsP#]Q!Q![BvQByQ!Q![Bv#a#bCPQCSP#g#h+rQC[P#]Q!Q![C_QCbT!Q![C_#W#XCq#[#]Gz#a#bI}#g#hKTQCvP#]Q!Q![CyQC|S!Q![Cy#[#]DY#a#bF]#g#hGcQD_P#]Q!Q![DbQDeR!Q![Db#a#bDn#g#hEtQDsQ#]Q!Q![Dy#g#h+rQD|R!Q![Dy#a#bEV#g#hE]QEYP#g#h+rQEbP#]Q!Q![EeQEhQ!Q![Ee#a#bEnQEqP#g#h+rQEyP#]Q!Q![E|QFPQ!Q![E|#a#bFVQFYP#g#h+rQFbQ#]Q!Q![Fh#g#h+rQFkR!Q![Fh#a#bFt#g#hFzQFwP#g#h+rQGPP#]Q!Q![GSQGVQ!Q![GS#a#bG]QG`P#g#h+rQGhP#]Q!Q![GkQGnQ!Q![Gk#a#bGtQGwP#g#h+rQHPP#]Q!Q![HSQHVR!Q![HS#a#bH`#g#hIfQHeQ#]Q!Q![Hk#g#h+rQHnR!Q![Hk#a#bHw#g#hH}QHzP#g#h+rQISP#]Q!Q![IVQIYQ!Q![IV#a#bI`QIcP#g#h+rQIkP#]Q!Q![InQIqQ!Q![In#a#bIwQIzP#g#h+rQJSQ#]Q!Q![JY#g#h+rQJ]R!Q![JY#a#bJf#g#hJlQJiP#g#h+rQJqP#]Q!Q![JtQJwQ!Q![Jt#a#bJ}QKQP#g#h+rQKYP#]Q!Q![K]QK`Q!Q![K]#a#bKfQKiP#g#h+rPKoR!Q![Kx!c!iKx#T#ZKxPK}R#^P!Q![Kx!c!iKx#T#ZKxVL_T$wS!ZR!Q![Ln![!]Ln!c!}Ln#R#SLn#T#oLnRLsT!ZR!Q![Ln![!]Ln!c!}Ln#R#SLn#T#oLn~MXP!U~!_!`M[~MaO!T~~MfQ#kP!_!`Ml#r#sMqQMqO!QQ~MvO#l~~M{P!S~!_!`NO~NTO!R~VN[T!ZRqS!Q![NT![!]Ln!c!}NT#R#SNT#T#oNT~NpO$u~~NuO$v~~NzOu~~N}RO#SNz#S#T%Y#T~Nz~! ]O$z~~! bO${~",tokenizers:[0,1,2],topRules:{"@top":[0,25]},specialized:[{term:57,get:function(e,t){return function(e,t){return $m[e.toLowerCase()]||-1}(e)<<1}},{term:57,get:function(e,t){return function(e,t){return Bm[e.toLowerCase()]||-1}(e)<<1|1}},{term:57,get:function(e){return Vm[e]||-1}}],tokenPrec:0}),jm=function(){function e(t){_classCallCheck(this,e),this.lspClient=t}return _createClass(e,[{key:"promQL",value:function(e){var t=e.state,n=e.pos,r=t.doc.lineAt(n),i={expr:t.doc.sliceString(0),limit:100,positionChar:n-r.from-1>0?n-r.from-1:n-r.from,positionLine:r.number-1};return this.lspClient.complete(i).then((function(e){var t,i,o=[],a=_createForOfIteratorHelper(e);try{for(a.s();!(i=a.n()).done;){var s=i.value,l="";switch(s.kind){case 12:l="constant";break;case 3:l="function"}var u=s.label;s.textEdit&&(u=s.textEdit.newText,t=s.textEdit),o.push({label:s.label,apply:u,type:l})}}catch(c){a.e(c)}finally{a.f()}return{from:t?r.from+t.range.start.character:r.from,to:n,options:o}}))}}]),e}();function qm(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=0;return n.unshift(e.type.id),e.iterate({enter:function(t,r,o){if(t.id!==n[i]&&t.name!==n[i])return!1;if(++i>=n.length){var a=e.resolve(r,-1);if(a.type.id===t.id&&a.start===r&&a.end===o)return a;for(a=e.resolve(r,1);a&&(a.type.id!==t.id||a.start!==r||a.end!==o);)a=a.parent;return a}}})}function Wm(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];n.unshift(e.type.id);var i=0,o=e.iterate({enter:function(t){if(t.id!==e.type.id||0!==i)return n.some((function(e){return t.id===e||t.name===e}));i++}});return void 0!==o&&o}function Um(e,t,n){var r=[];return function e(r,i){var o=null==r?void 0:r.firstChild,a=null==r?void 0:r.lastChild;o&&o.type.id===t&&e(o,i),a&&a.type.id===n&&i.push(a)}(e,r),r}var Xm,Gm=[{label:"^"},{label:"*"},{label:"/"},{label:"%"},{label:"+"},{label:"-"},{label:"=="},{label:">="},{label:">"},{label:"<"},{label:"<="},{label:"!="},{label:"and"},{label:"or"},{label:"unless"}],Zm=[{label:"avg",detail:"aggregation",info:"Calculate the average over dimensions"},{label:"bottomk",detail:"aggregation",info:"Smallest k elements by sample value"},{label:"count",detail:"aggregation",info:"Count number of elements in the vector"},{label:"count_values",detail:"aggregation",info:"Count number of elements with the same value"},{label:"group",detail:"aggregation",info:"Group series, while setting the sample value to 1"},{label:"max",detail:"aggregation",info:"Select maximum over dimensions"},{label:"min",detail:"aggregation",info:"Select minimum over dimensions"},{label:"quantile",detail:"aggregation",info:"Calculate \u03c6-quantile (0 \u2264 \u03c6 \u2264 1) over dimensions"},{label:"stddev",detail:"aggregation",info:"Calculate population standard deviation over dimensions"},{label:"stdvar",detail:"aggregation",info:"Calculate population standard variance over dimensions"},{label:"sum",detail:"aggregation",info:"Calculate sum over dimensions"},{label:"topk",detail:"aggregation",info:"Largest k elements by sample value"}],Ym=[{label:"sum(rate(__input_vector__[5m]))",type:"function",detail:"snippet",apply:ng("sum(rate(${__input_vector__}[5m]))")},{label:"histogram_quantile(__quantile__, sum by(le) (rate(__histogram_metric__[5m])))",type:"function",detail:"snippet",apply:ng("histogram_quantile(${__quantile__}, sum by(le) (rate(${__histogram_metric__}[5m])))")},{label:'label_replace(__input_vector__, "__dst__", "__replacement__", "__src__", "__regex__")',type:"function",detail:"snippet",apply:ng('label_replace(${__input_vector__}, "${__dst__}", "${__replacement__}", "${__src__}", "${__regex__}")')}],Km={matchOp:{nodes:[{label:"="},{label:"!="},{label:"=~"},{label:"!~"}]},binOp:{nodes:Gm},duration:{nodes:[{label:"y"},{label:"w"},{label:"d"},{label:"h"},{label:"m"},{label:"s"},{label:"ms"}]},binOpModifier:{nodes:[{label:"on"},{label:"ignoring"},{label:"group_left"},{label:"group_right"}],type:"keyword"},functionIdentifier:{nodes:[{label:"abs",detail:"function",info:"Return absolute values of input series"},{label:"absent",detail:"function",info:"Determine whether input vector is empty"},{label:"absent_over_time",detail:"function",info:"Determine whether input range vector is empty"},{label:"avg_over_time",detail:"function",info:"Average series values over time"},{label:"ceil",detail:"function",info:"Round up values of input series to nearest integer"},{label:"changes",detail:"function",info:"Return number of value changes in input series over time"},{label:"clamp_max",detail:"function",info:"Limit the value of input series to a maximum"},{label:"clamp_min",detail:"function",info:"Limit the value of input series to a minimum"},{label:"count_over_time",detail:"function",info:"Count the number of values for each input series"},{label:"days_in_month",detail:"function",info:"Return the number of days in current month for provided timestamps"},{label:"day_of_month",detail:"function",info:"Return the day of the month for provided timestamps"},{label:"day_of_week",detail:"function",info:"Return the day of the week for provided timestamps"},{label:"delta",detail:"function",info:"Calculate the difference between beginning and end of a range vector (for gauges)"},{label:"deriv",detail:"function",info:"Calculate the per-second derivative over series in a range vector (for gauges)"},{label:"exp",detail:"function",info:"Calculate exponential function for input vector values"},{label:"floor",detail:"function",info:"Round down values of input series to nearest integer"},{label:"histogram_quantile",detail:"function",info:"Calculate quantiles from histogram buckets"},{label:"holt_winters",detail:"function",info:"Calculate smoothed value of input series"},{label:"hour",detail:"function",info:"Return the hour of the day for provided timestamps"},{label:"idelta",detail:"function",info:"Calculate the difference between the last two samples of a range vector (for counters)"},{label:"increase",detail:"function",info:"Calculate the increase in value over a range of time (for counters)"},{label:"irate",detail:"function",info:"Calculate the per-second increase over the last two samples of a range vector (for counters)"},{label:"label_replace",detail:"function",info:"Set or replace label values"},{label:"label_join",detail:"function",info:"Join together label values into new label"},{label:"ln",detail:"function",info:"Calculate natural logarithm of input series"},{label:"log10",detail:"function",info:"Calulcate base-10 logarithm of input series"},{label:"log2",detail:"function",info:"Calculate base-2 logarithm of input series"},{label:"max_over_time",detail:"function",info:"Return the maximum value over time for input series"},{label:"min_over_time",detail:"function",info:"Return the minimum value over time for input series"},{label:"minute",detail:"function",info:"Return the minute of the hour for provided timestamps"},{label:"month",detail:"function",info:"Return the month for provided timestamps"},{label:"predict_linear",detail:"function",info:"Predict the value of a gauge into the future"},{label:"quantile_over_time",detail:"function",info:"Calculate value quantiles over time for input series"},{label:"rate",detail:"function",info:"Calculate per-second increase over a range vector (for counters)"},{label:"resets",detail:"function",info:"Return number of value decreases (resets) in input series of time"},{label:"round",detail:"function",info:"Round values of input series to nearest integer"},{label:"scalar",detail:"function",info:"Convert single-element series vector into scalar value"},{label:"sort",detail:"function",info:"Sort input series ascendingly by value"},{label:"sort_desc",detail:"function",info:"Sort input series descendingly by value"},{label:"sqrt",detail:"function",info:"Return the square root for input series"},{label:"stddev_over_time",detail:"function",info:"Calculate the standard deviation within input series over time"},{label:"stdvar_over_time",detail:"function",info:"Calculate the standard variation within input series over time"},{label:"sum_over_time",detail:"function",info:"Calculate the sum over the values of input series over time"},{label:"time",detail:"function",info:"Return the Unix timestamp at the current evaluation time"},{label:"timestamp",detail:"function",info:"Return the Unix timestamp for the samples in the input vector"},{label:"vector",detail:"function",info:"Convert a scalar value into a single-element series vector"},{label:"year",detail:"function",info:"Return the year for provided timestamps"}],type:"function"},aggregateOp:{nodes:Zm,type:"keyword"},aggregateOpModifier:{nodes:[{label:"by"},{label:"without"}],type:"keyword"}};function Jm(e,t){var n=function(e,t){for(var n=e;n&&113!==n.type.id;)n=n.parent;return n}(e);return n?(n=qm(n,114,57))?t.sliceDoc(n.start,n.end):"":""}!function(e){e[e.MetricName=0]="MetricName",e[e.LabelName=1]="LabelName",e[e.LabelValue=2]="LabelValue",e[e.Function=3]="Function",e[e.Aggregation=4]="Aggregation",e[e.BinOpModifier=5]="BinOpModifier",e[e.BinOp=6]="BinOp",e[e.MatchOp=7]="MatchOp",e[e.AggregateOpModifier=8]="AggregateOpModifier",e[e.Duration=9]="Duration",e[e.Offset=10]="Offset"}(Xm||(Xm={}));var ey=function(){function e(t){_classCallCheck(this,e),this.prometheusClient=t}return _createClass(e,[{key:"promQL",value:function(e){var t,n=this,r=e.state,i=e.pos,o=r.tree.resolve(i,-1),a=function(e,t){var n,r,i,o,a,s,l,u,c,h,f,d,v,p,g,m=[];switch(t.type.id){case 0:if(107===(null===(n=t.parent)||void 0===n?void 0:n.type.id)){m.push({kind:Xm.Duration});break}var y=e.sliceDoc(t.start,t.end);Gm.filter((function(e){return e.label.includes(y)})).length>0&&m.push({kind:Xm.BinOp});break;case 57:if(0===(null===(r=t.parent)||void 0===r?void 0:r.type.id)){if(27===(null===(i=t.parent.parent)||void 0===i?void 0:i.type.id)){m.push({kind:Xm.AggregateOpModifier});break}if(113===(null===(o=t.parent.parent)||void 0===o?void 0:o.type.id)){var k=Jm(t,e);Zm.filter((function(e){return e.label===k})).length>0&&m.push({kind:Xm.AggregateOpModifier}),m.push({kind:Xm.BinOp},{kind:Xm.Offset});break}}var b=null===(l=null===(s=null===(a=t.parent)||void 0===a?void 0:a.parent)||void 0===s?void 0:s.parent)||void 0===l?void 0:l.parent;if(!b){m.push({kind:Xm.MetricName},{kind:Xm.Function},{kind:Xm.Aggregation});break}!function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=0;""===e.name&&e.type.id>0&&i++;var o=0,a=e.iterate({enter:function(t){if(t.id!==e.type.id||0!==i)return(t.id===n[o]||t.name===n[o])&&++o>=n.length;i++}});return void 0!==a&&a}(b,26,26)?m.push({kind:Xm.MetricName},{kind:Xm.Function},{kind:Xm.Aggregation}):36!==b.type.id||Wm(b,0)?(36!==b.type.id||36===b.type.id&&Wm(b,0))&&m.push({kind:Xm.BinOp},{kind:Xm.Offset}):m.push({kind:Xm.MetricName},{kind:Xm.Function},{kind:Xm.Aggregation},{kind:Xm.BinOpModifier});break;case 30:m.push({kind:Xm.LabelName});break;case 115:m.push({kind:Xm.LabelName,metricName:Jm(t,e)});break;case 33:32===(null===(u=t.parent)||void 0===u?void 0:u.type.id)?m.push({kind:Xm.LabelName}):117===(null===(c=t.parent)||void 0===c?void 0:c.type.id)&&m.push({kind:Xm.LabelName,metricName:Jm(t,e)});break;case 117:33===(null===(h=t.firstChild)||void 0===h?void 0:h.type.id)&&0===(null===(f=t.lastChild)||void 0===f?void 0:f.type.id)&&null===(null===(d=t.lastChild)||void 0===d?void 0:d.firstChild)&&m.push({kind:Xm.MatchOp});break;case 109:if(117===(null===(v=t.parent)||void 0===v?void 0:v.type.id)){var w="";t.parent.firstChild&&33===t.parent.firstChild.type.id&&(w=e.sliceDoc(t.parent.firstChild.start,t.parent.firstChild.end));var _=Jm(t,e);m.push({kind:Xm.LabelValue,metricName:_,labelName:w})}break;case 105:case 107:m.push({kind:Xm.Duration});break;case 34:m.push({kind:Xm.MetricName},{kind:Xm.Function},{kind:Xm.Aggregation});break;case 53:118===(null===(p=t.parent)||void 0===p?void 0:p.type.id)?m.push({kind:Xm.MatchOp}):36===(null===(g=t.parent)||void 0===g?void 0:g.type.id)&&m.push({kind:Xm.BinOp});break;case 119:case 120:case 121:case 118:m.push({kind:Xm.MatchOp});break;case 37:case 43:case 44:case 45:case 46:case 47:case 48:case 49:case 50:case 51:case 52:case 21:case 23:case 22:case 36:m.push({kind:Xm.BinOp})}return m}(r,o),s=Promise.resolve([]),l=!1,u=_createForOfIteratorHelper(a);try{var c=function(){var e=t.value;switch(e.kind){case Xm.Aggregation:s=s.then((function(e){return e.concat(Km.aggregateOp)}));break;case Xm.Function:s=s.then((function(e){return e.concat(Km.functionIdentifier)}));break;case Xm.BinOpModifier:s=s.then((function(e){return e.concat(Km.binOpModifier)}));break;case Xm.BinOp:s=s.then((function(e){return e.concat(Km.binOp)}));break;case Xm.MatchOp:s=s.then((function(e){return e.concat(Km.matchOp)}));break;case Xm.AggregateOpModifier:s=s.then((function(e){return e.concat(Km.aggregateOpModifier)}));break;case Xm.Duration:s=s.then((function(e){return e.concat(Km.duration)}));break;case Xm.Offset:s=s.then((function(e){return e.concat([{nodes:[{label:"offset"}]}])}));break;case Xm.MetricName:s=s.then((function(e){return l=!0,n.autocompleteMetricName(e)}));break;case Xm.LabelName:s=s.then((function(t){return n.autocompleteLabelName(t,e.metricName)}));break;case Xm.LabelValue:s=s.then((function(t){return n.autocompleteLabelValue(t,e.labelName,e.metricName)}))}};for(u.s();!(t=u.n()).done;)c()}catch(h){u.e(h)}finally{u.f()}return s.then((function(e){return function(e,t,n){var r,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=[],a=_createForOfIteratorHelper(e);try{for(a.s();!(r=a.n()).done;){var s,l=r.value,u=_createForOfIteratorHelper(l.nodes);try{for(u.s();!(s=u.n()).done;){var c=s.value;o.push({label:c.label,type:l.type,detail:c.detail,info:c.info})}}catch(h){u.e(h)}finally{u.f()}}}catch(h){a.e(h)}finally{a.f()}return i&&o.push.apply(o,Ym),{from:t,to:n,options:o,span:/^[a-zA-Z0-9_:]+$/}}(e,function(e,t){var n,r,i,o,a,s=e.start;return 30===e.type.id||115===e.type.id||34===e.type.id||109===e.type.id&&117===(null===(n=e.parent)||void 0===n?void 0:n.type.id)?s++:117===e.type.id&&33===(null===(r=e.firstChild)||void 0===r?void 0:r.type.id)&&0===(null===(i=e.lastChild)||void 0===i?void 0:i.type.id)&&null===(null===(o=e.lastChild)||void 0===o?void 0:o.firstChild)?s=e.lastChild.start:(107===e.type.id||0===e.type.id&&107===(null===(a=e.parent)||void 0===a?void 0:a.type.id))&&(s=t),s}(o,i),i,l)}))}},{key:"autocompleteMetricName",value:function(e){var t=this;if(!this.prometheusClient)return e;var n=new Map;return this.prometheusClient.labelValues("__name__").then((function(e){var r,i,o=_createForOfIteratorHelper(e);try{for(o.s();!(i=o.n()).done;){var a=i.value;n.set(a,{label:a})}}catch(s){o.e(s)}finally{o.f()}if(e.length<=1e4)return null===(r=t.prometheusClient)||void 0===r?void 0:r.metricMetadata()})).then((function(t){if(t){var r,i=_createForOfIteratorHelper(n);try{for(i.s();!(r=i.n()).done;){var o=_slicedToArray(r.value,2),a=o[0],s=o[1],l=t.get(a);l&&(l.length>1?s.detail="unknown":1===l.length&&(s.detail=l[0].type,s.info=l[0].help))}}catch(u){i.e(u)}finally{i.f()}}return e.concat([{nodes:Array.from(n.values()),type:"constant"}])}))}},{key:"autocompleteLabelName",value:function(e,t){return this.prometheusClient?this.prometheusClient.labelNames(t).then((function(t){return e.concat([{nodes:t.map((function(e){return{label:e}})),type:"constant"}])})):e}},{key:"autocompleteLabelValue",value:function(e,t,n){return this.prometheusClient&&t?this.prometheusClient.labelValues(t,n).then((function(t){return e.concat([{nodes:t.map((function(e){return{label:e}})),type:"text"}])})):e}}]),e}(),ty=function(){function e(t,n,r){_classCallCheck(this,e),this.autocompleteEndpoint="/completion",this.diagnosticEndpoint="/diagnostics",this.fetchFn=function(e,t){return fetch(e,t)},this.url=t,this.errorHandler=n,r&&(this.fetchFn=r)}return _createClass(e,[{key:"fetchLSP",value:function(e,t){var n=this;return this.fetchFn(this.url+e,{method:"POST",body:JSON.stringify(t)}).then((function(e){if(200!==e.status)throw new Error(e.statusText);return e})).then((function(e){return e.json()})).catch((function(e){return n.errorHandler&&n.errorHandler(e),[]}))}},{key:"complete",value:function(e){return this.fetchLSP(this.autocompleteEndpoint,e)}},{key:"diagnostic",value:function(e){return this.fetchLSP(this.diagnosticEndpoint,e)}}]),e}(),ny=function(){function e(){_classCallCheck(this,e),this.completeAssociation=new Map,this.metricMetadata=new Map,this.labelValues=new Map,this.labelNames=[]}return _createClass(e,[{key:"setAssociation",value:function(e,t){var n=this.completeAssociation.get(e);n||(n=new Map,this.completeAssociation.set(e,n));for(var r=0,i=Object.entries(t);r<i.length;r++){var o=_slicedToArray(i[r],2),a=o[0],s=o[1];if("__name__"!==a){var l=n.get(a);l&&0!==l.length?l.includes(s)||l.push(s):l=[s],n.set(a,l)}}}},{key:"setMetricMetadata",value:function(e,t){this.metricMetadata.set(e,t)}},{key:"getMetricMetadata",value:function(){return this.metricMetadata}},{key:"setLabelNames",value:function(e){this.labelNames=e}},{key:"getLabelNames",value:function(e){if(!e||0===e.length)return this.labelNames;var t=this.completeAssociation.get(e);return t?Array.from(t.keys()):[]}},{key:"setLabelValues",value:function(e,t){this.labelValues.set(e,t)}},{key:"getLabelValues",value:function(e,t){if(!t||0===t.length)return this.labelValues.get(e)||[];var n=this.completeAssociation.get(t);return n&&n.get(e)||[]}}]),e}(),ry=400,iy=422,oy=503,ay=function(){function e(t,n,r,i){_classCallCheck(this,e),this.lookbackInterval=432e5,this.fetchFn=function(e,t){return fetch(e,t)},this.cache=new ny,this.url=t,this.errorHandler=n,r&&(this.lookbackInterval=r),i&&(this.fetchFn=i)}return _createClass(e,[{key:"labelNames",value:function(e){var t=this;if(this.cache.getLabelNames(e)&&this.cache.getLabelNames(e).length>0)return Promise.resolve(this.cache.getLabelNames(e));var n=new Date,r=new Date(n.getTime()-this.lookbackInterval);if(void 0===e||""===e){var i=new URLSearchParams({start:r.toISOString(),end:n.toISOString()});return this.fetchAPI("/api/v1/labels?".concat(i)).then((function(e){return t.cache.setLabelNames(e),e})).catch((function(e){return t.errorHandler&&t.errorHandler(e),[]}))}return this.series(e,r,n).then((function(n){return t.cache.getLabelNames(e)}))}},{key:"labelValues",value:function(e,t){var n=this;if(this.cache.getLabelValues(e,t)&&this.cache.getLabelValues(e,t).length>0)return Promise.resolve(this.cache.getLabelValues(e,t));var r=new Date,i=new Date(r.getTime()-this.lookbackInterval);if(!t||0===t.length){var o=new URLSearchParams({start:i.toISOString(),end:r.toISOString()});return this.fetchAPI("".concat("/api/v1/label/:name/values".replace(/:name/gi,e),"?").concat(o)).then((function(t){return n.cache.setLabelValues(e,t),t})).catch((function(e){return n.errorHandler&&n.errorHandler(e),[]}))}return this.series(t,i,r).then((function(r){return n.cache.getLabelValues(e,t)}))}},{key:"metricMetadata",value:function(){var e=this;return this.cache.getMetricMetadata()&&this.cache.getMetricMetadata().size>0?Promise.resolve(this.cache.getMetricMetadata()):this.fetchAPI("/api/v1/metadata").then((function(t){for(var n=0,r=Object.entries(t);n<r.length;n++){var i=_slicedToArray(r[n],2),o=i[0],a=i[1];e.cache.setMetricMetadata(o,a)}return e.cache.getMetricMetadata()})).catch((function(t){return e.errorHandler&&e.errorHandler(t),new Map}))}},{key:"series",value:function(e,t,n){var r=this,i=new URLSearchParams({start:t.toISOString(),end:n.toISOString(),"match[]":e});return this.fetchAPI("/api/v1/series?".concat(i)).then((function(t){return t.forEach((function(t){r.cache.setAssociation(e,t)})),t})).catch((function(e){return r.errorHandler&&r.errorHandler(e),[]}))}},{key:"fetchAPI",value:function(e){return this.fetchFn(this.url+e).then((function(e){if(!e.ok&&![ry,iy,oy].includes(e.status))throw new Error(e.statusText);return e})).then((function(e){return e.json()})).then((function(e){if("error"===e.status)throw new Error(void 0!==e.error?e.error:'missing "error" field in response JSON');if(void 0===e.data)throw new Error('missing "data" field in response JSON');return e.data}))}}]),e}();function sy(e){if(null==e?void 0:e.lsp){var t=e.lsp;if(t.lspClient)return new jm(t.lspClient);if(t.url)return new jm(new ty(t.url,t.httpErrorHandler,t.fetchFn));throw new Error("the url or the lspClient must be set")}if(null==e?void 0:e.hybrid){var n=e.hybrid;if(n.prometheusClient)return new ey(n.prometheusClient);if(n.url)return new ey(new ay(n.url,n.httpErrorHandler,n.lookbackInterval,n.fetchFn));throw new Error("the url or the prometheusClient must be set")}return new ey}var ly,uy=function(){function e(t){_classCallCheck(this,e),this.lspClient=t}return _createClass(e,[{key:"promQL",value:function(){var e=this;return function(t){var n=t.state,r=n.sliceDoc(0,n.doc.length);return e.lspClient.diagnostic({expr:r,limit:100}).then((function(e){var t,r=[],i=_createForOfIteratorHelper(e);try{for(i.s();!(t=i.n()).done;){var o=t.value,a=n.doc.line(o.range.start.line+1),s=n.doc.line(o.range.end.line+1);r.push({message:o.message,severity:"error",from:a.from+o.range.start.character,to:s.from+o.range.end.character})}}catch(l){i.e(l)}finally{i.f()}return r.sort((function(e,t){return e.from-t.from}))}))}}}]),e}();!function(e){e.none="none",e.vector="vector",e.scalar="scalar",e.matrix="matrix",e.string="string"}(ly||(ly={}));var cy={59:{name:"abs",argTypes:[ly.vector],variadic:0,returnType:ly.vector},58:{name:"absent",argTypes:[ly.vector],variadic:0,returnType:ly.vector},56:{name:"absent_over_time",argTypes:[ly.matrix],variadic:0,returnType:ly.vector},60:{name:"avg_over_time",argTypes:[ly.matrix],variadic:0,returnType:ly.vector},61:{name:"ceil",argTypes:[ly.vector],variadic:0,returnType:ly.vector},62:{name:"changes",argTypes:[ly.matrix],variadic:0,returnType:ly.vector},63:{name:"clamp_max",argTypes:[ly.vector,ly.scalar],variadic:0,returnType:ly.vector},64:{name:"clamp_min",argTypes:[ly.vector,ly.scalar],variadic:0,returnType:ly.vector},65:{name:"count_over_time",argTypes:[ly.matrix],variadic:0,returnType:ly.vector},66:{name:"days_in_month",argTypes:[ly.vector],variadic:1,returnType:ly.vector},67:{name:"day_of_month",argTypes:[ly.vector],variadic:1,returnType:ly.vector},68:{name:"day_of_week",argTypes:[ly.vector],variadic:1,returnType:ly.vector},69:{name:"delta",argTypes:[ly.matrix],variadic:0,returnType:ly.vector},70:{name:"deriv",argTypes:[ly.matrix],variadic:0,returnType:ly.vector},71:{name:"exp",argTypes:[ly.vector],variadic:0,returnType:ly.vector},72:{name:"floor",argTypes:[ly.vector],variadic:0,returnType:ly.vector},73:{name:"histogram_quantile",argTypes:[ly.scalar,ly.vector],variadic:0,returnType:ly.vector},74:{name:"holt_winters",argTypes:[ly.matrix,ly.scalar,ly.scalar],variadic:0,returnType:ly.vector},75:{name:"hour",argTypes:[ly.vector],variadic:1,returnType:ly.vector},76:{name:"idelta",argTypes:[ly.matrix],variadic:0,returnType:ly.vector},77:{name:"increase",argTypes:[ly.matrix],variadic:0,returnType:ly.vector},78:{name:"irate",argTypes:[ly.matrix],variadic:0,returnType:ly.vector},79:{name:"label_replace",argTypes:[ly.vector,ly.string,ly.string,ly.string,ly.string],variadic:0,returnType:ly.vector},80:{name:"label_join",argTypes:[ly.vector,ly.string,ly.string,ly.string],variadic:-1,returnType:ly.vector},81:{name:"ln",argTypes:[ly.vector],variadic:0,returnType:ly.vector},82:{name:"log10",argTypes:[ly.vector],variadic:0,returnType:ly.vector},83:{name:"log2",argTypes:[ly.vector],variadic:0,returnType:ly.vector},84:{name:"max_over_time",argTypes:[ly.matrix],variadic:0,returnType:ly.vector},85:{name:"min_over_time",argTypes:[ly.matrix],variadic:0,returnType:ly.vector},86:{name:"minute",argTypes:[ly.vector],variadic:1,returnType:ly.vector},87:{name:"month",argTypes:[ly.vector],variadic:1,returnType:ly.vector},88:{name:"predict_linear",argTypes:[ly.matrix,ly.scalar],variadic:0,returnType:ly.vector},89:{name:"quantile_over_time",argTypes:[ly.scalar,ly.matrix],variadic:0,returnType:ly.vector},90:{name:"rate",argTypes:[ly.matrix],variadic:0,returnType:ly.vector},91:{name:"resets",argTypes:[ly.matrix],variadic:0,returnType:ly.vector},92:{name:"round",argTypes:[ly.vector,ly.scalar],variadic:1,returnType:ly.vector},93:{name:"scalar",argTypes:[ly.vector],variadic:0,returnType:ly.scalar},94:{name:"sort",argTypes:[ly.vector],variadic:0,returnType:ly.vector},95:{name:"sort_desc",argTypes:[ly.vector],variadic:0,returnType:ly.vector},96:{name:"sqrt",argTypes:[ly.vector],variadic:0,returnType:ly.vector},97:{name:"stddev_over_time",argTypes:[ly.matrix],variadic:0,returnType:ly.vector},98:{name:"stdvar_over_time",argTypes:[ly.matrix],variadic:0,returnType:ly.vector},99:{name:"sum_over_time",argTypes:[ly.matrix],variadic:0,returnType:ly.vector},101:{name:"time",argTypes:[],variadic:0,returnType:ly.scalar},100:{name:"timestamp",argTypes:[ly.vector],variadic:0,returnType:ly.vector},102:{name:"vector",argTypes:[ly.scalar],variadic:0,returnType:ly.vector},103:{name:"year",argTypes:[ly.vector],variadic:1,returnType:ly.vector}};function hy(e){return cy[e]}var fy=function(){function e(t,n,r){_classCallCheck(this,e),this.type=t,this.name=n,this.value=r}return _createClass(e,[{key:"matchesEmpty",value:function(){switch(this.type){case 119:return""===this.value;case 53:return""!==this.value;default:return!1}}}]),e}(),dy=function(){function e(t){_classCallCheck(this,e),this.tree=t.tree,this.state=t,this.diagnostics=[]}return _createClass(e,[{key:"getDiagnostics",value:function(){return this.diagnostics.sort((function(e,t){return e.from-t.from}))}},{key:"analyze",value:function(){this.checkAST(this.tree.firstChild),this.diagnoseAllErrorNodes()}},{key:"diagnoseAllErrorNodes",value:function(){var e=this;this.tree.iterate({enter:function(t,n,r){if(0===t.id&&r!==e.tree.end){var i=e.tree.resolve(n,-1);e.diagnostics.push({severity:"error",message:"unexpected expression",from:i.start,to:i.end})}}})}},{key:"checkAST",value:function(e){if(!e)return ly.none;switch(e.type.id){case 26:return this.checkAST(e.firstChild);case 27:this.checkAggregationExpr(e);break;case 36:this.checkBinaryExpr(e);break;case 54:this.checkCallFunction(e);break;case 108:this.checkAST(qm(e,26));break;case 111:var t=this.checkAST(qm(e,26));t!==ly.scalar&&t!==ly.vector&&this.addDiagnostic(e,"unary expression only allowed on expressions of type scalar or instant vector, got ".concat(t));break;case 110:var n=this.checkAST(qm(e,26));n!==ly.vector&&this.addDiagnostic(e,"subquery is only allowed on instant vector, got ".concat(n," in ").concat(e.name," instead"));break;case 104:this.checkAST(qm(e,26));break;case 113:this.checkVectorSelector(e)}return function e(t){var n;if(!t)return ly.none;switch(t.type.id){case 26:return e(t.firstChild);case 27:case 113:return ly.vector;case 107:return e(t.firstChild);case 109:return ly.string;case 106:return ly.scalar;case 104:case 110:return ly.matrix;case 108:case 111:return e(qm(t,26));case 36:var r=e(t.firstChild),i=e(t.lastChild);return r===ly.scalar&&i===ly.scalar?ly.scalar:ly.vector;case 54:var o=null===(n=t.firstChild)||void 0===n?void 0:n.firstChild;return o?hy(o.type.id).returnType:ly.none;default:return ly.none}}(e)}},{key:"checkAggregationExpr",value:function(e){var t,n=null===(t=e.firstChild)||void 0===t?void 0:t.firstChild;if(n){var r=qm(e,34,35,26);if(r){this.expectType(r,ly.vector,"aggregation expression");var i=qm(e,34,35,35,26);if(18===n.type.id||8===n.type.id||14===n.type.id){if(!i)return void this.addDiagnostic(e,"no parameter found");this.expectType(i,ly.scalar,"aggregation parameter")}if(10===n.type.id){if(!i)return void this.addDiagnostic(e,"no parameter found");this.expectType(i,ly.string,"aggregation parameter")}}else this.addDiagnostic(e,"unable to find the parameter for the expression")}else this.addDiagnostic(e,"aggregation operator expected in aggregation expression but got nothing")}},{key:"checkBinaryExpr",value:function(e){var t=e.firstChild,n=e.lastChild;if(t&&n){var r=this.checkAST(t),i=this.checkAST(n),o=qm(e,38,39,40,1),a=Wm(e,48,53,51,52,49,50),s=Wm(e,21,22,23);o?a||this.addDiagnostic(e,"bool modifier can only be used on comparison operators"):a&&r===ly.scalar&&i===ly.scalar&&this.addDiagnostic(e,"comparisons between scalars must use BOOL modifier"),r!==ly.scalar&&r!==ly.vector&&this.addDiagnostic(t,"binary expression must contain only scalar and instant vector types"),i!==ly.scalar&&i!==ly.vector&&this.addDiagnostic(n,"binary expression must contain only scalar and instant vector types"),r!==ly.scalar&&i!==ly.scalar||!s||this.addDiagnostic(e,"set operator not allowed in binary scalar expression")}else this.addDiagnostic(e,"left or right expression is missing in binary expression")}},{key:"checkCallFunction",value:function(e){var t,n=null===(t=e.firstChild)||void 0===t?void 0:t.firstChild;if(n){var r=Um(qm(e,34),35,26),i=hy(n.type.id),o=i.argTypes.length;if(0===i.variadic)r.length!==o&&this.addDiagnostic(e,"expected ".concat(o," argument(s) in call to ").concat(i.name,", got ").concat(r.length));else{var a=o-1;if(a>r.length)this.addDiagnostic(e,"expected at least ".concat(a," argument(s) in call to ").concat(i.name,", got ").concat(r.length));else{var s=a+i.variadic;i.variadic>0&&s<r.length&&this.addDiagnostic(e,"expected at most ".concat(s," argument(s) in call to ").concat(i.name,", got ").concat(r.length))}}for(var l=0,u=0;u<r.length;u++){if((l=u)>=i.argTypes.length){if(0===i.variadic)break;l=i.argTypes.length-1}this.expectType(r[u],i.argTypes[l],"call to function ".concat(i.name))}}else this.addDiagnostic(e,"function not defined")}},{key:"checkVectorSelector",value:function(e){var t=function(e,t){var n=[];return e.forEach((function(e){n.push(function(e,t){var n=new fy(0,"","");return e.iterate({enter:function(e,r,i){switch(e.id){case 117:return;case 33:n.name=t.sliceDoc(r,i);break;case 118:return;case 119:case 53:case 120:case 121:n.type=e.id;break;case 109:n.value=t.sliceDoc(r,i).slice(1,-1)}return!1}}),n}(e,t))})),n}(Um(qm(e,115,116),116,117),this.state),n="",r=qm(e,114,57);if(r&&(n=this.state.sliceDoc(r.start,r.end)),""!==n){var i=t.find((function(e){return"__name__"===e.name}));i&&this.addDiagnostic(e,"metric name must not be set twice: ".concat(n," or ").concat(i.value)),t.push(new fy(119,"__name__",n))}t.every((function(e){return e.matchesEmpty()}))&&this.addDiagnostic(e,"vector selector must contain at least one non-empty matcher")}},{key:"expectType",value:function(e,t,n){var r=this.checkAST(e);r!==t&&this.addDiagnostic(e,"expected type ".concat(t," in ").concat(n,", got ").concat(r))}},{key:"addDiagnostic",value:function(e,t){this.diagnostics.push({severity:"error",message:t,from:e.start,to:e.end})}}]),e}(),vy=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"promQL",value:function(){return function(e){var t=new dy(e.state);return t.analyze(),t.getDiagnostics()}}}]),e}();function py(e){if(null==e?void 0:e.lsp){var t=e.lsp;if(t.lspClient)return new uy(t.lspClient);if(t.url)return new uy(new ty(t.url,t.httpErrorHandler));throw new Error("the url or the lspClient must be set")}return new vy}var gy,my,yy,ky=cm.define(zm.withProps(Tg.add({LineComment:"comment",LabelName:"labelName",StringLiteral:"string",NumberLiteral:"number",Duration:"number","Abs Absent AbsentOverTime AvgOverTime Ceil Changes ClampMax ClampMin CountOverTime DaysInMonth DayOfMonth DayOfWeek Delta Deriv Exp Floor HistogramQuantile HoltWinters Hour Idelta Increase Irate LabelReplace LabelJoin Ln Log10 Log2 MaxOverTime MinOverTime Minute Month PredictLinear QuantileOverTime Rate Resets Round Scalar Sort SortDesc Sqrt StddevOverTime StdvarOverTime SumOverTime Time Timestamp Vector Year":"functionName","Avg Bottomk Count Count_values Group Max Min Quantile Stddev Stdvar Sum Topk":"operatorKeyword","By Without Bool On Ignoring GroupLeft GroupRight Offset":"modifier","And Unless Or":"logicOperator","Sub Add Mul Mod Div Eql Neq Lte Lss Gte Gtr EqlRegex EqlSingle NeqRegex Pow":"operator",UnaryOp:"arithmeticOperator","( )":"paren","[ ]":"squareBracket","{ }":"brace","\u26a0":"invalid"})),{languageData:{closeBrackets:{brackets:["(","[","{","'",'"',"`"]},commentTokens:{line:"#"}}}),by=function(){function e(){_classCallCheck(this,e),this.complete=sy(),this.lint=py(),this.enableLinter=!0,this.enableCompletion=!0}return _createClass(e,[{key:"setComplete",value:function(e){return this.complete=sy(e),this}},{key:"setLinter",value:function(e){return this.lint=py(e),this}},{key:"activateCompletion",value:function(e){return this.enableCompletion=e,this}},{key:"activateLinter",value:function(e){return this.enableLinter=e,this}},{key:"asExtension",value:function(){var e,t=this,n=[ky];if(this.enableCompletion){var r=ky.languageData.of({autocomplete:function(e){return t.complete.promQL(e)}});n=n.concat(r)}return this.enableLinter&&(n=n.concat((e=this.lint.promQL.call(this.lint),Qc.fromClass(function(){function t(e){_classCallCheck(this,t),this.view=e,this.lintTime=Date.now()+500,this.set=!0,this.run=this.run.bind(this),setTimeout(this.run,500)}return _createClass(t,[{key:"run",value:function(){var t=this,n=Date.now();if(n<this.lintTime-10)setTimeout(this.run,this.lintTime-n);else{this.set=!1;var r=this.view.state;Promise.resolve(e(this.view)).then((function(e){var n,i;t.view.state.doc==r.doc&&(e.length||(null===(i=null===(n=t.view.state.field(qg,!1))||void 0===n?void 0:n.diagnostics)||void 0===i?void 0:i.size))&&t.view.dispatch(function(e,t){return{effects:Vg.of(t),reconfigure:Bg(e)}}(t.view.state,e))}),(function(e){Pc(t.view.state,e)}))}}},{key:"update",value:function(e){e.docChanged&&(this.lintTime=Date.now()+500,this.set||(this.set=!0,setTimeout(this.run,500)))}}]),t}())))),n}}]),e}(),wy=((yy=function(){function e(){_classCallCheck(this,e),this.promQLHighlightMaterialTheme=Dg({deleted:{textDecoration:"line-through"},inserted:{textDecoration:"underline"},link:{textDecoration:"underline"},strong:{fontWeight:"bold"},emphasis:{fontStyle:"italic"},invalid:{color:"#f00"},keyword:{color:"#C792EA"},operator:{color:"#89DDFF"},atom:{color:"#F78C6C"},number:{color:"#FF5370"},string:{color:"#99b867"},"regexp, escape":{color:"#e40"},"variableName definition":{color:"#f07178"},labelName:{color:"#f07178"},typeName:{color:"#085"},functionName:{color:"#C792EA"},"propertyName definition":{color:"#00c"},comment:{color:"#546E7A"},meta:{color:"#FFCB6B"}})}return _createClass(e,[{key:"ngOnInit",value:function(){var e=new by;new Hh({state:ol.create({extensions:[nm,e.asExtension(),this.promQLHighlightMaterialTheme]}),parent:document.getElementById("editor")})}}]),e}()).\u0275fac=function(e){return new(e||yy)},yy.\u0275cmp=(my={type:yy,selectors:[["app-root"]],decls:3,vars:0,consts:[["id","editor"]],template:function(e,t){1&e&&(Zr(0,"h3"),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=yt(),r=kt(),i=e+19,o=r.firstCreatePass?Rn(r,n[6],e,3,null,null):r.data[i],a=n[i]=function(e,t){return st(t)?t.createText(e):t.createTextNode(e)}(t,n[11]);mr(r,n,a,o),wt(o,!1)}(1,"CodeMirror Mode PromQL"),Yr(),Zr(2,"div",0,void 0),Yr())},styles:[""]},W((function(){var e=my.type,t=e.prototype,n={},r={type:e,providersResolver:null,decls:my.decls,vars:my.vars,factory:null,template:my.template||null,consts:my.consts||null,ngContentSelectors:my.ngContentSelectors,hostBindings:my.hostBindings||null,hostVars:my.hostVars||0,hostAttrs:my.hostAttrs||null,contentQueries:my.contentQueries||null,declaredInputs:n,inputs:null,outputs:null,exportAs:my.exportAs||null,onChanges:null,onInit:t.ngOnInit||null,doCheck:t.ngDoCheck||null,afterContentInit:t.ngAfterContentInit||null,afterContentChecked:t.ngAfterContentChecked||null,afterViewInit:t.ngAfterViewInit||null,afterViewChecked:t.ngAfterViewChecked||null,onDestroy:t.ngOnDestroy||null,onPush:my.changeDetection===ze.OnPush,directiveDefs:null,pipeDefs:null,selectors:my.selectors||We,viewQuery:my.viewQuery||null,features:my.features||null,data:my.data||{},encapsulation:my.encapsulation||je.Emulated,id:"c",styles:my.styles||We,_:null,setInput:null,schemas:my.schemas||null,tView:null},i=my.directives,o=my.features,a=my.pipes;return r.id+=Ue++,r.inputs=Ke(my.inputs,n),r.outputs=Ke(my.outputs),o&&o.forEach((function(e){return e(r)})),r.directiveDefs=i?function(){return("function"==typeof i?i():i).map(Xe)}:null,r.pipeDefs=a?function(){return("function"==typeof a?a():a).map(Ge)}:null,r}))),yy),_y=((gy=function e(){_classCallCheck(this,e)}).\u0275mod=Ye({type:gy,bootstrap:[wy]}),gy.\u0275inj=te({factory:function(e){return new(e||gy)},providers:[],imports:[[_a]]}),gy);(function(){if(gn)throw new Error("Cannot enable prod mode after platform setup.");pn=!1})(),ba().bootstrapModule(_y).catch((function(e){return console.error(e)}))},zn8P:function(e,t){function n(e){return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}))}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id="zn8P"}},[[0,0]]]);